diff -urN bash-3.0/AUTHORS bash-3.0-STEP/AUTHORS
--- bash-3.0/AUTHORS	2004-01-11 14:14:20.000000000 +1300
+++ bash-3.0-STEP/AUTHORS	2005-08-25 00:47:15.045232136 +1200
@@ -449,7 +449,7 @@
 lib/sh/strtrans.c	Chet Ramey
 lib/sh/times.c		Chet Ramey, Brian Fox
 lib/sh/timeval.c	Chet Ramey
-lib/sh/tmpfile.c	Chet Ramey
+lib/sh/System/TemporaryFilesfile.c	Chet Ramey
 lib/sh/vprint.c		Chet Ramey, Brian Fox
 lib/sh/xstrchr.c	Chet Ramey, Mitsuru Chinen
 lib/sh/zread.c		Chet Ramey
diff -urN bash-3.0/CHANGES bash-3.0-STEP/CHANGES
--- bash-3.0/CHANGES	2004-07-17 13:21:56.000000000 +1200
+++ bash-3.0-STEP/CHANGES	2005-08-25 00:47:15.152215872 +1200
@@ -1086,7 +1086,7 @@
     allocation and free time.
 
 q.  The `complete' and `compgen' builtins now have a new `-s/-A service'
-    option to complete on names from /etc/services.
+    option to complete on names from /System/Settings/services.
 
 r.  `read' has a new `-u fd' option to read from a specified file descriptor.
 
@@ -1500,7 +1500,7 @@
 
 a.  Better checks in the redirection code for write errors.
 
-b.  bashbug now uses $TMPDIR, defaulting to /tmp, and uses mktemp(1) more
+b.  bashbug now uses $TMPDIR, defaulting to /System/TemporaryFiles, and uses mktemp(1) more
     portably.
 
 c.  System-specific configuration changes for:  Interix, OpenBSD, FreeBSD,
@@ -1508,8 +1508,8 @@
 
 d.  Some more `const' cleanups through the code.
 
-e.  Fixed a typo in the /dev/fd redirection code, better checks for valid
-    numeric fds in /dev/fd.
+e.  Fixed a typo in the /System/Devices/fd redirection code, better checks for valid
+    numeric fds in /System/Devices/fd.
 
 f.  Fixed many parts of the shell to handle integer overflow more gracefully
     and to do more stringent checks for valid numbers.
@@ -1559,7 +1559,7 @@
 
 x.  Command substition no longer inherits the DEBUG trap.
 
-y.  Some fixes to the process substition code on machines without /dev/fd so
+y.  Some fixes to the process substition code on machines without /System/Devices/fd so
     that named pipes are not removed inappropriately.
 
 z.  The loadable `getconf' builtin is now much more complete, and will become
@@ -1573,7 +1573,7 @@
 
 cc. Some changes were made with the intent of making cross-compilation easier.
 
-dd. The network code (/dev/tcp and /dev/udp redirections) uses getaddrinfo(3)
+dd. The network code (/System/Devices/tcp and /System/Devices/udp redirections) uses getaddrinfo(3)
     if it's available, which adds support for IPv6.
 
 ee. Subshells of login shells no longer source ~/.bash_logout when they exit.
@@ -1592,7 +1592,7 @@
 jj. Fixed `compgen' to handle the `-o default' option better.
 
 kk. Fixed the job control code to force an asynchronous process's standard
-    input to /dev/null only if job control is not active.
+    input to /System/Devices/null only if job control is not active.
 
 ll. Fixed a possible infinite recursion problem when `fc ""=abc' (a null
     pattern) is used to re-execute a previous command.
@@ -1848,16 +1848,16 @@
 
 d.  System-specific configuration changes for:  Tru 64, Interix
 
-e.  Bashbug now uses /usr/bin/editor as one of the editing alternatives, and
+e.  Bashbug now uses /System/Tools/editor as one of the editing alternatives, and
     will use mktemp(1) or tempfile(1), if present, for temporary file creation.
 
 f.  Bash no longer performs a binary file check on a script argument that's
-    really a tty (like /dev/fd/0 or /dev/stdin).
+    really a tty (like /System/Devices/fd/0 or /System/Devices/stdin).
 
 g.  Fixed a bug in the execution of shell scripts that caused the effects of
     $BASH_ENV to be undone in some cases.
 
-h.  Fixed several bugs that made `bash [-i] /dev/stdin' not work correctly.
+h.  Fixed several bugs that made `bash [-i] /System/Devices/stdin' not work correctly.
 
 i.  Several changes to the job control code to avoid some signal state
     manipulation.
@@ -1940,7 +1940,7 @@
 
 e.  Fixed a file descriptor leak in the history file manipulation code that
     was tripped when attempting to truncate a non-regular file (like
-    /dev/null).
+    /System/Devices/null).
 
 f.  Some existing variables are now documented and part of the public
     interface (declared in readline.h):  rl_explict_arg, rl_numeric_arg,
@@ -2228,7 +2228,7 @@
 a.  Added a new `--init-file' invocation argument as a synonym for `--rcfile',
     per the new GNU coding standards.
 
-b.  The /dev/tcp and /dev/udp redirections now accept service names as well as
+b.  The /System/Devices/tcp and /System/Devices/udp redirections now accept service names as well as
     port numbers.
 
 c.  `complete' and `compgen' now take a `-o value' option, which controls some
@@ -2426,7 +2426,7 @@
     pathnames beginning with `//' if $HOME == `/'.
 
 t.  Fixed a couple of autoconf tests to avoid creating files with fixed names
-    in /tmp.
+    in /System/TemporaryFiles.
 
 u.  The `trap' and `kill' builtins now know the names of the POSIX.1b real-
     time signals on systems which support them.
@@ -2525,7 +2525,7 @@
 m.  Configuration changes were made for: Rhapsody, Mac OS, FreeBSD-3.x.
 
 n.  Fixed a problem with hostname-to-ip-address translation in the
-    /dev/(tcp|udp)/hostname/port redirection code.
+    /System/Devices/(tcp|udp)/hostname/port redirection code.
 
 o.  The texinfo manual has been reorganized slightly.
 
@@ -2819,11 +2819,11 @@
 	-s		don't echo input chars as they are read
 
 i.  The redirection code now handles several filenames specially:
-    /dev/fd/N, /dev/stdin, /dev/stdout, and /dev/stderr, whether or
+    /System/Devices/fd/N, /System/Devices/stdin, /System/Devices/stdout, and /System/Devices/stderr, whether or
     not they are present in the file system.
 
 j.  The redirection code now recognizes pathnames of the form
-    /dev/tcp/host/port and /dev/udp/host/port, and tries to open a socket
+    /System/Devices/tcp/host/port and /System/Devices/udp/host/port, and tries to open a socket
     of the appropriate type to the specified port on the specified host.
 
 k.  The ksh-93 ${!prefix*} expansion, which expands to the names of all
@@ -3251,7 +3251,7 @@
     not reported if the shell is compiled -DDONT_REPORT_SIGPIPE.
 
 c.  Some changes were made to builtins/psize.sh and support/bashbug.sh to
-    attempt to avoid some /tmp file races and surreptitious file
+    attempt to avoid some /System/TemporaryFiles file races and surreptitious file
     substitutions.
 
 d.  Fixed a bug that caused the shell not to compile if configured with
@@ -3543,7 +3543,7 @@
     It is enabled by default.
 
 m.  There is a new configuration #define in config.h.top that, when enabled,
-    will cause all login shells to source /etc/profile and one of the user-
+    will cause all login shells to source /System/Settings/profile and one of the user-
     specific login shell startup files, whether or not the shell is
     interactive.
 
@@ -3827,14 +3827,14 @@
 
 g.  OS-specific code changes were made for: QNX.
 
-h.  A more meaningful message is now printed when the file in /tmp for a
+h.  A more meaningful message is now printed when the file in /System/TemporaryFiles for a
     here document cannot be created.
 
 i.  Many changes to the shell's variable initialization code to speed
     non-interactive startup.
 
 j.  Changes to the non-job-control code so that it does not try to open
-    /dev/tty.
+    /System/Devices/tty.
 
 k.  The output of `set' and `export' is once again sorted, as POSIX wants.
 
@@ -4000,7 +4000,7 @@
     in the body of a here document after `set -u' had been executed was
     fixed.
 
-ff. Implicit input redirections from /dev/null for asynchronous commands
+ff. Implicit input redirections from /System/Devices/null for asynchronous commands
     are now handled better.
 
 gg. A bug that caused the shell to fail to compile when configured with
@@ -4287,7 +4287,7 @@
 
 m.  An interactive shell invoked as `sh' now reads and executes commands
     from the file named by $ENV when it starts up.  If it's a login shell,
-    it does this after reading /etc/profile and ~/.profile.
+    it does this after reading /System/Settings/profile and ~/.profile.
 
 n.  The file named by $ENV is never read by non-interactive shells.
 
@@ -4410,7 +4410,7 @@
     operator is checked for first, before checking that the first argument
     is `!'.
 
-e.  2''>/dev/null is no longer equivalent to 2>/dev/null.
+e.  2''>/System/Devices/null is no longer equivalent to 2>/System/Devices/null.
 
 f.  Parser error messages were regularized, and in most cases the name of
     the shell script being read by a non-interactive shell is not printed
@@ -4447,7 +4447,7 @@
 p.  `test' now handles `-a' and `-o' as binary operators when three arguments
     are supplied, and correctly parses `( word )' as equivalent to `word'.
 
-q.  `test' was fixed so that file names of the form /dev/fd/NN mean the same
+q.  `test' was fixed so that file names of the form /System/Devices/fd/NN mean the same
     thing on all systems, even Linux.
 
 r.  Fixed a bug in the globbing code that caused patterns with multiple
diff -urN bash-3.0/COMPAT bash-3.0-STEP/COMPAT
--- bash-3.0/COMPAT	2004-07-17 13:32:11.000000000 +1200
+++ bash-3.0-STEP/COMPAT	2005-08-25 00:46:55.394219544 +1200
@@ -175,7 +175,7 @@
 
 	export LC_COLLATE=C
 
-    into /etc/profile and inspect any shell scripts run from cron for
+    into /System/Settings/profile and inspect any shell scripts run from cron for
     constructs like [A-Z].  This will prevent things like
 
 	rm [A-Z]*
diff -urN bash-3.0/CWRU/changelog bash-3.0-STEP/CWRU/changelog
--- bash-3.0/CWRU/changelog	2004-07-18 07:44:32.000000000 +1200
+++ bash-3.0-STEP/CWRU/changelog	2005-08-25 00:47:15.624144128 +1200
@@ -9,7 +9,7 @@
 	  returns; don't just rely on fwrite() failing
 
 support/bashbug.sh
-	- set TMPDIR to /tmp if it's null or unset
+	- set TMPDIR to /System/TemporaryFiles if it's null or unset
 	- use $TMPDIR in the TEMP tempfile name template
 	- fixed the call to `mktemp', if it exists, to make it more portable
 
@@ -141,7 +141,7 @@
 shell.c
 	- call init_noninteractive() in open_shell_script if forced_interactive
 	  is non-zero (the shell was started with -i) and fd_is_tty is 0
-	  (the script file is a real file, not something like /dev/stdin),
+	  (the script file is a real file, not something like /System/Devices/stdin),
 	  since it wasn't done earlier
 
 builtins/printf.def
@@ -412,7 +412,7 @@
 	- fix check for overflow when setting limit to work when int is 32
 	  bits and RLIMTYPE is 64
 
-lib/sh/tmpfile.c
+lib/sh/System/TemporaryFilesfile.c
 	- don't truncate the result of time(3) to int; just use time_t,
 	  since it's being assigned to an `unsigned long'
 
@@ -706,7 +706,7 @@
 lib/readline/{{bind,isearch}.c,rlprivate.h}
 	- _rl_isearch_terminators is now a char *, not unsigned char *
 
-{subst,variables,lib/sh/tmpfile}.c
+{subst,variables,lib/sh/System/TemporaryFilesfile}.c
 	- dollar_dollar_pid is now a `pid_t' instead of `int'
 
 variables.c
@@ -933,11 +933,11 @@
 	- added ERR trap tests
 
 subst.c
-	- on machines without /dev/fd, change the named pipe fifo list to a
+	- on machines without /System/Devices/fd, change the named pipe fifo list to a
 	  list of structs containing pathname and proc information
 	- change unlink_fifo_list to kill the proc in the fifo list with
 	  signal 0 and not remove the fifo if the proc is still alive.  This
-	  should fix the problem on those backward systems without /dev/fd
+	  should fix the problem on those backward systems without /System/Devices/fd
 	  where fifos were removed when a job using process substitution was
 	  suspended
 
@@ -1139,7 +1139,7 @@
 				   7/31
 				   ----
 execute_cmd.c
-	- in execute_connection, force stdin to /dev/null for asynchronous
+	- in execute_connection, force stdin to /System/Devices/null for asynchronous
 	  commands if job control is not active, not just if the shell is
 	  running a shell script (since you can run `set -m' in a script)
 
@@ -1335,7 +1335,7 @@
 	- changed `for' command grammar to allow missing word list after `IN'
 	  token, like latest POSIX drafts require
 
-lib/sh/tmpfile.c
+lib/sh/System/TemporaryFilesfile.c
 	- in sh_mktmpname(), check for filenum == 0 and init to non-zero number
 	  in this case.  it can happen on arithmetic overflow
 
@@ -1344,7 +1344,7 @@
 	  distribution to allow for intermediate versions, like 2.05a
 
 support/config.guess
-	- removed the addition of the output of `/usr/bin/objformat' when
+	- removed the addition of the output of `/System/Tools/objformat' when
 	  creating the canonical name on FreeBSD machines, so the canonical
 	  name is once again `freebsd4.2' instead of `freebsdelf4.2'
 
@@ -1903,7 +1903,7 @@
 
 				   9/12
 				   ----
-lib/sh/tmpfile.c
+lib/sh/System/TemporaryFilesfile.c
 	- use `^' instead of `*' in sh_mktmpname to make filenames a bit
 	  more random
 
@@ -2757,7 +2757,7 @@
 {make_cmd,pcomplete,test}.c,parse.y
 	- some minor changes to shut up gcc warnings
 
-lib/sh/tmpfile.c
+lib/sh/System/TemporaryFilesfile.c
 	- fixed sh_mktmpfp to avoid file descriptor leaks in the case that
 	  sh_mktmpfd succeeds but fdopen fails for some reason
 	- change sh_mktmpfd to use the same scheme for computing `filenum'
@@ -2770,7 +2770,7 @@
 
 support/{fixlinks,mkclone}
 	- use mktemp if it's available for the symlink test
-	- use $TMPDIR instead of hardcoding /tmp; default to /tmp
+	- use $TMPDIR instead of hardcoding /System/TemporaryFiles; default to /System/TemporaryFiles
 	- use a better filename for the symlink test instead of `z'
 
 support/bashbug.sh
@@ -3377,7 +3377,7 @@
 	  signal handler call path, and race conditions accessing the
 	  PIPESTATUS array will result for things like
 
-		while true; do date; done | cat > /dev/null
+		while true; do date; done | cat > /System/Devices/null
 
 				   12/5
 				   ----
@@ -3650,7 +3650,7 @@
 
 				   12/18
 				   -----
-lib/sh/tmpfile.c
+lib/sh/System/TemporaryFilesfile.c
 	- include posixtime.h for time() extern declaration
 
 support/bashversion.c
@@ -5081,7 +5081,7 @@
 
 bashline.c
 	- new function bash_servicename_completion_function, for completing
-	  service names from /etc/services
+	  service names from /System/Settings/services
 
 bashline.h
 	- new extern declaration for bash_servicename_completion_function
@@ -6481,8 +6481,8 @@
 				    9/7
 				    ---
 aclocal.m4
-	- redirect stdin from /dev/null in BASH_CHECK_DEV_FD before testing
-	  the readability of /dev/fd/0, so we're dealing with a known quantity
+	- redirect stdin from /System/Devices/null in BASH_CHECK_DEV_FD before testing
+	  the readability of /System/Devices/fd/0, so we're dealing with a known quantity
 
 				   9/11
 				   ----
@@ -6518,7 +6518,7 @@
 	  compatibility)
 
 aclocal.m4
-	- when testing readability of /dev/stdin, redirect stdin from /dev/null
+	- when testing readability of /System/Devices/stdin, redirect stdin from /System/Devices/null
 	  to make sure it's a readable file
 
 				   9/17
@@ -6528,7 +6528,7 @@
 	  just use it if it's present
 
 tests/read2.sub
-	- redirect from /dev/tty when using `read -t' 
+	- redirect from /System/Devices/tty when using `read -t' 
 
 				   9/20
 				   ----
@@ -7664,7 +7664,7 @@
 				    ---
 execute_cmd.c
 	- in execute_null_command, if redirections are supplied, make sure
-	  things like 3</etc/passwd are undone immediately, since they're
+	  things like 3</System/Settings/passwd are undone immediately, since they're
 	  being done in the current shell
 	- functions now inherit the RETURN trap only if function tracing is
 	  on for that function or globally
@@ -9192,7 +9192,7 @@
 general.h
 	- extern declarations for new functions
 
-lib/sh/tmpfile.c
+lib/sh/System/TemporaryFilesfile.c
 	- use file_iswdir() to make sure the temporary directory used for
 	  here documents and other temp files is writable in get_sys_tmpdir()
 
diff -urN bash-3.0/CWRU/misc/bison bash-3.0-STEP/CWRU/misc/bison
--- bash-3.0/CWRU/misc/bison	2002-04-18 05:37:56.000000000 +1200
+++ bash-3.0-STEP/CWRU/misc/bison	2005-08-25 00:33:12.893258696 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 #
 # bison -- just call yacc
 #
@@ -23,4 +23,4 @@
 	shift
 fi
 
-exec /usr/bin/yacc ${1+"$@"}
+exec /System/Tools/yacc ${1+"$@"}
diff -urN bash-3.0/INSTALL bash-3.0-STEP/INSTALL
--- bash-3.0/INSTALL	2004-07-28 01:13:39.000000000 +1200
+++ bash-3.0-STEP/INSTALL	2005-08-25 00:46:55.497203888 +1200
@@ -140,7 +140,7 @@
 can create a site shell script called `config.site' that gives default
 values for variables like `CC', `cache_file', and `prefix'.  `configure'
 looks for `PREFIX/share/config.site' if it exists, then
-`PREFIX/etc/config.site' if it exists.  Or, you can set the
+`PREFIX/System/Settings/config.site' if it exists.  Or, you can set the
 `CONFIG_SITE' environment variable to the location of the site script.
 A warning: the Bash `configure' looks for a site script, but not all
 `configure' scripts do.
@@ -152,7 +152,7 @@
 
 `--cache-file=FILE'
      Use and save the results of the tests in FILE instead of
-     `./config.cache'.  Set FILE to `/dev/null' to disable caching, for
+     `./config.cache'.  Set FILE to `/System/Devices/null' to disable caching, for
      debugging `configure'.
 
 `--help'
@@ -327,7 +327,7 @@
 
 `--enable-net-redirections'
      This enables the special handling of filenames of the form
-     `/dev/tcp/HOST/PORT' and `/dev/udp/HOST/PORT' when used in
+     `/System/Devices/tcp/HOST/PORT' and `/System/Devices/udp/HOST/PORT' when used in
      redirections (*note Redirections::).
 
 `--enable-process-substitution'
diff -urN bash-3.0/MANIFEST bash-3.0-STEP/MANIFEST
--- bash-3.0/MANIFEST	2004-05-07 01:01:58.000000000 +1200
+++ bash-3.0-STEP/MANIFEST	2005-08-25 00:47:15.632142912 +1200
@@ -421,7 +421,7 @@
 lib/sh/strtrans.c	f
 lib/sh/times.c		f
 lib/sh/timeval.c	f
-lib/sh/tmpfile.c	f
+lib/sh/System/TemporaryFilesfile.c	f
 lib/sh/vprint.c		f
 lib/sh/xstrchr.c	f
 lib/sh/zcatfd.c		f
diff -urN bash-3.0/Makefile.in bash-3.0-STEP/Makefile.in
--- bash-3.0/Makefile.in	2004-03-18 02:34:39.000000000 +1300
+++ bash-3.0-STEP/Makefile.in	2005-08-25 00:47:15.642141392 +1200
@@ -555,7 +555,7 @@
 y.tab.o: y.tab.c ${GRAM_H} command.h ${BASHINCDIR}/stdc.h input.h
 ${GRAM_H}:	y.tab.h
 	@-if test -f y.tab.h ; then \
-		cmp -s $@ y.tab.h 2>/dev/null || cp -p y.tab.h $@; \
+		cmp -s $@ y.tab.h 2>/System/Devices/null || cp -p y.tab.h $@; \
 	fi
 y.tab.c y.tab.h: parse.y
 #	-if test -f y.tab.h; then mv -f y.tab.h old-y.tab.h; fi
diff -urN bash-3.0/NEWS bash-3.0-STEP/NEWS
--- bash-3.0/NEWS	2004-07-03 10:57:20.000000000 +1200
+++ bash-3.0-STEP/NEWS	2005-08-25 00:46:55.520200392 +1200
@@ -245,7 +245,7 @@
     allocation and free time.
 
 q.  The `complete' and `compgen' builtins now have a new `-s/-A service'
-    option to complete on names from /etc/services.
+    option to complete on names from /System/Settings/services.
 
 r.  `read' has a new `-u fd' option to read from a specified file descriptor.
 
@@ -441,7 +441,7 @@
 a.  Added a new `--init-file' invocation argument as a synonym for `--rcfile',
     per the new GNU coding standards.
 
-b.  The /dev/tcp and /dev/udp redirections now accept service names as well as
+b.  The /System/Devices/tcp and /System/Devices/udp redirections now accept service names as well as
     port numbers.
 
 c.  `complete' and `compgen' now take a `-o value' option, which controls some
@@ -534,11 +534,11 @@
         -s              don't echo input chars as they are read
 
 i.  The redirection code now handles several filenames specially:
-    /dev/fd/N, /dev/stdin, /dev/stdout, and /dev/stderr, whether or
+    /System/Devices/fd/N, /System/Devices/stdin, /System/Devices/stdout, and /System/Devices/stderr, whether or
     not they are present in the file system.
 
 j.  The redirection code now recognizes pathnames of the form
-    /dev/tcp/host/port and /dev/udp/host/port, and tries to open a socket
+    /System/Devices/tcp/host/port and /System/Devices/udp/host/port, and tries to open a socket
     of the appropriate type to the specified port on the specified host.
 
 k.  The ksh-93 ${!prefix*} expansion, which expands to the names of all
@@ -722,7 +722,7 @@
     It is enabled by default.
 
 m.  There is a new configuration #define in config.h.top that, when enabled,
-    will cause all login shells to source /etc/profile and one of the user-
+    will cause all login shells to source /System/Settings/profile and one of the user-
     specific login shell startup files, whether or not the shell is
     interactive.  
     
@@ -832,7 +832,7 @@
 g.  If invoked as `sh', bash now enters posix mode after reading the
     startup files, and reads and executes commands from the file named
     by $ENV if interactive (as POSIX.2 specifies).  A login shell invoked
-    as `sh' reads $ENV after /etc/profile and ~/.profile.
+    as `sh' reads $ENV after /System/Settings/profile and ~/.profile.
 
 h.  There is a new reserved word, `time', for timing pipelines, builtin
     commands, and shell functions.  It uses the value of the TIMEFORMAT
diff -urN bash-3.0/NOTES bash-3.0-STEP/NOTES
--- bash-3.0/NOTES	2003-10-15 04:27:37.000000000 +1300
+++ bash-3.0-STEP/NOTES	2005-08-25 00:47:07.108438712 +1200
@@ -41,7 +41,7 @@
 4.  I've had reports that username completion (as well as tilde expansion
     and \u prompt expansion) does not work on IRIX 5.3 when linking with
     -lnsl.  This is only a problem when you're running NIS, since
-    apparently -lnsl supports only /etc/passwd and not the NIS functions
+    apparently -lnsl supports only /System/Settings/passwd and not the NIS functions
     for retrieving usernames and passwords.  Editing the Makefile after
     configure runs and removing the `-lnsl' from the assignment to `LIBS'
     fixes the problem.
@@ -50,11 +50,11 @@
     versions of Red Hat Linux.  Running `makewhatis' with bash-2.0 or
     later versions results in error messages like this:
 
-    /usr/sbin/makewhatis: cd: manpath: No such file or directory
-    /usr/sbin/makewhatis: manpath/whatis: No such file or directory
+    /System/AdminTools/makewhatis: cd: manpath: No such file or directory
+    /System/AdminTools/makewhatis: manpath/whatis: No such file or directory
     chmod: manpath/whatis: No such file or directory
-    /usr/sbin/makewhatis: cd: catpath: No such file or directory
-    /usr/sbin/makewhatis: catpath/whatis: No such file or directory
+    /System/AdminTools/makewhatis: cd: catpath: No such file or directory
+    /System/AdminTools/makewhatis: catpath/whatis: No such file or directory
     chmod: catpath/whatis: No such file or directory
 
     The problem is with `makewhatis'.  Red Hat (and possibly other
@@ -96,7 +96,7 @@
     the SIGINT, and bash reports it, causing unexpected console output
     while the system is booting that looks something like
 
-	starting daemons: syslogd/etc/rc.d/rc.M: line 29: 38 Interrupt ${NET}/syslogd
+	starting daemons: syslogd/System/Settings/rc.d/rc.M: line 29: 38 Interrupt ${NET}/syslogd
 
     Bash-2.0 reports events such as processes dying in scripts due to
     signals when the standard output is a tty.  Bash-1.14.x and previous
@@ -110,7 +110,7 @@
     expected event, and exit cleanly.
 
 7.  Several people have reported that `dip' (a program for SLIP/PPP
-    on Linux) does not work with bash-2.0 installed as /bin/sh.
+    on Linux) does not work with bash-2.0 installed as /System/Tools/sh.
 
     I don't run any Linux boxes myself, and do not have the dip
     code handy to look at, but the `problem' with bash-2.0, as
@@ -121,7 +121,7 @@
     This means, among other things, that setuid or setgid programs
     which call system(3) (a horrendously bad practice in any case)
     relinquish their setuid/setgid status in the child that's forked
-    to execute /bin/sh. 
+    to execute /System/Tools/sh. 
 
     The following is an *unofficial* patch to bash-2.0 that causes it
     to not require `-p' to run setuid or setgid if invoked as `sh'.
@@ -161,13 +161,13 @@
 9.  Hints for building under Minix 2.0 (Contributed by Terry R. McConnell,
     <tmc@barnyard.syr.edu>)
 
-   The version of /bin/sh distributed with Minix is not up to the job of
-   running the configure script. The easiest solution is to swap /bin/sh
-   with /usr/bin/ash. Then use chmem(1) to increase the memory allocated
-   to /bin/sh. The following settings are known to work:
+   The version of /System/Tools/sh distributed with Minix is not up to the job of
+   running the configure script. The easiest solution is to swap /System/Tools/sh
+   with /System/Tools/ash. Then use chmem(1) to increase the memory allocated
+   to /System/Tools/sh. The following settings are known to work:
 
    text         data     bss   stack  memory
-   63552  9440          3304   65536  141832  /bin/sh
+   63552  9440          3304   65536  141832  /System/Tools/sh
 
    If you have problems with make or yacc it may be worthwhile first to
    install the GNU versions of these utilities before attempting to build
@@ -188,9 +188,9 @@
 
    Configure will fail to notice that many things like uid_t are indeed
    typedef'd in <sys/types.h>, because it uses egrep for this purpose
-   and minix has no egrep. You could try making a link /usr/bin/egrep -->
-   /usr/bin/grep. Better is to install the GNU version of grep in
-   /usr/local/bin and make the link /usr/local/bin/egrep -->/usr/local/bin/grep.
+   and minix has no egrep. You could try making a link /System/Tools/egrep -->
+   /System/Tools/grep. Better is to install the GNU version of grep in
+   /usr/local/bin and make the link /usr/local/System/Tools/egrep -->/usr/local/System/Tools/grep.
    (These must be hard links, of course, since Minix does not support
    symbolic links.)
 
@@ -210,7 +210,7 @@
 
     It's not possible to build a completely statically-linked binary, since
     part of the C library depends on dynamic linking.  The following recipe
-    assumes that you're using gcc and the Solaris ld (/usr/ccs/bin/ld) on
+    assumes that you're using gcc and the Solaris ld (/usr/ccs/System/Tools/ld) on
     Solaris 2.5.x or 2.6:
 
 	configure --enable-static-link
@@ -230,36 +230,36 @@
     If you want to completely remove any dependence on /usr, perhaps
     to put a copy of bash in /sbin and have it available when /usr is
     not mounted, force the build process to use the shared dl.so library
-    in /etc/lib.
+    in /System/Settings/lib.
 
     For gcc, this would be something like
 
 	configure --enable-static-link
-	make STATIC_LD= LOCAL_LIBS='-Wl,-B,dynamic -Wl,-R/etc/lib -ldl -Wl,-B,static'
+	make STATIC_LD= LOCAL_LIBS='-Wl,-B,dynamic -Wl,-R/System/Settings/lib -ldl -Wl,-B,static'
 
     For Sun's WS4.2 cc
 
 	configure --enable-static-link
-	make STATIC_LD=  LOCAL_LIBS='-B dynamic -R/etc/lib -ldl -B static'
+	make STATIC_LD=  LOCAL_LIBS='-B dynamic -R/System/Settings/lib -ldl -B static'
 
     seems to work, at least on Solaris 2.5.1:
 
 	thor(2)$ ldd bash
-	        libdl.so.1 =>    /etc/lib/libdl.so.1
+	        libdl.so.1 =>    /System/Settings/lib/libdl.so.1
 
     On Solaris 7 (Solaris 8, using the version of gcc on the free software
     CD-ROM), the following recipe appears to work for gcc:
 
 	configure --enable-static-link
-	make STATIC_LD='-Wl,-Bstatic' LOCAL_LIBS='-Wl,-Bdynamic -Wl,-R/etc/lib -ldl -Wl,-Bstatic'
+	make STATIC_LD='-Wl,-Bstatic' LOCAL_LIBS='-Wl,-Bdynamic -Wl,-R/System/Settings/lib -ldl -Wl,-Bstatic'
 
 	thor.ins.cwru.edu(2)$ ldd bash
-	        libdl.so.1 =>    /etc/lib/libdl.so.1
+	        libdl.so.1 =>    /System/Settings/lib/libdl.so.1
 
     Make the analogous changes if you are running Sun's C Compiler.
 
-    I have received word that adding -L/etc/lib (or the equivalent
-    -Wl,-L/etc/lib) might also be necessary, in addition to the -R/etc/lib.
+    I have received word that adding -L/System/Settings/lib (or the equivalent
+    -Wl,-L/System/Settings/lib) might also be necessary, in addition to the -R/System/Settings/lib.
 
 12. Configuring bash to build it in a cross environment.  Currently only
     two native versions can be compiled this way, cygwin32 and x86 BeOS.
@@ -298,7 +298,7 @@
 
         export LC_COLLATE=C
 
-    into /etc/profile and inspect any shell scripts run from cron for
+    into /System/Settings/profile and inspect any shell scripts run from cron for
     constructs like [A-Z].  This will prevent things like
 
 	rm [A-Z]*
@@ -315,7 +315,7 @@
 	2.  If desired, edit pathnames.h to set the values of SYS_PROFILE and
 	    DEFAULT_HOSTS_FILE appropriately.
 
-	3.  export CONFIG_SHELL=$INTERIX_ROOT/bin/sh
+	3.  export CONFIG_SHELL=$INTERIX_ROOT/System/Tools/sh
 
 	4.  ./configure --prefix=$INTERIX_ROOT/usr/local (or wherever you
 	    want it).
diff -urN bash-3.0/aclocal.m4 bash-3.0-STEP/aclocal.m4
--- bash-3.0/aclocal.m4	2004-05-14 05:37:25.000000000 +1200
+++ bash-3.0-STEP/aclocal.m4	2005-08-25 00:47:15.888104000 +1200
@@ -273,7 +273,7 @@
 main()
 {
   int fd1, fd2, fl;
-  fd1 = open("/dev/null", 2);
+  fd1 = open("/System/Devices/null", 2);
   if (fcntl(fd1, 2, 1) < 0)
     exit(1);
   fd2 = dup2(fd1, 1);
@@ -336,18 +336,18 @@
 {
 DIR *dir;
 int fd, err;
-err = mkdir("/tmp/bash-aclocal", 0700);
+err = mkdir("/System/TemporaryFiles/bash-aclocal", 0700);
 if (err < 0) {
   perror("mkdir");
   exit(1);
 }
-unlink("/tmp/bash-aclocal/not_a_directory");
-fd = open("/tmp/bash-aclocal/not_a_directory", O_WRONLY|O_CREAT|O_EXCL, 0666);
+unlink("/System/TemporaryFiles/bash-aclocal/not_a_directory");
+fd = open("/System/TemporaryFiles/bash-aclocal/not_a_directory", O_WRONLY|O_CREAT|O_EXCL, 0666);
 write(fd, "\n", 1);
 close(fd);
-dir = opendir("/tmp/bash-aclocal/not_a_directory");
-unlink("/tmp/bash-aclocal/not_a_directory");
-rmdir("/tmp/bash-aclocal");
+dir = opendir("/System/TemporaryFiles/bash-aclocal/not_a_directory");
+unlink("/System/TemporaryFiles/bash-aclocal/not_a_directory");
+rmdir("/System/TemporaryFiles/bash-aclocal");
 exit (dir == 0);
 }], bash_cv_opendir_not_robust=yes,bash_cv_opendir_not_robust=no,
     [AC_MSG_WARN(cannot check opendir if cross compiling -- defaulting to no)
@@ -1423,19 +1423,19 @@
 #if defined (NeXT)
 exit (1);
 #endif
-err = mkdir("/tmp/bash-aclocal", 0700);
+err = mkdir("/System/TemporaryFiles/bash-aclocal", 0700);
 if (err < 0) {
   perror ("mkdir");
   exit(1);
 }
-fd = mknod ("/tmp/bash-aclocal/sh-np-autoconf", 0666 | S_IFIFO, 0);
+fd = mknod ("/System/TemporaryFiles/bash-aclocal/sh-np-autoconf", 0666 | S_IFIFO, 0);
 if (fd == -1) {
-  rmdir ("/tmp/bash-aclocal");
+  rmdir ("/System/TemporaryFiles/bash-aclocal");
   exit (1);
 }
 close(fd);
-unlink ("/tmp/bash-aclocal/sh-np-autoconf");
-rmdir ("/tmp/bash-aclocal");
+unlink ("/System/TemporaryFiles/bash-aclocal/sh-np-autoconf");
+rmdir ("/System/TemporaryFiles/bash-aclocal");
 exit(0);
 }], bash_cv_sys_named_pipes=present, bash_cv_sys_named_pipes=missing,
     [AC_MSG_WARN(cannot check for named pipes if cross-compiling -- defaulting to missing)
@@ -1538,11 +1538,11 @@
 ])
 
 AC_DEFUN(BASH_CHECK_DEV_FD,
-[AC_MSG_CHECKING(whether /dev/fd is available)
+[AC_MSG_CHECKING(whether /System/Devices/fd is available)
 AC_CACHE_VAL(bash_cv_dev_fd,
-[if test -d /dev/fd  && test -r /dev/fd/0 < /dev/null; then
+[if test -d /System/Devices/fd  && test -r /System/Devices/fd/0 < /System/Devices/null; then
    bash_cv_dev_fd=standard
- elif test -d /proc/self/fd && test -r /proc/self/fd/0 < /dev/null; then
+ elif test -d /System/Processes/self/fd && test -r /System/Processes/self/fd/0 < /System/Devices/null; then
    bash_cv_dev_fd=whacky
  else
    bash_cv_dev_fd=absent
@@ -1551,19 +1551,19 @@
 AC_MSG_RESULT($bash_cv_dev_fd)
 if test $bash_cv_dev_fd = "standard"; then
   AC_DEFINE(HAVE_DEV_FD)
-  AC_DEFINE(DEV_FD_PREFIX, "/dev/fd/")
+  AC_DEFINE(DEV_FD_PREFIX, "/System/Devices/fd/")
 elif test $bash_cv_dev_fd = "whacky"; then
   AC_DEFINE(HAVE_DEV_FD)
-  AC_DEFINE(DEV_FD_PREFIX, "/proc/self/fd/")
+  AC_DEFINE(DEV_FD_PREFIX, "/System/Processes/self/fd/")
 fi
 ])
 
 AC_DEFUN(BASH_CHECK_DEV_STDIN,
-[AC_MSG_CHECKING(whether /dev/stdin stdout stderr are available)
+[AC_MSG_CHECKING(whether /System/Devices/stdin stdout stderr are available)
 AC_CACHE_VAL(bash_cv_dev_stdin,
-[if test -d /dev/fd && test -r /dev/stdin < /dev/null; then
+[if test -d /System/Devices/fd && test -r /System/Devices/stdin < /System/Devices/null; then
    bash_cv_dev_stdin=present
- elif test -d /proc/self/fd && test -r /dev/stdin < /dev/null; then
+ elif test -d /System/Processes/self/fd && test -r /System/Devices/stdin < /System/Devices/null; then
    bash_cv_dev_stdin=present
  else
    bash_cv_dev_stdin=absent
@@ -2691,7 +2691,7 @@
 AC_DEFUN([AC_LIB_PROG_LD_GNU],
 [AC_CACHE_CHECK([if the linker ($LD) is GNU ld], acl_cv_prog_gnu_ld,
 [# I'd rather use --version here, but apparently some GNU ld's only accept -v.
-if $LD -v 2>&1 </dev/null | egrep '(GNU|with BFD)' 1>&5; then
+if $LD -v 2>&1 </System/Devices/null | egrep '(GNU|with BFD)' 1>&5; then
   acl_cv_prog_gnu_ld=yes
 else
   acl_cv_prog_gnu_ld=no
@@ -2709,10 +2709,10 @@
 # Prepare PATH_SEPARATOR.
 # The user is always right.
 if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
+  echo "#! /System/Tools/sh" >conf$$.sh
   echo  "exit 0"   >>conf$$.sh
   chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
+  if (PATH="/nonexistent;."; conf$$.sh) >/System/Devices/null 2>&1; then
     PATH_SEPARATOR=';'
   else
     PATH_SEPARATOR=:
@@ -2736,7 +2736,7 @@
       [re_direlt='/[^/][^/]*/\.\./']
       # Canonicalize the path of ld
       ac_prog=`echo $ac_prog| sed 's%\\\\%/%g'`
-      while echo $ac_prog | grep "$re_direlt" > /dev/null 2>&1; do
+      while echo $ac_prog | grep "$re_direlt" > /System/Devices/null 2>&1; do
 	ac_prog=`echo $ac_prog| sed "s%$re_direlt%/%"`
       done
       test -z "$LD" && LD="$ac_prog"
@@ -2765,7 +2765,7 @@
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some GNU ld's only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then
+      if "$acl_cv_path_LD" -v 2>&1 < /System/Devices/null | egrep '(GNU|with BFD)' > /System/Devices/null; then
 	test "$with_gnu_ld" != no && break
       else
 	test "$with_gnu_ld" != yes && break
@@ -2888,7 +2888,7 @@
   AC_REQUIRE([AC_CONFIG_AUX_DIR_DEFAULT]) dnl we use $ac_aux_dir
   AC_CACHE_CHECK([for shared library run path origin], acl_cv_rpath, [
     CC="$CC" GCC="$GCC" LDFLAGS="$LDFLAGS" LD="$LD" with_gnu_ld="$with_gnu_ld" \
-    ${CONFIG_SHELL-/bin/sh} "$ac_aux_dir/config.rpath" "$host" > conftest.sh
+    ${CONFIG_SHELL-/System/Tools/sh} "$ac_aux_dir/config.rpath" "$host" > conftest.sh
     . ./conftest.sh
     rm -f ./conftest.sh
     acl_cv_rpath=done
@@ -3576,8 +3576,8 @@
   dnl The first test excludes Solaris msgfmt and early GNU msgfmt versions.
   dnl The second test excludes FreeBSD msgfmt.
   AM_PATH_PROG_WITH_TEST(MSGFMT, msgfmt,
-    [$ac_dir/$ac_word --statistics /dev/null >/dev/null 2>&1 &&
-     (if $ac_dir/$ac_word --statistics /dev/null 2>&1 >/dev/null | grep usage >/dev/null; then exit 1; else exit 0; fi)],
+    [$ac_dir/$ac_word --statistics /System/Devices/null >/System/Devices/null 2>&1 &&
+     (if $ac_dir/$ac_word --statistics /System/Devices/null 2>&1 >/System/Devices/null | grep usage >/System/Devices/null; then exit 1; else exit 0; fi)],
     :)
   AC_PATH_PROG(GMSGFMT, gmsgfmt, $MSGFMT)
 
@@ -3585,23 +3585,23 @@
   dnl The first test excludes Solaris xgettext and early GNU xgettext versions.
   dnl The second test excludes FreeBSD xgettext.
   AM_PATH_PROG_WITH_TEST(XGETTEXT, xgettext,
-    [$ac_dir/$ac_word --omit-header --copyright-holder= --msgid-bugs-address= /dev/null >/dev/null 2>&1 &&
-     (if $ac_dir/$ac_word --omit-header --copyright-holder= --msgid-bugs-address= /dev/null 2>&1 >/dev/null | grep usage >/dev/null; then exit 1; else exit 0; fi)],
+    [$ac_dir/$ac_word --omit-header --copyright-holder= --msgid-bugs-address= /System/Devices/null >/System/Devices/null 2>&1 &&
+     (if $ac_dir/$ac_word --omit-header --copyright-holder= --msgid-bugs-address= /System/Devices/null 2>&1 >/System/Devices/null | grep usage >/System/Devices/null; then exit 1; else exit 0; fi)],
     :)
   dnl Remove leftover from FreeBSD xgettext call.
   rm -f messages.po
 
   dnl Search for GNU msgmerge 0.11 or newer in the PATH.
   AM_PATH_PROG_WITH_TEST(MSGMERGE, msgmerge,
-    [$ac_dir/$ac_word --update -q /dev/null /dev/null >/dev/null 2>&1], :)
+    [$ac_dir/$ac_word --update -q /System/Devices/null /System/Devices/null >/System/Devices/null 2>&1], :)
 
   dnl This could go away some day; the PATH_PROG_WITH_TEST already does it.
   dnl Test whether we really found GNU msgfmt.
   if test "$GMSGFMT" != ":"; then
     dnl If it is no GNU msgfmt we define it as : so that the
     dnl Makefiles still can work.
-    if $GMSGFMT --statistics /dev/null >/dev/null 2>&1 &&
-       (if $GMSGFMT --statistics /dev/null 2>&1 >/dev/null | grep usage >/dev/null; then exit 1; else exit 0; fi); then
+    if $GMSGFMT --statistics /System/Devices/null >/System/Devices/null 2>&1 &&
+       (if $GMSGFMT --statistics /System/Devices/null 2>&1 >/System/Devices/null | grep usage >/System/Devices/null; then exit 1; else exit 0; fi); then
       : ;
     else
       GMSGFMT=`echo "$GMSGFMT" | sed -e 's,^.*/,,'`
@@ -3616,8 +3616,8 @@
   if test "$XGETTEXT" != ":"; then
     dnl If it is no GNU xgettext we define it as : so that the
     dnl Makefiles still can work.
-    if $XGETTEXT --omit-header --copyright-holder= --msgid-bugs-address= /dev/null >/dev/null 2>&1 &&
-       (if $XGETTEXT --omit-header --copyright-holder= --msgid-bugs-address= /dev/null 2>&1 >/dev/null | grep usage >/dev/null; then exit 1; else exit 0; fi); then
+    if $XGETTEXT --omit-header --copyright-holder= --msgid-bugs-address= /System/Devices/null >/System/Devices/null 2>&1 &&
+       (if $XGETTEXT --omit-header --copyright-holder= --msgid-bugs-address= /System/Devices/null 2>&1 >/System/Devices/null | grep usage >/System/Devices/null; then exit 1; else exit 0; fi); then
       : ;
     else
       AC_MSG_RESULT(
@@ -3766,10 +3766,10 @@
 # Prepare PATH_SEPARATOR.
 # The user is always right.
 if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
+  echo "#! /System/Tools/sh" >conf$$.sh
   echo  "exit 0"   >>conf$$.sh
   chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
+  if (PATH="/nonexistent;."; conf$$.sh) >/System/Devices/null 2>&1; then
     PATH_SEPARATOR=';'
   else
     PATH_SEPARATOR=:
@@ -3780,11 +3780,11 @@
 # Find out how to test for executable files. Don't use a zero-byte file,
 # as systems may use methods other than mode bits to determine executability.
 cat >conf$$.file <<_ASEOF
-#! /bin/sh
+#! /System/Tools/sh
 exit 0
 _ASEOF
 chmod +x conf$$.file
-if test -x conf$$.file >/dev/null 2>&1; then
+if test -x conf$$.file >/System/Devices/null 2>&1; then
   ac_executable_p="test -x"
 else
   ac_executable_p="test -f"
diff -urN bash-3.0/bashline.c bash-3.0-STEP/bashline.c
--- bash-3.0/bashline.c	2004-07-06 15:22:12.000000000 +1200
+++ bash-3.0-STEP/bashline.c	2005-08-25 00:46:55.604187624 +1200
@@ -1631,7 +1631,7 @@
 }
 
 /*
- * A completion function for service names from /etc/services (or wherever).
+ * A completion function for service names from /System/Settings/services (or wherever).
  */
 char *
 bash_servicename_completion_function (text, state)
@@ -1689,7 +1689,7 @@
 }
 
 /*
- * A completion function for group names from /etc/group (or wherever).
+ * A completion function for group names from /System/Settings/group (or wherever).
  */
 char *
 bash_groupname_completion_function (text, state)
diff -urN bash-3.0/builtins/Makefile.in bash-3.0-STEP/builtins/Makefile.in
--- bash-3.0/builtins/Makefile.in	2004-01-22 08:22:50.000000000 +1300
+++ bash-3.0-STEP/builtins/Makefile.in	2005-08-25 00:33:47.788953744 +1200
@@ -161,12 +161,12 @@
 	@-if test -f builtext.h; then mv -f builtext.h old-builtext.h; fi
 	./$(MKBUILTINS) -externfile builtext.h -structfile builtins.c \
 	    -noproduction $(DIRECTDEFINE) $(HELPDIRDEFINE) $(DEFSRC)
-	@-if cmp -s old-builtext.h builtext.h 2>/dev/null; then \
+	@-if cmp -s old-builtext.h builtext.h 2>/System/Devices/null; then \
 		mv old-builtext.h builtext.h; \
 	 else \
 		$(RM) old-builtext.h; \
 	 fi
-	@-if cmp -s old-builtins.c builtins.c 2>/dev/null; then \
+	@-if cmp -s old-builtins.c builtins.c 2>/System/Devices/null; then \
 		mv old-builtins.c builtins.c; \
 	 else \
 		$(RM) old-builtins.c; \
@@ -234,7 +234,7 @@
 
 # maintainer special - for now
 po:	builtins.c
-	xgettext -L C -o $(topdir)/po/builtins.pot --keyword='N_' builtins.c 2>/dev/null
+	xgettext -L C -o $(topdir)/po/builtins.pot --keyword='N_' builtins.c 2>/System/Devices/null
 
 # dependencies
 
diff -urN bash-3.0/builtins/command.def bash-3.0-STEP/builtins/command.def
--- bash-3.0/builtins/command.def	2002-03-20 03:39:51.000000000 +1200
+++ bash-3.0-STEP/builtins/command.def	2005-08-25 00:47:15.892103392 +1200
@@ -143,7 +143,7 @@
   command->flags |= COMMAND_BUILTIN_FLAGS;
   command->value.Simple->flags |= COMMAND_BUILTIN_FLAGS;
 #if 0
-  /* This breaks for things like ( cd /tmp ; command z ababa ; echo next )
+  /* This breaks for things like ( cd /System/TemporaryFiles ; command z ababa ; echo next )
      or $(command echo a ; command echo b;) or even
      { command echo a; command echo b; } & */
   /* If we're in a subshell, see if we can get away without forking
diff -urN bash-3.0/builtins/echo.def bash-3.0-STEP/builtins/echo.def
--- bash-3.0/builtins/echo.def	2004-06-29 06:27:40.000000000 +1200
+++ bash-3.0-STEP/builtins/echo.def	2005-08-25 00:33:13.026238480 +1200
@@ -67,7 +67,7 @@
 #  define VALID_ECHO_OPTIONS "n"
 #endif /* !V9_ECHO */
 
-/* System V machines already have a /bin/sh with a v9 behaviour.  We
+/* System V machines already have a /System/Tools/sh with a v9 behaviour.  We
    give Bash the identical behaviour for these machines so that the
    existing system shells won't barf.  Regrettably, the SUS v2 has
    standardized the Sys V echo behavior.  This variable is external
diff -urN bash-3.0/builtins/psize.sh bash-3.0-STEP/builtins/psize.sh
--- bash-3.0/builtins/psize.sh	2001-11-02 04:57:35.000000000 +1300
+++ bash-3.0-STEP/builtins/psize.sh	2005-08-25 00:47:15.895102936 +1200
@@ -1,11 +1,11 @@
-#! /bin/sh
+#! /System/Tools/sh
 #
 # psize.sh -- determine this system's pipe size, and write a define to
 #             pipesize.h so ulimit.c can use it.
 
-: ${TMPDIR:=/tmp}
+: ${TMPDIR:=/System/TemporaryFiles}
 # try to use mktemp(1) if the system supports it
-{ TMPFILE="`mktemp $TMPDIR/pipsize.XXXXXX 2>/dev/null`"; } 2>/dev/null
+{ TMPFILE="`mktemp $TMPDIR/pipsize.XXXXXX 2>/System/Devices/null`"; } 2>/System/Devices/null
 used_mktemp=true
 
 if [ -z "$TMPFILE" ]; then
diff -urN bash-3.0/command.h bash-3.0-STEP/command.h
--- bash-3.0/command.h	2003-09-13 07:13:04.000000000 +1200
+++ bash-3.0-STEP/command.h	2005-08-25 00:33:47.795952680 +1200
@@ -144,7 +144,7 @@
 #define CMD_TIME_PIPELINE  0x80 /* Time a pipeline */
 #define CMD_TIME_POSIX	   0x100 /* time -p; use POSIX.2 time output spec. */
 #define CMD_AMPERSAND	   0x200 /* command & */
-#define CMD_STDIN_REDIR	   0x400 /* async command needs implicit </dev/null */
+#define CMD_STDIN_REDIR	   0x400 /* async command needs implicit </System/Devices/null */
 #define CMD_COMMAND_BUILTIN 0x0800 /* command executed by `command' builtin */
 
 /* What a command looks like. */
diff -urN bash-3.0/config-top.h bash-3.0-STEP/config-top.h
--- bash-3.0/config-top.h	2003-08-06 02:36:12.000000000 +1200
+++ bash-3.0-STEP/config-top.h	2005-08-25 00:47:07.515376848 +1200
@@ -52,14 +52,14 @@
 /* The default value of the PATH variable. */
 #ifndef DEFAULT_PATH_VALUE
 #define DEFAULT_PATH_VALUE \
-  "/usr/gnu/bin:/usr/local/bin:/bin:/usr/bin:."
+  "/usr/gnu/bin:/usr/local/bin:/bin:/System/Tools:."
 #endif
 
 /* The value for PATH when invoking `command -p'.  This is only used when
    the Posix.2 confstr () function, or CS_PATH define are not present. */
 #ifndef STANDARD_UTILS_PATH
 #define STANDARD_UTILS_PATH \
-  "/bin:/usr/bin:/sbin:/usr/sbin:/etc:/usr/etc"
+  "/bin:/System/Tools:/sbin:/System/AdminTools:/etc:/usr/etc"
 #endif
 
 /* Default primary and secondary prompt strings. */
@@ -73,10 +73,10 @@
 #define KSH_COMPATIBLE_SELECT
 
 /* System-wide .bashrc file for interactive shells. */
-/* #define SYS_BASHRC "/etc/bash.bashrc" */
+/* #define SYS_BASHRC "/System/Settings/bash.bashrc" */
 
 /* System-wide .bash_logout for login shells. */
-/* #define SYS_BASH_LOGOUT "/etc/bash.bash_logout" */
+/* #define SYS_BASH_LOGOUT "/System/Settings/bash.bash_logout" */
 
 /* Define this to make non-interactive shells begun with argv[0][0] == '-'
    run the startup files when not in posix mode. */
diff -urN bash-3.0/config.h.in bash-3.0-STEP/config.h.in
--- bash-3.0/config.h.in	2004-07-22 08:08:31.000000000 +1200
+++ bash-3.0-STEP/config.h.in	2005-08-25 00:47:04.163886352 +1200
@@ -128,7 +128,7 @@
    arithmetic for command. */
 #undef ARITH_FOR_COMMAND
 
-/* Define NETWORK_REDIRECTIONS if you want /dev/(tcp|udp)/host/port to open
+/* Define NETWORK_REDIRECTIONS if you want /System/Devices/(tcp|udp)/host/port to open
    socket connections when used in redirections */
 #undef NETWORK_REDIRECTIONS
 
@@ -450,13 +450,13 @@
 /* Define if the kernel can exec files beginning with #! */
 #undef HAVE_HASH_BANG_EXEC
 
-/* Define if you have the /dev/fd devices to map open files into the file system. */
+/* Define if you have the /System/Devices/fd devices to map open files into the file system. */
 #undef HAVE_DEV_FD
 
-/* Defined to /dev/fd or /proc/self/fd (linux). */
+/* Defined to /System/Devices/fd or /System/Processes/self/fd (linux). */
 #undef DEV_FD_PREFIX
 
-/* Define if you have the /dev/stdin device. */
+/* Define if you have the /System/Devices/stdin device. */
 #undef HAVE_DEV_STDIN
 
 
diff -urN bash-3.0/configure bash-3.0-STEP/configure
--- bash-3.0/configure	2004-07-22 08:18:56.000000000 +1200
+++ bash-3.0-STEP/configure	2005-08-25 00:47:17.460864904 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 # From configure.in for Bash 3.0, version 3.166, from autoconf version AC_ACVERSION.
 # Guess values for system-dependent variables and create Makefiles.
 # Generated by GNU Autoconf 2.57 for bash 3.0-release.
@@ -14,18 +14,18 @@
 ## --------------------- ##
 
 # Be Bourne compatible
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
+if test -n "${ZSH_VERSION+set}" && (emulate sh) >/System/Devices/null 2>&1; then
   emulate sh
   NULLCMD=:
   # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
   # is contrary to our usage.  Disable this feature.
   alias -g '${1+"$@"}'='"$@"'
-elif test -n "${BASH_VERSION+set}" && (set -o posix) >/dev/null 2>&1; then
+elif test -n "${BASH_VERSION+set}" && (set -o posix) >/System/Devices/null 2>&1; then
   set -o posix
 fi
 
 # Support unset when possible.
-if (FOO=FOO; unset FOO) >/dev/null 2>&1; then
+if (FOO=FOO; unset FOO) >/System/Devices/null 2>&1; then
   as_unset=unset
 else
   as_unset=false
@@ -52,13 +52,13 @@
 done
 
 # Required to use basename.
-if expr a : '\(a\)' >/dev/null 2>&1; then
+if expr a : '\(a\)' >/System/Devices/null 2>&1; then
   as_expr=expr
 else
   as_expr=false
 fi
 
-if (basename /) >/dev/null 2>&1 && test "X`basename / 2>&1`" = "X/"; then
+if (basename /) >/System/Devices/null 2>&1 && test "X`basename / 2>&1`" = "X/"; then
   as_basename=basename
 else
   as_basename=false
@@ -70,7 +70,7 @@
 $as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
 	 X"$0" : 'X\(//\)$' \| \
 	 X"$0" : 'X\(/\)$' \| \
-	 .     : '\(.\)' 2>/dev/null ||
+	 .     : '\(.\)' 2>/System/Devices/null ||
 echo X/"$0" |
     sed '/^.*\/\([^/][^/]*\)\/*$/{ s//\1/; q; }
   	  /^X\/\(\/\/\)$/{ s//\1/; q; }
@@ -88,10 +88,10 @@
 
 # The user is always right.
 if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
+  echo "#! /System/Tools/sh" >conf$$.sh
   echo  "exit 0"   >>conf$$.sh
   chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
+  if (PATH="/nonexistent;."; conf$$.sh) >/System/Devices/null 2>&1; then
     PATH_SEPARATOR=';'
   else
     PATH_SEPARATOR=:
@@ -102,7 +102,7 @@
 
   as_lineno_1=$LINENO
   as_lineno_2=$LINENO
-  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
+  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/System/Devices/null`
   test "x$as_lineno_1" != "x$as_lineno_2" &&
   test "x$as_lineno_3"  = "x$as_lineno_2"  || {
   # Find who we are.  Look in the path if we contain no path at all
@@ -131,7 +131,7 @@
   case $CONFIG_SHELL in
   '')
     as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
+for as_dir in /System/Tools/$PATH_SEPARATOR/System/Tools$PATH_SEPARATOR$PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
@@ -141,9 +141,9 @@
 	   if ("$as_dir/$as_base" -c '
   as_lineno_1=$LINENO
   as_lineno_2=$LINENO
-  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
+  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/System/Devices/null`
   test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x$as_lineno_3"  = "x$as_lineno_2" ') 2>/dev/null; then
+  test "x$as_lineno_3"  = "x$as_lineno_2" ') 2>/System/Devices/null; then
 	     $as_unset BASH_ENV || test "${BASH_ENV+set}" != set || { BASH_ENV=; export BASH_ENV; }
 	     $as_unset ENV || test "${ENV+set}" != set || { ENV=; export ENV; }
 	     CONFIG_SHELL=$as_dir/$as_base
@@ -194,7 +194,7 @@
   *)       ECHO_N= ECHO_C='\c' ECHO_T= ;;
 esac
 
-if expr a : '\(a\)' >/dev/null 2>&1; then
+if expr a : '\(a\)' >/System/Devices/null 2>&1; then
   as_expr=expr
 else
   as_expr=false
@@ -202,7 +202,7 @@
 
 rm -f conf$$ conf$$.exe conf$$.file
 echo >conf$$.file
-if ln -s conf$$.file conf$$ 2>/dev/null; then
+if ln -s conf$$.file conf$$ 2>/System/Devices/null; then
   # We could just check for DJGPP; but this test a) works b) is more generic
   # and c) will remain valid once DJGPP supports symlinks (DJGPP 2.04).
   if test -f conf$$.exe; then
@@ -211,14 +211,14 @@
   else
     as_ln_s='ln -s'
   fi
-elif ln conf$$.file conf$$ 2>/dev/null; then
+elif ln conf$$.file conf$$ 2>/System/Devices/null; then
   as_ln_s=ln
 else
   as_ln_s='cp -p'
 fi
 rm -f conf$$ conf$$.exe conf$$.file
 
-if mkdir -p . 2>/dev/null; then
+if mkdir -p . 2>/System/Devices/null; then
   as_mkdir_p=:
 else
   as_mkdir_p=false
@@ -246,7 +246,7 @@
 # Name of the host.
 # hostname on some systems (SVR3.2, Linux) returns a bogus exit status,
 # so uname gets run too.
-ac_hostname=`(hostname || uname -n) 2>/dev/null | sed 1q`
+ac_hostname=`(hostname || uname -n) 2>/System/Devices/null | sed 1q`
 
 exec 6>&1
 
@@ -259,7 +259,7 @@
 subdirs=
 MFLAGS=
 MAKEFLAGS=
-SHELL=${CONFIG_SHELL-/bin/sh}
+SHELL=${CONFIG_SHELL-/System/Tools/sh}
 
 # Maximum number of lines to put in a shell here document.
 # This variable seems obsolete.  It should probably be removed, and
@@ -319,7 +319,7 @@
 ac_init_version=false
 # The variables have the same names as the options, with
 # dashes changed to underlines.
-cache_file=/dev/null
+cache_file=/System/Devices/null
 exec_prefix=NONE
 no_create=
 no_recursion=
@@ -397,7 +397,7 @@
   -disable-* | --disable-*)
     ac_feature=`expr "x$ac_option" : 'x-*disable-\(.*\)'`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_feature" : ".*[^-_$as_cr_alnum]" >/dev/null &&
+    expr "x$ac_feature" : ".*[^-_$as_cr_alnum]" >/System/Devices/null &&
       { echo "$as_me: error: invalid feature name: $ac_feature" >&2
    { (exit 1); exit 1; }; }
     ac_feature=`echo $ac_feature | sed 's/-/_/g'`
@@ -406,7 +406,7 @@
   -enable-* | --enable-*)
     ac_feature=`expr "x$ac_option" : 'x-*enable-\([^=]*\)'`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_feature" : ".*[^-_$as_cr_alnum]" >/dev/null &&
+    expr "x$ac_feature" : ".*[^-_$as_cr_alnum]" >/System/Devices/null &&
       { echo "$as_me: error: invalid feature name: $ac_feature" >&2
    { (exit 1); exit 1; }; }
     ac_feature=`echo $ac_feature | sed 's/-/_/g'`
@@ -588,7 +588,7 @@
   -with-* | --with-*)
     ac_package=`expr "x$ac_option" : 'x-*with-\([^=]*\)'`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_package" : ".*[^-_$as_cr_alnum]" >/dev/null &&
+    expr "x$ac_package" : ".*[^-_$as_cr_alnum]" >/System/Devices/null &&
       { echo "$as_me: error: invalid package name: $ac_package" >&2
    { (exit 1); exit 1; }; }
     ac_package=`echo $ac_package| sed 's/-/_/g'`
@@ -601,7 +601,7 @@
   -without-* | --without-*)
     ac_package=`expr "x$ac_option" : 'x-*without-\(.*\)'`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_package" : ".*[^-_$as_cr_alnum]" >/dev/null &&
+    expr "x$ac_package" : ".*[^-_$as_cr_alnum]" >/System/Devices/null &&
       { echo "$as_me: error: invalid package name: $ac_package" >&2
    { (exit 1); exit 1; }; }
     ac_package=`echo $ac_package | sed 's/-/_/g'`
@@ -633,7 +633,7 @@
   *=*)
     ac_envvar=`expr "x$ac_option" : 'x\([^=]*\)='`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_envvar" : ".*[^_$as_cr_alnum]" >/dev/null &&
+    expr "x$ac_envvar" : ".*[^_$as_cr_alnum]" >/System/Devices/null &&
       { echo "$as_me: error: invalid variable name: $ac_envvar" >&2
    { (exit 1); exit 1; }; }
     ac_optarg=`echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"`
@@ -643,7 +643,7 @@
   *)
     # FIXME: should be removed in autoconf 3.0.
     echo "$as_me: WARNING: you should use --build, --host, --target" >&2
-    expr "x$ac_option" : ".*[^-._$as_cr_alnum]" >/dev/null &&
+    expr "x$ac_option" : ".*[^-._$as_cr_alnum]" >/System/Devices/null &&
       echo "$as_me: WARNING: invalid host type: $ac_option" >&2
     : ${build_alias=$ac_option} ${host_alias=$ac_option} ${target_alias=$ac_option}
     ;;
@@ -701,19 +701,19 @@
 ac_tool_prefix=
 test -n "$host_alias" && ac_tool_prefix=$host_alias-
 
-test "$silent" = yes && exec 6>/dev/null
+test "$silent" = yes && exec 6>/System/Devices/null
 
 
 # Find the source files, if location was not specified.
 if test -z "$srcdir"; then
   ac_srcdir_defaulted=yes
   # Try the directory containing this script, then its parent.
-  ac_confdir=`(dirname "$0") 2>/dev/null ||
+  ac_confdir=`(dirname "$0") 2>/System/Devices/null ||
 $as_expr X"$0" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
          X"$0" : 'X\(//\)[^/]' \| \
          X"$0" : 'X\(//\)$' \| \
          X"$0" : 'X\(/\)' \| \
-         .     : '\(.\)' 2>/dev/null ||
+         .     : '\(.\)' 2>/System/Devices/null ||
 echo X"$0" |
     sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
   	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
@@ -736,7 +736,7 @@
    { (exit 1); exit 1; }; }
   fi
 fi
-(cd $srcdir && test -r ./$ac_unique_file) 2>/dev/null ||
+(cd $srcdir && test -r ./$ac_unique_file) 2>/System/Devices/null ||
   { echo "$as_me: error: sources are in $srcdir, but \`cd $srcdir' does not work" >&2
    { (exit 1); exit 1; }; }
 srcdir=`echo "$srcdir" | sed 's%\([^\\/]\)[\\/]*$%\1%'`
@@ -878,7 +878,7 @@
   --enable-job-control    enable job control features
   --enable-multibyte      enable multibyte characters if OS supports them
   --enable-net-redirections
-                          enable /dev/tcp/host/port redirection
+                          enable /System/Devices/tcp/host/port redirection
   --enable-process-substitution
                           enable process substitution
   --enable-progcomp       enable programmable completion and the complete
@@ -1027,22 +1027,22 @@
 ## Platform. ##
 ## --------- ##
 
-hostname = `(hostname || uname -n) 2>/dev/null | sed 1q`
-uname -m = `(uname -m) 2>/dev/null || echo unknown`
-uname -r = `(uname -r) 2>/dev/null || echo unknown`
-uname -s = `(uname -s) 2>/dev/null || echo unknown`
-uname -v = `(uname -v) 2>/dev/null || echo unknown`
-
-/usr/bin/uname -p = `(/usr/bin/uname -p) 2>/dev/null || echo unknown`
-/bin/uname -X     = `(/bin/uname -X) 2>/dev/null     || echo unknown`
-
-/bin/arch              = `(/bin/arch) 2>/dev/null              || echo unknown`
-/usr/bin/arch -k       = `(/usr/bin/arch -k) 2>/dev/null       || echo unknown`
-/usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/dev/null || echo unknown`
-hostinfo               = `(hostinfo) 2>/dev/null               || echo unknown`
-/bin/machine           = `(/bin/machine) 2>/dev/null           || echo unknown`
-/usr/bin/oslevel       = `(/usr/bin/oslevel) 2>/dev/null       || echo unknown`
-/bin/universe          = `(/bin/universe) 2>/dev/null          || echo unknown`
+hostname = `(hostname || uname -n) 2>/System/Devices/null | sed 1q`
+uname -m = `(uname -m) 2>/System/Devices/null || echo unknown`
+uname -r = `(uname -r) 2>/System/Devices/null || echo unknown`
+uname -s = `(uname -s) 2>/System/Devices/null || echo unknown`
+uname -v = `(uname -v) 2>/System/Devices/null || echo unknown`
+
+/System/Tools/uname -p = `(/System/Tools/uname -p) 2>/System/Devices/null || echo unknown`
+/System/Tools/uname -X     = `(/System/Tools/uname -X) 2>/System/Devices/null     || echo unknown`
+
+/System/Tools/arch              = `(/System/Tools/arch) 2>/System/Devices/null              || echo unknown`
+/System/Tools/arch -k       = `(/System/Tools/arch -k) 2>/System/Devices/null       || echo unknown`
+/usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/System/Devices/null || echo unknown`
+hostinfo               = `(hostinfo) 2>/System/Devices/null               || echo unknown`
+/System/Tools/machine           = `(/System/Tools/machine) 2>/System/Devices/null           || echo unknown`
+/System/Tools/oslevel       = `(/System/Tools/oslevel) 2>/System/Devices/null       || echo unknown`
+/System/Tools/universe          = `(/System/Tools/universe) 2>/System/Devices/null          || echo unknown`
 
 _ASUNAME
 
@@ -1237,9 +1237,9 @@
 # Prefer explicitly selected file to automatically selected ones.
 if test -z "$CONFIG_SITE"; then
   if test "x$prefix" != xNONE; then
-    CONFIG_SITE="$prefix/share/config.site $prefix/etc/config.site"
+    CONFIG_SITE="$prefix/share/config.site $prefix/System/Settings/config.site"
   else
-    CONFIG_SITE="$ac_default_prefix/share/config.site $ac_default_prefix/etc/config.site"
+    CONFIG_SITE="$ac_default_prefix/share/config.site $ac_default_prefix/System/Settings/config.site"
   fi
 fi
 for ac_site_file in $CONFIG_SITE; do
@@ -1252,7 +1252,7 @@
 done
 
 if test -r "$cache_file"; then
-  # Some versions of bash will fail to source /dev/null (special
+  # Some versions of bash will fail to source /System/Devices/null (special
   # files actually), so we avoid doing that.
   if test -f "$cache_file"; then
     { echo "$as_me:$LINENO: loading cache $cache_file" >&5
@@ -1392,7 +1392,7 @@
 esac
 
 # Make sure we can run config.sub.
-$ac_config_sub sun4 >/dev/null 2>&1 ||
+$ac_config_sub sun4 >/System/Devices/null 2>&1 ||
   { { echo "$as_me:$LINENO: error: cannot run $ac_config_sub" >&5
 echo "$as_me: error: cannot run $ac_config_sub" >&2;}
    { (exit 1); exit 1; }; }
@@ -2351,18 +2351,18 @@
 echo "$as_me:$LINENO:" \
      "checking for C compiler version" >&5
 ac_compiler=`set X $ac_compile; echo $2`
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler --version </dev/null >&5\"") >&5
-  (eval $ac_compiler --version </dev/null >&5) 2>&5
+{ (eval echo "$as_me:$LINENO: \"$ac_compiler --version </System/Devices/null >&5\"") >&5
+  (eval $ac_compiler --version </System/Devices/null >&5) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler -v </dev/null >&5\"") >&5
-  (eval $ac_compiler -v </dev/null >&5) 2>&5
+{ (eval echo "$as_me:$LINENO: \"$ac_compiler -v </System/Devices/null >&5\"") >&5
+  (eval $ac_compiler -v </System/Devices/null >&5) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler -V </dev/null >&5\"") >&5
-  (eval $ac_compiler -V </dev/null >&5) 2>&5
+{ (eval echo "$as_me:$LINENO: \"$ac_compiler -V </System/Devices/null >&5\"") >&5
+  (eval $ac_compiler -V </System/Devices/null >&5) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }
@@ -2546,7 +2546,7 @@
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; then
-  for ac_file in `(ls conftest.o conftest.obj; ls conftest.*) 2>/dev/null`; do
+  for ac_file in `(ls conftest.o conftest.obj; ls conftest.*) 2>/System/Devices/null`; do
   case $ac_file in
     *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg ) ;;
     *) ac_cv_objext=`expr "$ac_file" : '.*\.\(.*\)'`
@@ -3011,7 +3011,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -3049,7 +3049,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -3118,7 +3118,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -3156,7 +3156,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -3203,7 +3203,7 @@
 if test "${ac_cv_prog_egrep+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  if echo a | (grep -E '(a|b)') >/dev/null 2>&1
+  if echo a | (grep -E '(a|b)') >/System/Devices/null 2>&1
     then ac_cv_prog_egrep='grep -E'
     else ac_cv_prog_egrep='egrep'
     fi
@@ -3272,7 +3272,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "memchr" >/dev/null 2>&1; then
+  $EGREP "memchr" >/System/Devices/null 2>&1; then
   :
 else
   ac_cv_header_stdc=no
@@ -3294,7 +3294,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "free" >/dev/null 2>&1; then
+  $EGREP "free" >/System/Devices/null 2>&1; then
   :
 else
   ac_cv_header_stdc=no
@@ -3304,7 +3304,7 @@
 fi
 
 if test $ac_cv_header_stdc = yes; then
-  # /bin/cc in Irix-4.0.5 gets non-ANSI ctype macros unless using -ansi.
+  # /System/Tools/cc in Irix-4.0.5 gets non-ANSI ctype macros unless using -ansi.
   if test "$cross_compiling" = yes; then
   :
 else
@@ -3500,7 +3500,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -4011,7 +4011,7 @@
 Autoconf TIOCGETP
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "$ac_pattern" >/dev/null 2>&1; then
+  $EGREP "$ac_pattern" >/System/Devices/null 2>&1; then
   ac_cv_prog_gcc_traditional=yes
 else
   ac_cv_prog_gcc_traditional=no
@@ -4031,7 +4031,7 @@
 Autoconf TCGETA
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "$ac_pattern" >/dev/null 2>&1; then
+  $EGREP "$ac_pattern" >/System/Devices/null 2>&1; then
   ac_cv_prog_gcc_traditional=yes
 fi
 rm -f conftest*
@@ -4645,13 +4645,13 @@
 # Find a good install program.  We prefer a C program (faster),
 # so one script is as good as another.  But avoid the broken or
 # incompatible versions:
-# SysV /etc/install, /usr/sbin/install
-# SunOS /usr/etc/install
-# IRIX /sbin/install
-# AIX /bin/install
+# SysV /System/Settings/install, /System/AdminTools/install
+# SunOS /usr/System/Settings/install
+# IRIX /System/AdminTools/install
+# AIX /System/Tools/install
 # AmigaOS /C/install, which installs bootblocks on floppy discs
-# AIX 4 /usr/bin/installbsd, which doesn't work without a -g flag
-# AFS /usr/afsws/bin/install, which mishandles nonexistent args
+# AIX 4 /System/Tools/installbsd, which doesn't work without a -g flag
+# AFS /usr/afsws/System/Tools/install, which mishandles nonexistent args
 # SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
 # ./install, which can be erroneously created by make from ./install.sh.
 echo "$as_me:$LINENO: checking for a BSD-compatible install" >&5
@@ -4668,7 +4668,7 @@
   # Account for people who put trailing slashes in PATH elements.
 case $as_dir/ in
   ./ | .// | /cC/* | \
-  /etc/* | /usr/sbin/* | /usr/etc/* | /sbin/* | /usr/afsws/bin/* | \
+  /System/Settings/* | /System/AdminTools/* | /usr/System/Settings/* | /System/AdminTools/* | /usr/afsws/System/Tools/* | \
   /usr/ucb/* ) ;;
   *)
     # OSF1 and SCO ODT 3.0 have their own names for install.
@@ -4678,11 +4678,11 @@
       for ac_exec_ext in '' $ac_executable_extensions; do
         if $as_executable_p "$as_dir/$ac_prog$ac_exec_ext"; then
           if test $ac_prog = install &&
-            grep dspmsg "$as_dir/$ac_prog$ac_exec_ext" >/dev/null 2>&1; then
+            grep dspmsg "$as_dir/$ac_prog$ac_exec_ext" >/System/Devices/null 2>&1; then
             # AIX install.  It has an incompatible calling convention.
             :
           elif test $ac_prog = install &&
-            grep pwplus "$as_dir/$ac_prog$ac_exec_ext" >/dev/null 2>&1; then
+            grep pwplus "$as_dir/$ac_prog$ac_exec_ext" >/System/Devices/null 2>&1; then
             # program-specific install script used by HP pwplus--don't use.
             :
           else
@@ -4888,7 +4888,7 @@
 	@echo 'ac_maketemp="$(MAKE)"'
 _ACEOF
 # GNU make sometimes prints "make[1]: Entering...", which would confuse us.
-eval `${MAKE-make} -f conftest.make 2>/dev/null | grep temp=`
+eval `${MAKE-make} -f conftest.make 2>/System/Devices/null | grep temp=`
 if test -n "$ac_maketemp"; then
   eval ac_cv_prog_make_${ac_make}_set=yes
 else
@@ -4908,8 +4908,8 @@
 
 
 case "$host_os" in
-opennt*|interix*)	MAKE_SHELL="$INTERIX_ROOT/bin/sh" ;;
-*)			MAKE_SHELL=/bin/sh ;;
+opennt*|interix*)	MAKE_SHELL="$INTERIX_ROOT/System/Tools/sh" ;;
+*)			MAKE_SHELL=/System/Tools/sh ;;
 esac
 
 
@@ -5196,10 +5196,10 @@
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
-  if grep BIGenDianSyS conftest.$ac_objext >/dev/null ; then
+  if grep BIGenDianSyS conftest.$ac_objext >/System/Devices/null ; then
   ac_cv_c_bigendian=yes
 fi
-if grep LiTTleEnDian conftest.$ac_objext >/dev/null ; then
+if grep LiTTleEnDian conftest.$ac_objext >/System/Devices/null ; then
   if test "$ac_cv_c_bigendian" = unknown; then
     ac_cv_c_bigendian=no
   else
@@ -5295,7 +5295,7 @@
 char *s = x(teststring);
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "#teststring" >/dev/null 2>&1; then
+  $EGREP "#teststring" >/System/Devices/null 2>&1; then
   ac_cv_c_stringize=no
 else
   ac_cv_c_stringize=yes
@@ -5479,10 +5479,10 @@
 # Prepare PATH_SEPARATOR.
 # The user is always right.
 if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
+  echo "#! /System/Tools/sh" >conf$$.sh
   echo  "exit 0"   >>conf$$.sh
   chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
+  if (PATH="/nonexistent;."; conf$$.sh) >/System/Devices/null 2>&1; then
     PATH_SEPARATOR=';'
   else
     PATH_SEPARATOR=:
@@ -5493,11 +5493,11 @@
 # Find out how to test for executable files. Don't use a zero-byte file,
 # as systems may use methods other than mode bits to determine executability.
 cat >conf$$.file <<_ASEOF
-#! /bin/sh
+#! /System/Tools/sh
 exit 0
 _ASEOF
 chmod +x conf$$.file
-if test -x conf$$.file >/dev/null 2>&1; then
+if test -x conf$$.file >/System/Devices/null 2>&1; then
   ac_executable_p="test -x"
 else
   ac_executable_p="test -f"
@@ -5522,8 +5522,8 @@
       test -z "$ac_dir" && ac_dir=.
       for ac_exec_ext in '' $ac_executable_extensions; do
         if $ac_executable_p "$ac_dir/$ac_word$ac_exec_ext"; then
-          if $ac_dir/$ac_word --statistics /dev/null >/dev/null 2>&1 &&
-     (if $ac_dir/$ac_word --statistics /dev/null 2>&1 >/dev/null | grep usage >/dev/null; then exit 1; else exit 0; fi); then
+          if $ac_dir/$ac_word --statistics /System/Devices/null >/System/Devices/null 2>&1 &&
+     (if $ac_dir/$ac_word --statistics /System/Devices/null 2>&1 >/System/Devices/null | grep usage >/System/Devices/null; then exit 1; else exit 0; fi); then
             ac_cv_path_MSGFMT="$ac_dir/$ac_word$ac_exec_ext"
             break 2
           fi
@@ -5589,10 +5589,10 @@
 # Prepare PATH_SEPARATOR.
 # The user is always right.
 if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
+  echo "#! /System/Tools/sh" >conf$$.sh
   echo  "exit 0"   >>conf$$.sh
   chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
+  if (PATH="/nonexistent;."; conf$$.sh) >/System/Devices/null 2>&1; then
     PATH_SEPARATOR=';'
   else
     PATH_SEPARATOR=:
@@ -5603,11 +5603,11 @@
 # Find out how to test for executable files. Don't use a zero-byte file,
 # as systems may use methods other than mode bits to determine executability.
 cat >conf$$.file <<_ASEOF
-#! /bin/sh
+#! /System/Tools/sh
 exit 0
 _ASEOF
 chmod +x conf$$.file
-if test -x conf$$.file >/dev/null 2>&1; then
+if test -x conf$$.file >/System/Devices/null 2>&1; then
   ac_executable_p="test -x"
 else
   ac_executable_p="test -f"
@@ -5632,8 +5632,8 @@
       test -z "$ac_dir" && ac_dir=.
       for ac_exec_ext in '' $ac_executable_extensions; do
         if $ac_executable_p "$ac_dir/$ac_word$ac_exec_ext"; then
-          if $ac_dir/$ac_word --omit-header --copyright-holder= --msgid-bugs-address= /dev/null >/dev/null 2>&1 &&
-     (if $ac_dir/$ac_word --omit-header --copyright-holder= --msgid-bugs-address= /dev/null 2>&1 >/dev/null | grep usage >/dev/null; then exit 1; else exit 0; fi); then
+          if $ac_dir/$ac_word --omit-header --copyright-holder= --msgid-bugs-address= /System/Devices/null >/System/Devices/null 2>&1 &&
+     (if $ac_dir/$ac_word --omit-header --copyright-holder= --msgid-bugs-address= /System/Devices/null 2>&1 >/System/Devices/null | grep usage >/System/Devices/null; then exit 1; else exit 0; fi); then
             ac_cv_path_XGETTEXT="$ac_dir/$ac_word$ac_exec_ext"
             break 2
           fi
@@ -5660,10 +5660,10 @@
 # Prepare PATH_SEPARATOR.
 # The user is always right.
 if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
+  echo "#! /System/Tools/sh" >conf$$.sh
   echo  "exit 0"   >>conf$$.sh
   chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
+  if (PATH="/nonexistent;."; conf$$.sh) >/System/Devices/null 2>&1; then
     PATH_SEPARATOR=';'
   else
     PATH_SEPARATOR=:
@@ -5674,11 +5674,11 @@
 # Find out how to test for executable files. Don't use a zero-byte file,
 # as systems may use methods other than mode bits to determine executability.
 cat >conf$$.file <<_ASEOF
-#! /bin/sh
+#! /System/Tools/sh
 exit 0
 _ASEOF
 chmod +x conf$$.file
-if test -x conf$$.file >/dev/null 2>&1; then
+if test -x conf$$.file >/System/Devices/null 2>&1; then
   ac_executable_p="test -x"
 else
   ac_executable_p="test -f"
@@ -5703,7 +5703,7 @@
       test -z "$ac_dir" && ac_dir=.
       for ac_exec_ext in '' $ac_executable_extensions; do
         if $ac_executable_p "$ac_dir/$ac_word$ac_exec_ext"; then
-          if $ac_dir/$ac_word --update -q /dev/null /dev/null >/dev/null 2>&1; then
+          if $ac_dir/$ac_word --update -q /System/Devices/null /System/Devices/null >/System/Devices/null 2>&1; then
             ac_cv_path_MSGMERGE="$ac_dir/$ac_word$ac_exec_ext"
             break 2
           fi
@@ -5726,8 +5726,8 @@
 
 
       if test "$GMSGFMT" != ":"; then
-            if $GMSGFMT --statistics /dev/null >/dev/null 2>&1 &&
-       (if $GMSGFMT --statistics /dev/null 2>&1 >/dev/null | grep usage >/dev/null; then exit 1; else exit 0; fi); then
+            if $GMSGFMT --statistics /System/Devices/null >/System/Devices/null 2>&1 &&
+       (if $GMSGFMT --statistics /System/Devices/null 2>&1 >/System/Devices/null | grep usage >/System/Devices/null; then exit 1; else exit 0; fi); then
       : ;
     else
       GMSGFMT=`echo "$GMSGFMT" | sed -e 's,^.*/,,'`
@@ -5738,8 +5738,8 @@
   fi
 
       if test "$XGETTEXT" != ":"; then
-            if $XGETTEXT --omit-header --copyright-holder= --msgid-bugs-address= /dev/null >/dev/null 2>&1 &&
-       (if $XGETTEXT --omit-header --copyright-holder= --msgid-bugs-address= /dev/null 2>&1 >/dev/null | grep usage >/dev/null; then exit 1; else exit 0; fi); then
+            if $XGETTEXT --omit-header --copyright-holder= --msgid-bugs-address= /System/Devices/null >/System/Devices/null 2>&1 &&
+       (if $XGETTEXT --omit-header --copyright-holder= --msgid-bugs-address= /System/Devices/null 2>&1 >/System/Devices/null | grep usage >/System/Devices/null; then exit 1; else exit 0; fi); then
       : ;
     else
       echo "$as_me:$LINENO: result: found xgettext program is not GNU xgettext; ignore it" >&5
@@ -6024,7 +6024,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "webecray" >/dev/null 2>&1; then
+  $EGREP "webecray" >/System/Devices/null 2>&1; then
   ac_cv_os_cray=yes
 else
   ac_cv_os_cray=no
@@ -6258,7 +6258,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -6615,7 +6615,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "Lucky GNU user" >/dev/null 2>&1; then
+  $EGREP "Lucky GNU user" >/System/Devices/null 2>&1; then
   ac_cv_gnu_library_2_1=yes
 else
   ac_cv_gnu_library_2_1=no
@@ -7059,10 +7059,10 @@
 # Prepare PATH_SEPARATOR.
 # The user is always right.
 if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
+  echo "#! /System/Tools/sh" >conf$$.sh
   echo  "exit 0"   >>conf$$.sh
   chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
+  if (PATH="/nonexistent;."; conf$$.sh) >/System/Devices/null 2>&1; then
     PATH_SEPARATOR=';'
   else
     PATH_SEPARATOR=:
@@ -7087,7 +7087,7 @@
       re_direlt='/[^/][^/]*/\.\./'
       # Canonicalize the path of ld
       ac_prog=`echo $ac_prog| sed 's%\\\\%/%g'`
-      while echo $ac_prog | grep "$re_direlt" > /dev/null 2>&1; do
+      while echo $ac_prog | grep "$re_direlt" > /System/Devices/null 2>&1; do
 	ac_prog=`echo $ac_prog| sed "s%$re_direlt%/%"`
       done
       test -z "$LD" && LD="$ac_prog"
@@ -7120,7 +7120,7 @@
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some GNU ld's only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then
+      if "$acl_cv_path_LD" -v 2>&1 < /System/Devices/null | egrep '(GNU|with BFD)' > /System/Devices/null; then
 	test "$with_gnu_ld" != no && break
       else
 	test "$with_gnu_ld" != yes && break
@@ -7150,7 +7150,7 @@
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   # I'd rather use --version here, but apparently some GNU ld's only accept -v.
-if $LD -v 2>&1 </dev/null | egrep '(GNU|with BFD)' 1>&5; then
+if $LD -v 2>&1 </System/Devices/null | egrep '(GNU|with BFD)' 1>&5; then
   acl_cv_prog_gnu_ld=yes
 else
   acl_cv_prog_gnu_ld=no
@@ -7169,7 +7169,7 @@
 else
 
     CC="$CC" GCC="$GCC" LDFLAGS="$LDFLAGS" LD="$LD" with_gnu_ld="$with_gnu_ld" \
-    ${CONFIG_SHELL-/bin/sh} "$ac_aux_dir/config.rpath" "$host" > conftest.sh
+    ${CONFIG_SHELL-/System/Tools/sh} "$ac_aux_dir/config.rpath" "$host" > conftest.sh
     . ./conftest.sh
     rm -f ./conftest.sh
     acl_cv_rpath=done
@@ -7655,7 +7655,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -9373,7 +9373,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -9536,7 +9536,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -9692,7 +9692,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -9835,7 +9835,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -10068,7 +10068,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "webecray" >/dev/null 2>&1; then
+  $EGREP "webecray" >/System/Devices/null 2>&1; then
   ac_cv_os_cray=yes
 else
   ac_cv_os_cray=no
@@ -10680,7 +10680,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "[int[ 	]*vprintf[^a-zA-Z0-9]]" >/dev/null 2>&1; then
+  $EGREP "[int[ 	]*vprintf[^a-zA-Z0-9]]" >/System/Devices/null 2>&1; then
   ac_cv_func_vprintf=yes
 fi
 rm -f conftest*
@@ -12576,7 +12576,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -12998,7 +12998,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -13142,7 +13142,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -13650,7 +13650,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -13792,7 +13792,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -13934,7 +13934,7 @@
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
+  (exit $ac_status); } >/System/Devices/null; then
   if test -s conftest.err; then
     ac_cpp_err=$ac_c_preproc_warn_flag
   else
@@ -15196,7 +15196,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "uid_t" >/dev/null 2>&1; then
+  $EGREP "uid_t" >/System/Devices/null 2>&1; then
   ac_cv_type_uid_t=yes
 else
   ac_cv_type_uid_t=no
@@ -15291,7 +15291,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "getgroups.*int.*gid_t" >/dev/null 2>&1; then
+  $EGREP "getgroups.*int.*gid_t" >/System/Devices/null 2>&1; then
   ac_cv_type_getgroups=gid_t
 else
   ac_cv_type_getgroups=int
@@ -15438,7 +15438,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "uid_t" >/dev/null 2>&1; then
+  $EGREP "uid_t" >/System/Devices/null 2>&1; then
   ac_cv_type_uid_t=yes
 else
   ac_cv_type_uid_t=no
@@ -19786,7 +19786,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "You lose" >/dev/null 2>&1; then
+  $EGREP "You lose" >/System/Devices/null 2>&1; then
   ac_cv_header_stat_broken=yes
 else
   ac_cv_header_stat_broken=no
@@ -19810,11 +19810,11 @@
 if test "${ac_cv_sys_interpreter+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  echo '#! /bin/cat
+  echo '#! /System/Tools/cat
 exit 69
 ' >conftest
 chmod u+x conftest
-(SHELL=/bin/sh; export SHELL; ./conftest >/dev/null)
+(SHELL=/System/Tools/sh; export SHELL; ./conftest >/System/Devices/null)
 if test $? -ne 69; then
    ac_cv_sys_interpreter=yes
 else
@@ -19997,7 +19997,7 @@
 main()
 {
   int fd1, fd2, fl;
-  fd1 = open("/dev/null", 2);
+  fd1 = open("/System/Devices/null", 2);
   if (fcntl(fd1, 2, 1) < 0)
     exit(1);
   fd2 = dup2(fd1, 1);
@@ -20628,7 +20628,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "clock_t" >/dev/null 2>&1; then
+  $EGREP "clock_t" >/System/Devices/null 2>&1; then
   bash_cv_type_clock_t=yes
 else
   bash_cv_type_clock_t=no
@@ -20673,7 +20673,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "sigset_t" >/dev/null 2>&1; then
+  $EGREP "sigset_t" >/System/Devices/null 2>&1; then
   bash_cv_type_sigset_t=yes
 else
   bash_cv_type_sigset_t=no
@@ -20718,7 +20718,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "quad_t" >/dev/null 2>&1; then
+  $EGREP "quad_t" >/System/Devices/null 2>&1; then
   bash_cv_type_quad_t=yes
 else
   bash_cv_type_quad_t=no
@@ -20768,7 +20768,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "intmax_t" >/dev/null 2>&1; then
+  $EGREP "intmax_t" >/System/Devices/null 2>&1; then
   bash_cv_type_intmax_t=yes
 else
   bash_cv_type_intmax_t=no
@@ -20813,7 +20813,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "uintmax_t" >/dev/null 2>&1; then
+  $EGREP "uintmax_t" >/System/Devices/null 2>&1; then
   bash_cv_type_uintmax_t=yes
 else
   bash_cv_type_uintmax_t=no
@@ -20859,7 +20859,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "socklen_t" >/dev/null 2>&1; then
+  $EGREP "socklen_t" >/System/Devices/null 2>&1; then
   bash_cv_type_socklen_t=yes
 else
   bash_cv_type_socklen_t=no
@@ -21534,7 +21534,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "struct timeval" >/dev/null 2>&1; then
+  $EGREP "struct timeval" >/System/Devices/null 2>&1; then
   bash_cv_struct_timeval=yes
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -21548,7 +21548,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "struct timeval" >/dev/null 2>&1; then
+  $EGREP "struct timeval" >/System/Devices/null 2>&1; then
   bash_cv_struct_timeval=yes
 else
   bash_cv_struct_timeval=no
@@ -21895,7 +21895,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "struct timezone" >/dev/null 2>&1; then
+  $EGREP "struct timezone" >/System/Devices/null 2>&1; then
   bash_cv_struct_timezone=yes
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -21909,7 +21909,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "struct timezone" >/dev/null 2>&1; then
+  $EGREP "struct timezone" >/System/Devices/null 2>&1; then
   bash_cv_struct_timezone=yes
 else
   bash_cv_struct_timezone=no
@@ -22028,18 +22028,18 @@
 {
 DIR *dir;
 int fd, err;
-err = mkdir("/tmp/bash-aclocal", 0700);
+err = mkdir("/System/TemporaryFiles/bash-aclocal", 0700);
 if (err < 0) {
   perror("mkdir");
   exit(1);
 }
-unlink("/tmp/bash-aclocal/not_a_directory");
-fd = open("/tmp/bash-aclocal/not_a_directory", O_WRONLY|O_CREAT|O_EXCL, 0666);
+unlink("/System/TemporaryFiles/bash-aclocal/not_a_directory");
+fd = open("/System/TemporaryFiles/bash-aclocal/not_a_directory", O_WRONLY|O_CREAT|O_EXCL, 0666);
 write(fd, "\n", 1);
 close(fd);
-dir = opendir("/tmp/bash-aclocal/not_a_directory");
-unlink("/tmp/bash-aclocal/not_a_directory");
-rmdir("/tmp/bash-aclocal");
+dir = opendir("/System/TemporaryFiles/bash-aclocal/not_a_directory");
+unlink("/System/TemporaryFiles/bash-aclocal/not_a_directory");
+rmdir("/System/TemporaryFiles/bash-aclocal");
 exit (dir == 0);
 }
 _ACEOF
@@ -22927,19 +22927,19 @@
 #if defined (NeXT)
 exit (1);
 #endif
-err = mkdir("/tmp/bash-aclocal", 0700);
+err = mkdir("/System/TemporaryFiles/bash-aclocal", 0700);
 if (err < 0) {
   perror ("mkdir");
   exit(1);
 }
-fd = mknod ("/tmp/bash-aclocal/sh-np-autoconf", 0666 | S_IFIFO, 0);
+fd = mknod ("/System/TemporaryFiles/bash-aclocal/sh-np-autoconf", 0666 | S_IFIFO, 0);
 if (fd == -1) {
-  rmdir ("/tmp/bash-aclocal");
+  rmdir ("/System/TemporaryFiles/bash-aclocal");
   exit (1);
 }
 close(fd);
-unlink ("/tmp/bash-aclocal/sh-np-autoconf");
-rmdir ("/tmp/bash-aclocal");
+unlink ("/System/TemporaryFiles/bash-aclocal/sh-np-autoconf");
+rmdir ("/System/TemporaryFiles/bash-aclocal");
 exit(0);
 }
 _ACEOF
@@ -22997,7 +22997,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "yes" >/dev/null 2>&1; then
+  $EGREP "yes" >/System/Devices/null 2>&1; then
   ac_cv_sys_tiocgwinsz_in_termios_h=yes
 else
   ac_cv_sys_tiocgwinsz_in_termios_h=no
@@ -23029,7 +23029,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "yes" >/dev/null 2>&1; then
+  $EGREP "yes" >/System/Devices/null 2>&1; then
   ac_cv_sys_tiocgwinsz_in_sys_ioctl_h=yes
 else
   ac_cv_sys_tiocgwinsz_in_sys_ioctl_h=no
@@ -23229,7 +23229,7 @@
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "getpwuid" >/dev/null 2>&1; then
+  $EGREP "getpwuid" >/System/Devices/null 2>&1; then
   bash_cv_getpw_declared=yes
 else
   bash_cv_getpw_declared=no
@@ -23797,14 +23797,14 @@
 
 
 
-echo "$as_me:$LINENO: checking whether /dev/fd is available" >&5
-echo $ECHO_N "checking whether /dev/fd is available... $ECHO_C" >&6
+echo "$as_me:$LINENO: checking whether /System/Devices/fd is available" >&5
+echo $ECHO_N "checking whether /System/Devices/fd is available... $ECHO_C" >&6
 if test "${bash_cv_dev_fd+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  if test -d /dev/fd  && test -r /dev/fd/0 < /dev/null; then
+  if test -d /System/Devices/fd  && test -r /System/Devices/fd/0 < /System/Devices/null; then
    bash_cv_dev_fd=standard
- elif test -d /proc/self/fd && test -r /proc/self/fd/0 < /dev/null; then
+ elif test -d /System/Processes/self/fd && test -r /System/Processes/self/fd/0 < /System/Devices/null; then
    bash_cv_dev_fd=whacky
  else
    bash_cv_dev_fd=absent
@@ -23820,7 +23820,7 @@
 _ACEOF
 
   cat >>confdefs.h <<\_ACEOF
-#define DEV_FD_PREFIX "/dev/fd/"
+#define DEV_FD_PREFIX "/System/Devices/fd/"
 _ACEOF
 
 elif test $bash_cv_dev_fd = "whacky"; then
@@ -23829,19 +23829,19 @@
 _ACEOF
 
   cat >>confdefs.h <<\_ACEOF
-#define DEV_FD_PREFIX "/proc/self/fd/"
+#define DEV_FD_PREFIX "/System/Processes/self/fd/"
 _ACEOF
 
 fi
 
-echo "$as_me:$LINENO: checking whether /dev/stdin stdout stderr are available" >&5
-echo $ECHO_N "checking whether /dev/stdin stdout stderr are available... $ECHO_C" >&6
+echo "$as_me:$LINENO: checking whether /System/Devices/stdin stdout stderr are available" >&5
+echo $ECHO_N "checking whether /System/Devices/stdin stdout stderr are available... $ECHO_C" >&6
 if test "${bash_cv_dev_stdin+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  if test -d /dev/fd && test -r /dev/stdin < /dev/null; then
+  if test -d /System/Devices/fd && test -r /System/Devices/stdin < /System/Devices/null; then
    bash_cv_dev_stdin=present
- elif test -d /proc/self/fd && test -r /dev/stdin < /dev/null; then
+ elif test -d /System/Processes/self/fd && test -r /System/Devices/stdin < /System/Devices/null; then
    bash_cv_dev_stdin=present
  else
    bash_cv_dev_stdin=absent
@@ -23949,7 +23949,7 @@
 
 case "${host_os}" in
 freebsd[3-9]*)
-		if test -x /usr/bin/objformat && test "`/usr/bin/objformat`" = "elf" ; then
+		if test -x /System/Tools/objformat && test "`/System/Tools/objformat`" = "elf" ; then
 			LOCAL_LDFLAGS=-rdynamic # allow dynamic loading
 		fi ;;
 freebsdelf*)	LOCAL_LDFLAGS=-rdynamic ;;	# allow dynamic loading
@@ -23976,7 +23976,7 @@
 then
 	echo "$as_me:$LINENO: checking shared object configuration for loadable builtins" >&5
 echo $ECHO_N "checking shared object configuration for loadable builtins... $ECHO_C" >&6
-	eval `${CONFIG_SHELL-/bin/sh} ${srcdir}/support/shobj-conf -C "${CC}" -c "${host_cpu}" -o "${host_os}" -v "${host_vendor}"`
+	eval `${CONFIG_SHELL-/System/Tools/sh} ${srcdir}/support/shobj-conf -C "${CC}" -c "${host_cpu}" -o "${host_os}" -v "${host_vendor}"`
 
 
 
@@ -24078,9 +24078,9 @@
      t end
      /^ac_cv_env/!s/^\([^=]*\)=\(.*\)$/\1=${\1=\2}/
      : end' >>confcache
-if diff $cache_file confcache >/dev/null 2>&1; then :; else
+if diff $cache_file confcache >/System/Devices/null 2>&1; then :; else
   if test -w $cache_file; then
-    test "x$cache_file" != "x/dev/null" && echo "updating cache $cache_file"
+    test "x$cache_file" != "x/System/Devices/null" && echo "updating cache $cache_file"
     cat confcache >$cache_file
   else
     echo "not updating unwritable cache $cache_file"
@@ -24149,18 +24149,18 @@
 ## --------------------- ##
 
 # Be Bourne compatible
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
+if test -n "${ZSH_VERSION+set}" && (emulate sh) >/System/Devices/null 2>&1; then
   emulate sh
   NULLCMD=:
   # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
   # is contrary to our usage.  Disable this feature.
   alias -g '${1+"$@"}'='"$@"'
-elif test -n "${BASH_VERSION+set}" && (set -o posix) >/dev/null 2>&1; then
+elif test -n "${BASH_VERSION+set}" && (set -o posix) >/System/Devices/null 2>&1; then
   set -o posix
 fi
 
 # Support unset when possible.
-if (FOO=FOO; unset FOO) >/dev/null 2>&1; then
+if (FOO=FOO; unset FOO) >/System/Devices/null 2>&1; then
   as_unset=unset
 else
   as_unset=false
@@ -24187,13 +24187,13 @@
 done
 
 # Required to use basename.
-if expr a : '\(a\)' >/dev/null 2>&1; then
+if expr a : '\(a\)' >/System/Devices/null 2>&1; then
   as_expr=expr
 else
   as_expr=false
 fi
 
-if (basename /) >/dev/null 2>&1 && test "X`basename / 2>&1`" = "X/"; then
+if (basename /) >/System/Devices/null 2>&1 && test "X`basename / 2>&1`" = "X/"; then
   as_basename=basename
 else
   as_basename=false
@@ -24205,7 +24205,7 @@
 $as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
 	 X"$0" : 'X\(//\)$' \| \
 	 X"$0" : 'X\(/\)$' \| \
-	 .     : '\(.\)' 2>/dev/null ||
+	 .     : '\(.\)' 2>/System/Devices/null ||
 echo X/"$0" |
     sed '/^.*\/\([^/][^/]*\)\/*$/{ s//\1/; q; }
   	  /^X\/\(\/\/\)$/{ s//\1/; q; }
@@ -24223,10 +24223,10 @@
 
 # The user is always right.
 if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
+  echo "#! /System/Tools/sh" >conf$$.sh
   echo  "exit 0"   >>conf$$.sh
   chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
+  if (PATH="/nonexistent;."; conf$$.sh) >/System/Devices/null 2>&1; then
     PATH_SEPARATOR=';'
   else
     PATH_SEPARATOR=:
@@ -24237,7 +24237,7 @@
 
   as_lineno_1=$LINENO
   as_lineno_2=$LINENO
-  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
+  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/System/Devices/null`
   test "x$as_lineno_1" != "x$as_lineno_2" &&
   test "x$as_lineno_3"  = "x$as_lineno_2"  || {
   # Find who we are.  Look in the path if we contain no path at all
@@ -24267,7 +24267,7 @@
   case $CONFIG_SHELL in
   '')
     as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
+for as_dir in /System/Tools/$PATH_SEPARATOR/System/Tools$PATH_SEPARATOR$PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
@@ -24277,9 +24277,9 @@
 	   if ("$as_dir/$as_base" -c '
   as_lineno_1=$LINENO
   as_lineno_2=$LINENO
-  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
+  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/System/Devices/null`
   test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x$as_lineno_3"  = "x$as_lineno_2" ') 2>/dev/null; then
+  test "x$as_lineno_3"  = "x$as_lineno_2" ') 2>/System/Devices/null; then
 	     $as_unset BASH_ENV || test "${BASH_ENV+set}" != set || { BASH_ENV=; export BASH_ENV; }
 	     $as_unset ENV || test "${ENV+set}" != set || { ENV=; export ENV; }
 	     CONFIG_SHELL=$as_dir/$as_base
@@ -24331,7 +24331,7 @@
   *)       ECHO_N= ECHO_C='\c' ECHO_T= ;;
 esac
 
-if expr a : '\(a\)' >/dev/null 2>&1; then
+if expr a : '\(a\)' >/System/Devices/null 2>&1; then
   as_expr=expr
 else
   as_expr=false
@@ -24339,7 +24339,7 @@
 
 rm -f conf$$ conf$$.exe conf$$.file
 echo >conf$$.file
-if ln -s conf$$.file conf$$ 2>/dev/null; then
+if ln -s conf$$.file conf$$ 2>/System/Devices/null; then
   # We could just check for DJGPP; but this test a) works b) is more generic
   # and c) will remain valid once DJGPP supports symlinks (DJGPP 2.04).
   if test -f conf$$.exe; then
@@ -24348,14 +24348,14 @@
   else
     as_ln_s='ln -s'
   fi
-elif ln conf$$.file conf$$ 2>/dev/null; then
+elif ln conf$$.file conf$$ 2>/System/Devices/null; then
   as_ln_s=ln
 else
   as_ln_s='cp -p'
 fi
 rm -f conf$$ conf$$.exe conf$$.file
 
-if mkdir -p . 2>/dev/null; then
+if mkdir -p . 2>/System/Devices/null; then
   as_mkdir_p=:
 else
   as_mkdir_p=false
@@ -24403,7 +24403,7 @@
   $ $0 $@
 
 _CSEOF
-echo "on `(hostname || uname -n) 2>/dev/null | sed 1q`" >&5
+echo "on `(hostname || uname -n) 2>/System/Devices/null | sed 1q`" >&5
 echo >&5
 _ACEOF
 
@@ -24538,7 +24538,7 @@
 ac_configure_extra_args=
 
 if $ac_cs_silent; then
-  exec 6>/dev/null
+  exec 6>/System/Devices/null
   ac_configure_extra_args="$ac_configure_extra_args --silent"
 fi
 
@@ -24609,7 +24609,7 @@
 
 # Have a temporary directory for convenience.  Make it in the build tree
 # simply because there is no reason to put it here, and in addition,
-# creating and moving files from /tmp can sometimes cause problems.
+# creating and moving files from /System/TemporaryFiles can sometimes cause problems.
 # Create a temporary directory, and hook for its removal unless debugging.
 $debug ||
 {
@@ -24620,7 +24620,7 @@
 # Create a (secure) tmp directory for tmp files.
 
 {
-  tmp=`(umask 077 && mktemp -d -q "./confstatXXXXXX") 2>/dev/null` &&
+  tmp=`(umask 077 && mktemp -d -q "./confstatXXXXXX") 2>/System/Devices/null` &&
   test -n "$tmp" && test -d "$tmp"
 }  ||
 {
@@ -24843,12 +24843,12 @@
   esac
 
   # Compute @srcdir@, @top_srcdir@, and @INSTALL@ for subdirectories.
-  ac_dir=`(dirname "$ac_file") 2>/dev/null ||
+  ac_dir=`(dirname "$ac_file") 2>/System/Devices/null ||
 $as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
          X"$ac_file" : 'X\(//\)[^/]' \| \
          X"$ac_file" : 'X\(//\)$' \| \
          X"$ac_file" : 'X\(/\)' \| \
-         .     : '\(.\)' 2>/dev/null ||
+         .     : '\(.\)' 2>/System/Devices/null ||
 echo X"$ac_file" |
     sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
   	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
@@ -24862,12 +24862,12 @@
     as_dirs=
     while test ! -d "$as_dir"; do
       as_dirs="$as_dir $as_dirs"
-      as_dir=`(dirname "$as_dir") 2>/dev/null ||
+      as_dir=`(dirname "$as_dir") 2>/System/Devices/null ||
 $as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
          X"$as_dir" : 'X\(//\)[^/]' \| \
          X"$as_dir" : 'X\(//\)$' \| \
          X"$as_dir" : 'X\(/\)' \| \
-         .     : '\(.\)' 2>/dev/null ||
+         .     : '\(.\)' 2>/System/Devices/null ||
 echo X"$as_dir" |
     sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
   	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
@@ -24954,7 +24954,7 @@
            # Source tree
            echo $srcdir/$f
          else
-           # /dev/null tree
+           # /System/Devices/null tree
            { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
 echo "$as_me: error: cannot find input file: $f" >&2;}
    { (exit 1); exit 1; }; }
@@ -25045,7 +25045,7 @@
            # Source tree
            echo $srcdir/$f
          else
-           # /dev/null tree
+           # /System/Devices/null tree
            { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
 echo "$as_me: error: cannot find input file: $f" >&2;}
    { (exit 1); exit 1; }; }
@@ -25098,11 +25098,11 @@
 # Break up conftest.defines because some shells have a limit on the size
 # of here documents, and old seds have small limits too (100 cmds).
 echo '  # Handle all the #define templates only if necessary.' >>$CONFIG_STATUS
-echo '  if grep "^[ 	]*#[ 	]*define" $tmp/in >/dev/null; then' >>$CONFIG_STATUS
+echo '  if grep "^[ 	]*#[ 	]*define" $tmp/in >/System/Devices/null; then' >>$CONFIG_STATUS
 echo '  # If there are no defines, we may have an empty if/fi' >>$CONFIG_STATUS
 echo '  :' >>$CONFIG_STATUS
 rm -f conftest.tail
-while grep . conftest.defines >/dev/null
+while grep . conftest.defines >/System/Devices/null
 do
   # Write a limited-size here document to $tmp/defines.sed.
   echo '  cat >$tmp/defines.sed <<CEOF' >>$CONFIG_STATUS
@@ -25129,7 +25129,7 @@
 # of here documents, and old seds have small limits too (100 cmds).
 echo '  # Handle all the #undef templates' >>$CONFIG_STATUS
 rm -f conftest.tail
-while grep . conftest.undefs >/dev/null
+while grep . conftest.undefs >/System/Devices/null
 do
   # Write a limited-size here document to $tmp/undefs.sed.
   echo '  cat >$tmp/undefs.sed <<CEOF' >>$CONFIG_STATUS
@@ -25162,16 +25162,16 @@
   cat $tmp/in >>$tmp/config.h
   rm -f $tmp/in
   if test x"$ac_file" != x-; then
-    if diff $ac_file $tmp/config.h >/dev/null 2>&1; then
+    if diff $ac_file $tmp/config.h >/System/Devices/null 2>&1; then
       { echo "$as_me:$LINENO: $ac_file is unchanged" >&5
 echo "$as_me: $ac_file is unchanged" >&6;}
     else
-      ac_dir=`(dirname "$ac_file") 2>/dev/null ||
+      ac_dir=`(dirname "$ac_file") 2>/System/Devices/null ||
 $as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
          X"$ac_file" : 'X\(//\)[^/]' \| \
          X"$ac_file" : 'X\(//\)$' \| \
          X"$ac_file" : 'X\(/\)' \| \
-         .     : '\(.\)' 2>/dev/null ||
+         .     : '\(.\)' 2>/System/Devices/null ||
 echo X"$ac_file" |
     sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
   	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
@@ -25185,12 +25185,12 @@
     as_dirs=
     while test ! -d "$as_dir"; do
       as_dirs="$as_dir $as_dirs"
-      as_dir=`(dirname "$as_dir") 2>/dev/null ||
+      as_dir=`(dirname "$as_dir") 2>/System/Devices/null ||
 $as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
          X"$as_dir" : 'X\(//\)[^/]' \| \
          X"$as_dir" : 'X\(//\)$' \| \
          X"$as_dir" : 'X\(/\)' \| \
-         .     : '\(.\)' 2>/dev/null ||
+         .     : '\(.\)' 2>/System/Devices/null ||
 echo X"$as_dir" |
     sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
   	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
@@ -25220,12 +25220,12 @@
 for ac_file in : $CONFIG_COMMANDS; do test "x$ac_file" = x: && continue
   ac_dest=`echo "$ac_file" | sed 's,:.*,,'`
   ac_source=`echo "$ac_file" | sed 's,[^:]*:,,'`
-  ac_dir=`(dirname "$ac_dest") 2>/dev/null ||
+  ac_dir=`(dirname "$ac_dest") 2>/System/Devices/null ||
 $as_expr X"$ac_dest" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
          X"$ac_dest" : 'X\(//\)[^/]' \| \
          X"$ac_dest" : 'X\(//\)$' \| \
          X"$ac_dest" : 'X\(/\)' \| \
-         .     : '\(.\)' 2>/dev/null ||
+         .     : '\(.\)' 2>/System/Devices/null ||
 echo X"$ac_dest" |
     sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
   	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
@@ -25389,7 +25389,7 @@
 # config.status does its own redirection, appending to config.log.
 # Unfortunately, on DOS this fails, as config.log is still kept open
 # by configure, so config.status won't be able to write to it; its
-# output is simply discarded.  So we exec the FD to /dev/null,
+# output is simply discarded.  So we exec the FD to /System/Devices/null,
 # effectively closing config.log, so it can be properly (re)opened and
 # appended to by config.status.  When coming back to configure, we
 # need to make the FD available again.
@@ -25398,7 +25398,7 @@
   ac_config_status_args=
   test "$silent" = yes &&
     ac_config_status_args="$ac_config_status_args --quiet"
-  exec 5>/dev/null
+  exec 5>/System/Devices/null
   $SHELL $CONFIG_STATUS $ac_config_status_args || ac_cs_success=false
   exec 5>>config.log
   # Use ||, not &&, to avoid exiting from the if with $? = 1, which
diff -urN bash-3.0/configure.in bash-3.0-STEP/configure.in
--- bash-3.0/configure.in	2004-07-22 08:06:54.000000000 +1200
+++ bash-3.0-STEP/configure.in	2005-08-25 00:34:08.309834096 +1200
@@ -219,7 +219,7 @@
 AC_ARG_ENABLE(history, AC_HELP_STRING([--enable-history], [turn on command history]), opt_history=$enableval)
 AC_ARG_ENABLE(job-control, AC_HELP_STRING([--enable-job-control], [enable job control features]), opt_job_control=$enableval)
 AC_ARG_ENABLE(multibyte, AC_HELP_STRING([--enable-multibyte], [enable multibyte characters if OS supports them]), opt_multibyte=$enableval)
-AC_ARG_ENABLE(net-redirections, AC_HELP_STRING([--enable-net-redirections], [enable /dev/tcp/host/port redirection]), opt_net_redirs=$enableval)
+AC_ARG_ENABLE(net-redirections, AC_HELP_STRING([--enable-net-redirections], [enable /System/Devices/tcp/host/port redirection]), opt_net_redirs=$enableval)
 AC_ARG_ENABLE(process-substitution, AC_HELP_STRING([--enable-process-substitution], [enable process substitution]), opt_process_subst=$enableval)
 AC_ARG_ENABLE(progcomp, AC_HELP_STRING([--enable-progcomp], [enable programmable completion and the complete builtin]), opt_progcomp=$enableval)
 AC_ARG_ENABLE(prompt-string-decoding, AC_HELP_STRING([--enable-prompt-string-decoding], [turn on escape character decoding in prompts]), opt_prompt_decoding=$enableval)
@@ -545,8 +545,8 @@
 AC_PROG_MAKE_SET
 
 case "$host_os" in
-opennt*|interix*)	MAKE_SHELL="$INTERIX_ROOT/bin/sh" ;;
-*)			MAKE_SHELL=/bin/sh ;;
+opennt*|interix*)	MAKE_SHELL="$INTERIX_ROOT/System/Tools/sh" ;;
+*)			MAKE_SHELL=/System/Tools/sh ;;
 esac
 AC_SUBST(MAKE_SHELL)
 
@@ -934,7 +934,7 @@
 dnl FreeBSD-3.x can have either a.out or ELF
 case "${host_os}" in
 freebsd[[3-9]]*)
-		if test -x /usr/bin/objformat && test "`/usr/bin/objformat`" = "elf" ; then
+		if test -x /System/Tools/objformat && test "`/System/Tools/objformat`" = "elf" ; then
 			LOCAL_LDFLAGS=-rdynamic # allow dynamic loading
 		fi ;;
 freebsdelf*)	LOCAL_LDFLAGS=-rdynamic ;;	# allow dynamic loading
@@ -960,7 +960,7 @@
 if test "$ac_cv_func_dlopen" = "yes" && test -f ${srcdir}/support/shobj-conf
 then
 	AC_MSG_CHECKING(shared object configuration for loadable builtins)
-	eval `${CONFIG_SHELL-/bin/sh} ${srcdir}/support/shobj-conf -C "${CC}" -c "${host_cpu}" -o "${host_os}" -v "${host_vendor}"`
+	eval `${CONFIG_SHELL-/System/Tools/sh} ${srcdir}/support/shobj-conf -C "${CC}" -c "${host_cpu}" -o "${host_os}" -v "${host_vendor}"`
 	AC_SUBST(SHOBJ_CC)
 	AC_SUBST(SHOBJ_CFLAGS)
 	AC_SUBST(SHOBJ_LD)
diff -urN bash-3.0/cross-build/cygwin32.cache bash-3.0-STEP/cross-build/cygwin32.cache
--- bash-3.0/cross-build/cygwin32.cache	2001-11-14 04:36:29.000000000 +1300
+++ bash-3.0-STEP/cross-build/cygwin32.cache	2005-08-25 00:33:12.045387592 +1200
@@ -154,7 +154,7 @@
 ac_cv_member_struct_termio_c_line=${ac_cv_member_struct_termio_c_line='yes'}
 ac_cv_member_struct_termios_c_line=${ac_cv_member_struct_termios_c_line='yes'}
 ac_cv_objext=${ac_cv_objext='o'}
-ac_cv_path_install=${ac_cv_path_install='/usr/bin/install -c'}
+ac_cv_path_install=${ac_cv_path_install='/System/Tools/install -c'}
 ac_cv_prog_AR=${ac_cv_prog_AR='ar'}
 ac_cv_prog_CPP=${ac_cv_prog_CPP='gcc -E'}
 ac_cv_prog_YACC=${ac_cv_prog_YACC='bison -y'}
diff -urN bash-3.0/cross-build/opennt.cache bash-3.0-STEP/cross-build/opennt.cache
--- bash-3.0/cross-build/opennt.cache	2001-04-11 03:00:24.000000000 +1200
+++ bash-3.0-STEP/cross-build/opennt.cache	2005-08-25 00:34:08.313833488 +1200
@@ -8,7 +8,7 @@
 # the --cache-file=FILE option to use a different cache file; that is
 # what configure does when it calls configure scripts in
 # subdirectories, so they share the cache.
-# Giving --cache-file=/dev/null disables caching, for debugging configure.
+# Giving --cache-file=/System/Devices/null disables caching, for debugging configure.
 # config.status only pays attention to the cache file if you give it the
 # --recheck option to rerun configure.
 #
@@ -102,7 +102,7 @@
 ac_cv_lib_dl_dlopen=${ac_cv_lib_dl_dlopen=no}
 ac_cv_lib_intl_bindtextdomain=${ac_cv_lib_intl_bindtextdomain=no}
 ac_cv_lib_termcap_tgetent=${ac_cv_lib_termcap_tgetent=yes}
-ac_cv_path_install=${ac_cv_path_install='$INTERIX_ROOT/bin/install -c'}
+ac_cv_path_install=${ac_cv_path_install='$INTERIX_ROOT/System/Tools/install -c'}
 ac_cv_prog_AR=${ac_cv_prog_AR=ar}
 ac_cv_prog_CC=${ac_cv_prog_CC=gcc}
 ac_cv_prog_CPP=${ac_cv_prog_CPP='cc -E'}
diff -urN bash-3.0/doc/FAQ bash-3.0-STEP/doc/FAQ
--- bash-3.0/doc/FAQ	2004-07-22 09:31:46.000000000 +1200
+++ bash-3.0-STEP/doc/FAQ	2005-08-25 00:46:56.367071648 +1200
@@ -60,7 +60,7 @@
 
 Section E:  Why does bash do certain things the way it does?
 
-E1) Why is the bash builtin `test' slightly different from /bin/test?
+E1) Why is the bash builtin `test' slightly different from /System/Tools/test?
 E2) Why does bash sometimes say `Broken pipe'?
 E3) When I have terminal escape sequences in my prompt, why does bash
     wrap lines at the wrong column?
@@ -101,7 +101,7 @@
 G3) How can I find the value of a shell variable whose name is the value
     of another shell variable?
 G4) How can I make the bash `time' reserved word print timing output that
-    looks like the output from my system's /usr/bin/time?
+    looks like the output from my system's /System/Tools/time?
 G5) How do I get the current directory into my prompt?
 G6) How can I rename "*.foo" to "*.bar"?
 G7) How can I translate a filename from uppercase to lowercase?
@@ -224,7 +224,7 @@
 Some machines let you use `chsh' to change your login shell.  Other
 systems use `passwd -s' or `passwd -e'.  If one of these works for
 you, that's all you need.  Note that many systems require the full
-pathname to a shell to appear in /etc/shells before you can make it
+pathname to a shell to appear in /System/Settings/shells before you can make it
 your login shell.  For this, you may need the assistance of your
 friendly local system administrator. 
 
@@ -234,9 +234,9 @@
 bash.
 
 For example, if your login shell is csh or tcsh, and you have installed
-bash in /usr/gnu/bin/bash, add the following line to ~/.login:
+bash in /usr/gnu/System/Tools/bash, add the following line to ~/.login:
 
-	if ( -f /usr/gnu/bin/bash ) exec /usr/gnu/bin/bash --login
+	if ( -f /usr/gnu/System/Tools/bash ) exec /usr/gnu/System/Tools/bash --login
 
 (the `--login' tells bash that it is a login shell).
 
@@ -245,7 +245,7 @@
 reads that file.  If you must put the command in ~/.cshrc, use something
 like
 
-	if ( $?prompt ) exec /usr/gnu/bin/bash --login
+	if ( $?prompt ) exec /usr/gnu/System/Tools/bash --login
 
 to ensure that bash is exec'd only when the csh is interactive.
 
@@ -259,8 +259,8 @@
 
 Next, add a line similar to the above to ~/.profile:
 
-	[ -f /usr/gnu/bin/bash ] && [ -x /usr/gnu/bin/bash ] && \
-		exec /usr/gnu/bin/bash --login
+	[ -f /usr/gnu/System/Tools/bash ] && [ -x /usr/gnu/System/Tools/bash ] && \
+		exec /usr/gnu/System/Tools/bash --login
 
 This will cause login shells to replace themselves with bash running as
 a login shell.  Once you have this working, you can copy your initialization
@@ -290,7 +290,7 @@
 CDE by testing the value of the DT variable:
 
 	if [ -n "$DT" ]; then
-	        [ -f /usr/gnu/bin/bash ] && exec /usr/gnu/bin/bash --login
+	        [ -f /usr/gnu/System/Tools/bash ] && exec /usr/gnu/System/Tools/bash --login
 	fi
 
 If CDE starts its shells non-interactively during login, the login shell
@@ -307,7 +307,7 @@
 A8) I just changed my login shell to bash, and now I can't FTP into my
    machine.  Why not?
 
-You must add the full pathname to bash to the file /etc/shells.  As
+You must add the full pathname to bash to the file /System/Settings/shells.  As
 noted in the answer to the previous question, many systems require
 this before you can make bash your login shell. 
 
@@ -484,7 +484,7 @@
   processing pattern matching bracket expressions, as POSIX requires. 
 o Added a new `--init-file' invocation argument as a synonym for `--rcfile',
   per the new GNU coding standards.
-o The /dev/tcp and /dev/udp redirections now accept service names as well as
+o The /System/Devices/tcp and /System/Devices/udp redirections now accept service names as well as
   port numbers.
 o `complete' and `compgen' now take a `-o value' option, which controls some
    of the aspects of that compspec.  Valid values are:
@@ -517,10 +517,10 @@
 o New ksh93-style arithmetic for command:
 	for ((expr1 ; expr2; expr3 )); do list; done
 o `read' has new options: `-t', `-n', `-d', `-s'
-o The redirection code handles several filenames specially:  /dev/fd/N,
-  /dev/stdin, /dev/stdout, /dev/stderr
-o The redirection code now recognizes /dev/tcp/HOST/PORT and
-  /dev/udp/HOST/PORT and tries to open a TCP or UDP socket, respectively,
+o The redirection code handles several filenames specially:  /System/Devices/fd/N,
+  /System/Devices/stdin, /System/Devices/stdout, /System/Devices/stderr
+o The redirection code now recognizes /System/Devices/tcp/HOST/PORT and
+  /System/Devices/udp/HOST/PORT and tries to open a TCP or UDP socket, respectively,
   to the specified port on the specified host
 o The ${!prefix*} expansion has been implemented
 o A new FUNCNAME variable, which expands to the name of a currently-executing
@@ -715,8 +715,8 @@
 	variable assignments preceding commands affect only that command,
 		even for builtins and functions
 	posix mode
-	redirection to /dev/fd/N, /dev/stdin, /dev/stdout, /dev/stderr,
-		/dev/tcp/host/port, /dev/udp/host/port
+	redirection to /System/Devices/fd/N, /System/Devices/stdin, /System/Devices/stdout, /System/Devices/stderr,
+		/System/Devices/tcp/host/port, /System/Devices/udp/host/port
 	debugger support, including `caller' builtin and new variables
 	RETURN trap
 
@@ -759,7 +759,7 @@
 	posix mode and posix conformance
 	command hashing
 	tilde expansion for assignment statements that look like $PATH
-	process substitution with named pipes if /dev/fd is not available
+	process substitution with named pipes if /System/Devices/fd is not available
 	the ${!param} indirect parameter expansion operator
 	the ${!param*} prefix expansion operator
 	the ${param:offset[:length]} parameter substring operator
@@ -789,7 +789,7 @@
 	egrep-like extended pattern matching operators
 	case-insensitive pattern matching and globbing
 	`**' arithmetic operator to do exponentiation
-	redirection to /dev/fd/N, /dev/stdin, /dev/stdout, /dev/stderr
+	redirection to /System/Devices/fd/N, /System/Devices/stdin, /System/Devices/stdout, /System/Devices/stderr
 	arrays of unlimited size
 	TMOUT is default timeout for `read' and `select'
 	debugger support, including the `caller' builtin
@@ -1055,7 +1055,7 @@
 Section E:  How can I get bash to do certain things, and why does bash do
 	    things the way it does?
 
-E1) Why is the bash builtin `test' slightly different from /bin/test?
+E1) Why is the bash builtin `test' slightly different from /System/Tools/test?
 
 The specific example used here is [ ! x -o x ], which is false.
 
@@ -1154,20 +1154,20 @@
 expansion operators or use some variant of the following
 approach.
 
-Say /usr/local/bin/ipaddr is the following shell script:
+Say /usr/local/System/Tools/ipaddr is the following shell script:
 
-#! /bin/sh
+#! /System/Tools/sh
 host `hostname` | awk '/address/ {print $NF}'
 
 Instead of using
 
-	/usr/local/bin/ipaddr | read A B C D
+	/usr/local/System/Tools/ipaddr | read A B C D
 
 to break the local machine's IP address into separate octets, use
 
 	OIFS="$IFS"
 	IFS=.
-	set -- $(/usr/local/bin/ipaddr)
+	set -- $(/usr/local/System/Tools/ipaddr)
 	IFS="$OIFS"
 	A="$1" B="$2" C="$3" D="$4"
 
@@ -1181,12 +1181,12 @@
 Some other user-supplied alternatives include:
 
 read A B C D << HERE
-    $(IFS=.; echo $(/usr/local/bin/ipaddr))
+    $(IFS=.; echo $(/usr/local/System/Tools/ipaddr))
 HERE
 
 and, where process substitution is available,
 
-read A B C D < <(IFS=.; echo $(/usr/local/bin/ipaddr))
+read A B C D < <(IFS=.; echo $(/usr/local/System/Tools/ipaddr))
 
 E5) I have a bunch of shell scripts that use backslash-escaped characters
     in arguments to `echo'.  Bash doesn't interpret these characters.  Why
@@ -1315,7 +1315,7 @@
 
 	export LC_COLLATE=C
 
-into /etc/profile and inspect any shell scripts run from cron for
+into /System/Settings/profile and inspect any shell scripts run from cron for
 constructs like [A-Z].  This will prevent things like
 
 	rm [A-Z]*
@@ -1420,7 +1420,7 @@
 
 Make sure you've got /usr/ccs/bin ahead of /usr/ucb in your $PATH
 when configuring and building bash.  This will ensure that you
-use /usr/ccs/bin/cc or acc instead of /usr/ucb/cc and that you
+use /usr/ccs/System/Tools/cc or acc instead of /usr/ucb/cc and that you
 link with libc before libucb. 
 
 If you have installed the Sun C compiler, you may also need to
@@ -1493,19 +1493,19 @@
 
 The short answer is that Red Hat screwed up.
 
-The long answer is that they shipped an /etc/inputrc that only works
+The long answer is that they shipped an /System/Settings/inputrc that only works
 for emacs mode editing, and then screwed all the vi users by setting
-INPUTRC to /etc/inputrc in /etc/profile.
+INPUTRC to /System/Settings/inputrc in /System/Settings/profile.
 
 The short fix is to do one of the following: remove or rename
-/etc/inputrc, set INPUTRC=~/.inputrc in ~/.bashrc (or .bash_profile,
+/System/Settings/inputrc, set INPUTRC=~/.inputrc in ~/.bashrc (or .bash_profile,
 but make sure you export it if you do), remove the assignment to
-INPUTRC from /etc/profile, add
+INPUTRC from /System/Settings/profile, add
 
         set keymap emacs
 
-to the beginning of /etc/inputrc, or bracket the key bindings in
-/etc/inputrc with these lines
+to the beginning of /System/Settings/inputrc, or bracket the key bindings in
+/System/Settings/inputrc with these lines
 
 	$if mode=emacs
 		[...]
@@ -1618,7 +1618,7 @@
 is similar.  I may add namerefs in a future bash version.
 
 G4) How can I make the bash `time' reserved word print timing output that
-     looks like the output from my system's /usr/bin/time?
+     looks like the output from my system's /System/Tools/time?
 
 The bash command timing code looks for a variable `TIMEFORMAT' and
 uses its value as a format string to decide how to display the
@@ -1637,11 +1637,11 @@
 
 	TIMEFORMAT=$'real %2R\nuser %2U\nsys %2S'
 
-The BSD /usr/bin/time format can be emulated with:
+The BSD /System/Tools/time format can be emulated with:
 
 	TIMEFORMAT=$'\t%1R real\t%1U user\t%1S sys'
 
-The System V /usr/bin/time format can be emulated with:
+The System V /System/Tools/time format can be emulated with:
 
 	TIMEFORMAT=$'\nreal\t%1R\nuser\t%1U\nsys\t%1S'
 
diff -urN bash-3.0/doc/Makefile.in bash-3.0-STEP/doc/Makefile.in
--- bash-3.0/doc/Makefile.in	2004-07-28 00:57:48.000000000 +1200
+++ bash-3.0-STEP/doc/Makefile.in	2005-08-25 00:34:08.416817832 +1200
@@ -227,7 +227,7 @@
 #	-$(INSTALL_DATA) $(srcdir)/builtins.1 $(DESTDIR)$(man1dir)/bash_builtins${man1ext}
 	-$(INSTALL_DATA) $(srcdir)/bash.info $(DESTDIR)$(infodir)/bash.info
 # run install-info if it is present to update the info directory
-	if $(SHELL) -c 'install-info --version' >/dev/null 2>&1; then \
+	if $(SHELL) -c 'install-info --version' >/System/Devices/null 2>&1; then \
 		install-info --dir-file=$(DESTDIR)$(infodir)/dir $(DESTDIR)$(infodir)/bash.info; \
 	else true; fi
 # if htmldir is set, install the html files into that directory
diff -urN bash-3.0/doc/article.ms bash-3.0-STEP/doc/article.ms
--- bash-3.0/doc/article.ms	1994-10-20 06:47:08.000000000 +1300
+++ bash-3.0-STEP/doc/article.ms	2005-08-25 00:34:10.239540736 +1200
@@ -29,7 +29,7 @@
 the \*QBourne-Again SHell\*U, a pun on Steve Bourne, the author
 of the direct ancestor of the current
 .UX
-shell \fI/bin/sh\fP,
+shell \fI/System/Tools/sh\fP,
 which appeared in the Seventh Edition Bell Labs Research version
 of \s-1UNIX\s+1.
 .PP
@@ -232,7 +232,7 @@
 name (\f(CRalias del=rm\fP), to expand a single word to a complex command
 (\f(CRalias news='xterm -g 80x45 -title trn -e trn -e -S1 -N &'\fP), or to
 ensure that a command is invoked with a basic set of options
-(\f(CRalias ls="/bin/ls -F"\fP).
+(\f(CRalias ls="/System/Tools/ls -F"\fP).
 .PP
 The C shell (\fBcsh\fP)\(dg, originally written by Bill Joy while at
 Berkeley, is widely used and quite popular for its interactive
@@ -404,7 +404,7 @@
 $ type -t export
 builtin
 $ type bash
-bash is /bin/bash
+bash is /System/Tools/bash
 $ type cd
 cd is a function
 cd ()
@@ -648,7 +648,7 @@
 but the shell does not collect the command's output and insert it into
 the command line.  Rather, Bash opens a pipe to the command, which
 is run in the background.  The shell uses named pipes (FIFOs) or the
-.I /dev/fd
+.I /System/Devices/fd
 method of naming open files to expand the process
 substitution to a filename which connects to the pipe when opened.
 This filename becomes the result of the expansion.  Process substitution
@@ -745,17 +745,17 @@
 /usr/local/bin
 $ pwd
 /usr/local/bin
-$ /bin/pwd
+$ /System/Tools/pwd
 /net/share/sun4/local/bin
 $ cd ..
 $ pwd
 /usr/local
-$ /bin/pwd
+$ /System/Tools/pwd
 /net/share/sun4/local
 $ cd ..
 $ pwd
 /usr
-$ /bin/pwd
+$ /System/Tools/pwd
 /usr
 .EE
 .LP
@@ -1082,7 +1082,7 @@
 for more information.
 .PP
 Bash is also distributed with several versions of \s-1UNIX\s+1-compatible
-systems.  It is included as /bin/sh and /bin/bash on several Linux
+systems.  It is included as /System/Tools/sh and /System/Tools/bash on several Linux
 distributions (more about the difference in a moment), and as contributed
 software in BSDI's BSD/386* and FreeBSD.
 .FS
@@ -1099,8 +1099,8 @@
 process substitution, prompt string special character decoding, and the
 .I select
 construct.  This minimal version is designed to be a drop-in replacement
-for the traditional \s-1UNIX\s+1 /bin/sh, and is included as the Linux
-/bin/sh in several packagings.
+for the traditional \s-1UNIX\s+1 /System/Tools/sh, and is included as the Linux
+/System/Tools/sh in several packagings.
 .NH 1
 Conclusion
 .PP
diff -urN bash-3.0/doc/bash.1 bash-3.0-STEP/doc/bash.1
--- bash-3.0/doc/bash.1	2004-07-13 03:27:08.000000000 +1200
+++ bash-3.0-STEP/doc/bash.1	2005-08-25 00:46:56.718018296 +1200
@@ -197,7 +197,7 @@
 .TP
 .B \-\-noprofile
 Do not read either the system-wide startup file
-.FN /etc/profile
+.FN /System/Settings/profile
 or any of the personal initialization files
 .IR ~/.bash_profile ,
 .IR ~/.bash_login ,
@@ -303,7 +303,7 @@
 .B bash
 is invoked as an interactive login shell, or as a non-interactive shell
 with the \fB\-\-login\fP option, it first reads and
-executes commands from the file \fI/etc/profile\fP, if that
+executes commands from the file \fI/System/Settings/profile\fP, if that
 file exists.
 After reading that file, it looks for \fI~/.bash_profile\fP,
 \fI~/.bash_login\fP, and \fI~/.profile\fP, in that order, and reads
@@ -359,7 +359,7 @@
 When invoked as an interactive login shell, or a non-interactive
 shell with the \fB\-\-login\fP option, it first attempts to
 read and execute commands from
-.I /etc/profile
+.I /System/Settings/profile
 and
 .IR ~/.profile ,
 in that order.
@@ -1671,7 +1671,7 @@
 .TP
 .B HOSTFILE
 Contains the name of a file in the same format as
-.FN /etc/hosts
+.FN /System/Settings/hosts
 that should be read when the shell needs to complete a
 hostname.
 The list of possible hostname completions may be changed while the
@@ -1684,7 +1684,7 @@
 .SM
 .B HOSTFILE
 is set, but has no value, \fBbash\fP attempts to read
-.FN /etc/hosts
+.FN /System/Settings/hosts
 to obtain the list of possible hostname completions.
 When
 .SM
@@ -1821,8 +1821,8 @@
 and is set by the administrator who installs
 .BR bash .
 A common value is
-.if t \f(CW/usr/gnu/bin:/usr/local/bin:/usr/ucb:/bin:/usr/bin\fP.
-.if n ``/usr/gnu/bin:/usr/local/bin:/usr/ucb:/bin:/usr/bin''.
+.if t \f(CW/usr/gnu/bin:/usr/local/bin:/usr/ucb:/bin:/System/Tools\fP.
+.if n ``/usr/gnu/bin:/usr/local/bin:/usr/ucb:/bin:/System/Tools''.
 .TP
 .B POSIXLY_CORRECT
 If this variable is in the environment when \fBbash\fP starts, the shell
@@ -2558,13 +2558,13 @@
 .SS Process Substitution
 .PP
 \fIProcess substitution\fP is supported on systems that support named
-pipes (\fIFIFOs\fP) or the \fB/dev/fd\fP method of naming open files.
+pipes (\fIFIFOs\fP) or the \fB/System/Devices/fd\fP method of naming open files.
 It takes the form of
 \fB<(\fP\fIlist\^\fP\fB)\fP
 or
 \fB>(\fP\fIlist\^\fP\fB)\fP.
 The process \fIlist\fP is run with its input or output connected to a
-\fIFIFO\fP or some file in \fB/dev/fd\fP.  The name of this file is
+\fIFIFO\fP or some file in \fB/System/Devices/fd\fP.  The name of this file is
 passed as an argument to the current command as the result of the
 expansion.  If the \fB>(\fP\fIlist\^\fP\fB)\fP form is used, writing to
 the file will provide input for \fIlist\fP.  If the
@@ -2918,24 +2918,24 @@
 .PP
 .PD 0
 .TP
-.B /dev/fd/\fIfd\fP
+.B /System/Devices/fd/\fIfd\fP
 If \fIfd\fP is a valid integer, file descriptor \fIfd\fP is duplicated.
 .TP
-.B /dev/stdin
+.B /System/Devices/stdin
 File descriptor 0 is duplicated.
 .TP
-.B /dev/stdout
+.B /System/Devices/stdout
 File descriptor 1 is duplicated.
 .TP
-.B /dev/stderr
+.B /System/Devices/stderr
 File descriptor 2 is duplicated.
 .TP
-.B /dev/tcp/\fIhost\fP/\fIport\fP
+.B /System/Devices/tcp/\fIhost\fP/\fIport\fP
 If \fIhost\fP is a valid hostname or Internet address, and \fIport\fP
 is an integer port number or service name, \fBbash\fP attempts to open
 a TCP connection to the corresponding socket.
 .TP
-.B /dev/udp/\fIhost\fP/\fIport\fP
+.B /System/Devices/udp/\fIhost\fP/\fIport\fP
 If \fIhost\fP is a valid hostname or Internet address, and \fIport\fP
 is an integer port number or service name, \fBbash\fP attempts to open
 a UDP connection to the corresponding socket.
@@ -3454,9 +3454,9 @@
 and perform string and arithmetic comparisons.
 Expressions are formed from the following unary or binary primaries.
 If any \fIfile\fP argument to one of the primaries is of the form
-\fI/dev/fd/n\fP, then file descriptor \fIn\fP is checked.
+\fI/System/Devices/fd/n\fP, then file descriptor \fIn\fP is checked.
 If the \fIfile\fP argument to one of the primaries is one of
-\fI/dev/stdin\fP, \fI/dev/stdout\fP, or \fI/dev/stderr\fP, file
+\fI/System/Devices/stdin\fP, \fI/System/Devices/stdout\fP, or \fI/System/Devices/stderr\fP, file
 descriptor 0, 1, or 2, respectively, is checked.
 .sp 1
 .PD 0
@@ -3761,7 +3761,7 @@
 cannot affect the shell's execution environment.
 .PP
 If a command is followed by a \fB&\fP and job control is not active, the
-default standard input for the command is the empty file \fI/dev/null\fP.
+default standard input for the command is the empty file \fI/System/Devices/null\fP.
 Otherwise, the invoked command inherits the file descriptors of the calling
 shell as modified by redirections.
 .SH ENVIRONMENT
@@ -4703,11 +4703,11 @@
 .IP \fB$include\fP
 This directive takes a single filename as an argument and reads commands
 and bindings from that file.  For example, the following directive
-would read \fI/etc/inputrc\fP:
+would read \fI/System/Settings/inputrc\fP:
 .sp 1
 .RS
 .nf
-\fB$include\fP \^ \fI/etc/inputrc\fP
+\fB$include\fP \^ \fI/System/Settings/inputrc\fP
 .fi
 .RE
 .SS Searching
@@ -8636,10 +8636,10 @@
 .SH FILES
 .PD 0
 .TP
-.FN /bin/bash
+.FN /System/Tools/bash
 The \fBbash\fP executable
 .TP
-.FN /etc/profile
+.FN /System/Settings/profile
 The systemwide initialization file, executed for login shells
 .TP
 .FN ~/.bash_profile
diff -urN bash-3.0/doc/bashref.info bash-3.0-STEP/doc/bashref.info
--- bash-3.0/doc/bashref.info	2004-07-28 01:10:59.000000000 +1200
+++ bash-3.0-STEP/doc/bashref.info	2005-08-25 00:46:57.442908096 +1200
@@ -83,7 +83,7 @@
 
 * Major Differences From The Bourne Shell::	A terse list of the differences
 						between Bash and historical
-						versions of /bin/sh.
+						versions of /System/Tools/sh.
 
 * Copying This Manual::		Copying this manual.
 
@@ -633,7 +633,7 @@
 the command to finish, and the return status is 0 (true).  When job
 control is not active (*note Job Control::), the standard input for
 asynchronous commands, in the absence of any explicit redirections, is
-redirected from `/dev/null'.
+redirected from `/System/Devices/null'.
 
    Commands separated by a `;' are executed sequentially; the shell
 waits for each command to terminate in turn.  The return status is the
@@ -1506,13 +1506,13 @@
 --------------------------
 
 Process substitution is supported on systems that support named pipes
-(FIFOs) or the `/dev/fd' method of naming open files.  It takes the
+(FIFOs) or the `/System/Devices/fd' method of naming open files.  It takes the
 form of
      <(LIST)
    or
      >(LIST)
    The process LIST is run with its input or output connected to a FIFO
-or some file in `/dev/fd'.  The name of this file is passed as an
+or some file in `/System/Devices/fd'.  The name of this file is passed as an
 argument to the current command as the result of the expansion.  If the
 `>(LIST)' form is used, writing to the file will provide input for
 LIST.  If the `<(LIST)' form is used, the file passed as an argument
@@ -1724,24 +1724,24 @@
    Bash handles several filenames specially when they are used in
 redirections, as described in the following table:
 
-`/dev/fd/FD'
+`/System/Devices/fd/FD'
      If FD is a valid integer, file descriptor FD is duplicated.
 
-`/dev/stdin'
+`/System/Devices/stdin'
      File descriptor 0 is duplicated.
 
-`/dev/stdout'
+`/System/Devices/stdout'
      File descriptor 1 is duplicated.
 
-`/dev/stderr'
+`/System/Devices/stderr'
      File descriptor 2 is duplicated.
 
-`/dev/tcp/HOST/PORT'
+`/System/Devices/tcp/HOST/PORT'
      If HOST is a valid hostname or Internet address, and PORT is an
      integer port number or service name, Bash attempts to open a TCP
      connection to the corresponding socket.
 
-`/dev/udp/HOST/PORT'
+`/System/Devices/udp/HOST/PORT'
      If HOST is a valid hostname or Internet address, and PORT is an
      integer port number or service name, Bash attempts to open a UDP
      connection to the corresponding socket.
@@ -2064,7 +2064,7 @@
 subshell environment cannot affect the shell's execution environment.
 
    If a command is followed by a `&' and job control is not active, the
-default standard input for the command is the empty file `/dev/null'.
+default standard input for the command is the empty file `/System/Devices/null'.
 Otherwise, the invoked command inherits the file descriptors of the
 calling shell as modified by redirections.
 
@@ -2222,7 +2222,7 @@
 do not handle it themselves.  Note that some older versions of Unix
 limit the interpreter name and argument to a maximum of 32 characters.
 
-   Bash scripts often begin with `#! /bin/bash' (assuming that Bash has
+   Bash scripts often begin with `#! /System/Tools/bash' (assuming that Bash has
 been installed in `/bin'), since this ensures that Bash will be used to
 interpret the script, even if it is executed under another shell.
 
@@ -3933,13 +3933,13 @@
      they may be preserved across shell sessions.
 
 `HOSTFILE'
-     Contains the name of a file in the same format as `/etc/hosts' that
+     Contains the name of a file in the same format as `/System/Settings/hosts' that
      should be read when the shell needs to complete a hostname.  The
      list of possible hostname completions may be changed while the
      shell is running; the next time hostname completion is attempted
      after the value is changed, Bash adds the contents of the new file
      to the existing list.  If `HOSTFILE' is set, but has no value,
-     Bash attempts to read `/etc/hosts' to obtain the list of possible
+     Bash attempts to read `/System/Settings/hosts' to obtain the list of possible
      hostname completions.  When `HOSTFILE' is unset, the hostname list
      is cleared.
 
@@ -4217,7 +4217,7 @@
      to read  command lines when the shell is interactive.
 
 `--noprofile'
-     Don't load the system-wide startup file `/etc/profile' or any of
+     Don't load the system-wide startup file `/System/Settings/profile' or any of
      the personal initialization files `~/.bash_profile',
      `~/.bash_login', or `~/.profile' when Bash is invoked as a login
      shell.
@@ -4332,7 +4332,7 @@
 
 When Bash is invoked as an interactive login shell, or as a
 non-interactive shell with the `--login' option, it first reads and
-executes commands from the file `/etc/profile', if that file exists.
+executes commands from the file `/System/Settings/profile', if that file exists.
 After reading that file, it looks for `~/.bash_profile',
 `~/.bash_login', and `~/.profile', in that order, and reads and
 executes commands from the first one that exists and is readable.  The
@@ -4380,7 +4380,7 @@
 
    When invoked as an interactive login shell, or as a non-interactive
 shell with the `--login' option, it first attempts to read and execute
-commands from `/etc/profile' and `~/.profile', in that order.  The
+commands from `/System/Settings/profile' and `~/.profile', in that order.  The
 `--noprofile' option may be used to inhibit this behavior.  When
 invoked as an interactive shell with the name `sh', Bash looks for the
 variable `ENV', expands its value if it is defined, and uses the
@@ -4572,9 +4572,9 @@
    Expressions may be unary or binary.  Unary expressions are often
 used to examine the status of a file.  There are string operators and
 numeric comparison operators as well.  If the FILE argument to one of
-the primaries is of the form `/dev/fd/N', then file descriptor N is
+the primaries is of the form `/System/Devices/fd/N', then file descriptor N is
 checked.  If the FILE argument to one of the primaries is one of
-`/dev/stdin', `/dev/stdout', or `/dev/stderr', file descriptor 0, 1, or
+`/System/Devices/stdin', `/System/Devices/stdout', or `/System/Devices/stderr', file descriptor 0, 1, or
 2, respectively, is checked.
 
 `-a FILE'
@@ -6207,8 +6207,8 @@
 `$include'
      This directive takes a single filename as an argument and reads
      commands and bindings from that file.  For example, the following
-     directive reads from `/etc/inputrc':
-          $include /etc/inputrc
+     directive reads from `/System/Settings/inputrc':
+          $include /System/Settings/inputrc
 
 
 File: bashref.info,  Node: Sample Init File,  Prev: Conditional Init Constructs,  Up: Readline Init File
@@ -6228,8 +6228,8 @@
      # Lines beginning with '#' are comments.
      #
      # First, include any systemwide bindings and variable
-     # assignments from /etc/Inputrc
-     $include /etc/Inputrc
+     # assignments from /System/Settings/Inputrc
+     $include /System/Settings/Inputrc
 
      #
      # Set various bindings for emacs mode.
@@ -7749,7 +7749,7 @@
 can create a site shell script called `config.site' that gives default
 values for variables like `CC', `cache_file', and `prefix'.  `configure'
 looks for `PREFIX/share/config.site' if it exists, then
-`PREFIX/etc/config.site' if it exists.  Or, you can set the
+`PREFIX/System/Settings/config.site' if it exists.  Or, you can set the
 `CONFIG_SITE' environment variable to the location of the site script.
 A warning: the Bash `configure' looks for a site script, but not all
 `configure' scripts do.
@@ -7764,7 +7764,7 @@
 
 `--cache-file=FILE'
      Use and save the results of the tests in FILE instead of
-     `./config.cache'.  Set FILE to `/dev/null' to disable caching, for
+     `./config.cache'.  Set FILE to `/System/Devices/null' to disable caching, for
      debugging `configure'.
 
 `--help'
@@ -7942,7 +7942,7 @@
 
 `--enable-net-redirections'
      This enables the special handling of filenames of the form
-     `/dev/tcp/HOST/PORT' and `/dev/udp/HOST/PORT' when used in
+     `/System/Devices/tcp/HOST/PORT' and `/System/Devices/udp/HOST/PORT' when used in
      redirections (*note Redirections::).
 
 `--enable-process-substitution'
diff -urN bash-3.0/doc/bashref.texi bash-3.0-STEP/doc/bashref.texi
--- bash-3.0/doc/bashref.texi	2004-06-27 06:26:07.000000000 +1200
+++ bash-3.0-STEP/doc/bashref.texi	2005-08-25 00:46:56.948983184 +1200
@@ -121,7 +121,7 @@
 
 * Major Differences From The Bourne Shell::	A terse list of the differences
 						between Bash and historical
-						versions of /bin/sh.
+						versions of /System/Tools/sh.
 
 * Copying This Manual::		Copying this manual.
 
@@ -697,7 +697,7 @@
 status is 0 (true).
 When job control is not active (@pxref{Job Control}),
 the standard input for asynchronous commands, in the absence of any
-explicit redirections, is redirected from @code{/dev/null}.
+explicit redirections, is redirected from @code{/System/Devices/null}.
 
 Commands separated by a @samp{;} are executed sequentially; the shell
 waits for each command to terminate in turn.  The return status is the
@@ -1731,7 +1731,7 @@
 @cindex process substitution
 
 Process substitution is supported on systems that support named
-pipes (@sc{fifo}s) or the @file{/dev/fd} method of naming open files.
+pipes (@sc{fifo}s) or the @file{/System/Devices/fd} method of naming open files.
 It takes the form of 
 @example
 <(@var{list})
@@ -1743,7 +1743,7 @@
 @end example
 @noindent
 The process @var{list} is run with its input or output connected to a
-@sc{fifo} or some file in @file{/dev/fd}.  The name of this file is
+@sc{fifo} or some file in @file{/System/Devices/fd}.  The name of this file is
 passed as an argument to the current command as the result of the
 expansion.  If the @code{>(@var{list})} form is used, writing to
 the file will provide input for @var{list}.  If the
@@ -1987,24 +1987,24 @@
 redirections, as described in the following table:
 
 @table @code
-@item /dev/fd/@var{fd}
+@item /System/Devices/fd/@var{fd}
 If @var{fd} is a valid integer, file descriptor @var{fd} is duplicated.
 
-@item /dev/stdin
+@item /System/Devices/stdin
 File descriptor 0 is duplicated.
 
-@item /dev/stdout
+@item /System/Devices/stdout
 File descriptor 1 is duplicated.
 
-@item /dev/stderr
+@item /System/Devices/stderr
 File descriptor 2 is duplicated.
 
-@item /dev/tcp/@var{host}/@var{port}
+@item /System/Devices/tcp/@var{host}/@var{port}
 If @var{host} is a valid hostname or Internet address, and @var{port}
 is an integer port number or service name, Bash attempts to open a TCP
 connection to the corresponding socket.
 
-@item /dev/udp/@var{host}/@var{port}
+@item /System/Devices/udp/@var{host}/@var{port}
 If @var{host} is a valid hostname or Internet address, and @var{port}
 is an integer port number or service name, Bash attempts to open a UDP
 connection to the corresponding socket.
@@ -2389,7 +2389,7 @@
 cannot affect the shell's execution environment.
 
 If a command is followed by a @samp{&} and job control is not active, the
-default standard input for the command is the empty file @file{/dev/null}.
+default standard input for the command is the empty file @file{/System/Devices/null}.
 Otherwise, the invoked command inherits the file descriptors of the calling
 shell as modified by redirections.
 
@@ -2562,7 +2562,7 @@
 themselves.  Note that some older versions of Unix limit the interpreter
 name and argument to a maximum of 32 characters.
 
-Bash scripts often begin with @code{#! /bin/bash} (assuming that
+Bash scripts often begin with @code{#! /System/Tools/bash} (assuming that
 Bash has been installed in @file{/bin}), since this ensures that
 Bash will be used to interpret the script, even if it is executed
 under another shell.
@@ -4509,7 +4509,7 @@
 they may be preserved across shell sessions.
 
 @item HOSTFILE
-Contains the name of a file in the same format as @file{/etc/hosts} that
+Contains the name of a file in the same format as @file{/System/Settings/hosts} that
 should be read when the shell needs to complete a hostname.
 The list of possible hostname completions may be changed while the shell
 is running;
@@ -4517,7 +4517,7 @@
 value is changed, Bash adds the contents of the new file to the
 existing list.
 If @env{HOSTFILE} is set, but has no value, Bash attempts to read 
-@file{/etc/hosts} to obtain the list of possible hostname completions.
+@file{/System/Settings/hosts} to obtain the list of possible hostname completions.
 When @env{HOSTFILE} is unset, the hostname list is cleared.
 
 @item HOSTNAME
@@ -4806,7 +4806,7 @@
 to read  command lines when the shell is interactive.
 
 @item --noprofile
-Don't load the system-wide startup file @file{/etc/profile}
+Don't load the system-wide startup file @file{/System/Settings/profile}
 or any of the personal initialization files
 @file{~/.bash_profile}, @file{~/.bash_login}, or @file{~/.profile}
 when Bash is invoked as a login shell.
@@ -4931,7 +4931,7 @@
 
 When Bash is invoked as an interactive login shell, or as a
 non-interactive shell with the @option{--login} option, it first reads and
-executes commands from the file @file{/etc/profile}, if that file exists.
+executes commands from the file @file{/System/Settings/profile}, if that file exists.
 After reading that file, it looks for @file{~/.bash_profile},
 @file{~/.bash_login}, and @file{~/.profile}, in that order, and reads
 and executes commands from the first one that exists and is readable.
@@ -4982,7 +4982,7 @@
 
 When invoked as an interactive login shell, or as a non-interactive
 shell with the @option{--login} option, it first attempts to read
-and execute commands from @file{/etc/profile} and @file{~/.profile}, in
+and execute commands from @file{/System/Settings/profile} and @file{~/.profile}, in
 that order.
 The @option{--noprofile} option may be used to inhibit this behavior.
 When invoked as an interactive shell with the name @code{sh}, Bash
@@ -5196,9 +5196,9 @@
 Unary expressions are often used to examine the status of a file.
 There are string operators and numeric comparison operators as well.
 If the @var{file} argument to one of the primaries is of the form
-@file{/dev/fd/@var{N}}, then file descriptor @var{N} is checked.
+@file{/System/Devices/fd/@var{N}}, then file descriptor @var{N} is checked.
 If the @var{file} argument to one of the primaries is one of
-@file{/dev/stdin}, @file{/dev/stdout}, or @file{/dev/stderr}, file
+@file{/System/Devices/stdin}, @file{/System/Devices/stdout}, or @file{/System/Devices/stderr}, file
 descriptor 0, 1, or 2, respectively, is checked.
 
 @table @code
@@ -6501,7 +6501,7 @@
 @code{config.site} that gives default values for variables like
 @code{CC}, @code{cache_file}, and @code{prefix}.  @code{configure}
 looks for @file{PREFIX/share/config.site} if it exists, then
-@file{PREFIX/etc/config.site} if it exists.  Or, you can set the
+@file{PREFIX/System/Settings/config.site} if it exists.  Or, you can set the
 @code{CONFIG_SITE} environment variable to the location of the site
 script.  A warning: the Bash @code{configure} looks for a site script,
 but not all @code{configure} scripts do.
@@ -6517,7 +6517,7 @@
 @item --cache-file=@var{file}
 Use and save the results of the tests in
 @var{file} instead of @file{./config.cache}.  Set @var{file} to
-@file{/dev/null} to disable caching, for debugging
+@file{/System/Devices/null} to disable caching, for debugging
 @code{configure}. 
 
 @item --help
@@ -6705,8 +6705,8 @@
 
 @item --enable-net-redirections
 This enables the special handling of filenames of the form
-@code{/dev/tcp/@var{host}/@var{port}} and
-@code{/dev/udp/@var{host}/@var{port}}
+@code{/System/Devices/tcp/@var{host}/@var{port}} and
+@code{/System/Devices/udp/@var{host}/@var{port}}
 when used in redirections (@pxref{Redirections}).
 
 @item --enable-process-substitution
diff -urN bash-3.0/doc/htmlpost.sh bash-3.0-STEP/doc/htmlpost.sh
--- bash-3.0/doc/htmlpost.sh	1999-10-06 03:58:31.000000000 +1300
+++ bash-3.0-STEP/doc/htmlpost.sh	2005-08-25 00:46:57.447907336 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 #
 # Some of these should really be done by man2html
 #
@@ -7,8 +7,8 @@
 #
 
 sed -e 's|<B>gnu.bash.bug</B>|<A HREF="news:gnu.bash.bug">gnu.bash.bug</A>|g' \
-    -e 's|<I>/bin/bash</I>|<A HREF="file:/bin/bash"><I>/bin/bash</I></A>|g' \
-    -e 's|<I>/etc/profile</I>|<A HREF="file:/etc/profile"><I>/etc/profile</I></A>|g' \
+    -e 's|<I>/System/Tools/bash</I>|<A HREF="file:/System/Tools/bash"><I>/System/Tools/bash</I></A>|g' \
+    -e 's|<I>/System/Settings/profile</I>|<A HREF="file:/System/Settings/profile"><I>/System/Settings/profile</I></A>|g' \
     -e 's|<I>~/.bash_profile</I>|<A HREF="file:~/.bash_profile"><I>~/.bash_profile</I></A>|g' \
     -e 's|<I>~/.bash_login</I>|<A HREF="file:~/.bash_login"><I>~/.bash_login</I></A>|g' \
     -e 's|<I>~/.profile</I>|<A HREF="file:~/.profile"><I>~/.profile</I></A>|g' \
@@ -16,4 +16,4 @@
     -e 's|<I>~/.bash_logout</I>|<A HREF="file:~/.bash_logout"><I>~/.bash_logout</I></A>|g' \
     -e 's|<I>~/.bash_history</I>|<A HREF="file:~/.bash_history"><I>~/.bash_history</I></A>|g' \
     -e 's|<I>~/.inputrc</I>|<A HREF="file:~/.inputrc"><I>~/.inputrc</I></A>|g' \
-    -e 's|<I>/etc/inputrc</I>|<A HREF="file:/etc/inputrc"><I>/etc/inputrc</I></A>|g'
+    -e 's|<I>/System/Settings/inputrc</I>|<A HREF="file:/System/Settings/inputrc"><I>/System/Settings/inputrc</I></A>|g'
diff -urN bash-3.0/doc/infopost.sh bash-3.0-STEP/doc/infopost.sh
--- bash-3.0/doc/infopost.sh	2003-05-30 04:03:36.000000000 +1200
+++ bash-3.0-STEP/doc/infopost.sh	2005-08-25 00:33:16.785666960 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 #
 # Some of these should really be done by options to makeinfo or by
 # using @setfilename, but this way we can have both bashref.info and
diff -urN bash-3.0/error.c bash-3.0-STEP/error.c
--- bash-3.0/error.c	2003-12-19 17:44:01.000000000 +1300
+++ bash-3.0-STEP/error.c	2005-08-25 00:47:17.466863992 +1200
@@ -373,7 +373,7 @@
   static FILE *tracefp = (FILE *)NULL;
 
   if (tracefp == NULL)
-    tracefp = fopen("/tmp/bash-trace.log", "a+");
+    tracefp = fopen("/System/TemporaryFiles/bash-trace.log", "a+");
 
   if (tracefp == NULL)
     tracefp = stderr;
diff -urN bash-3.0/examples/bashdb/bashdb bash-3.0-STEP/examples/bashdb/bashdb
--- bash-3.0/examples/bashdb/bashdb	2002-03-19 01:07:13.000000000 +1200
+++ bash-3.0-STEP/examples/bashdb/bashdb	2005-08-25 00:47:17.476862472 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 # bashdb - Bash shell debugger
 #
 # Adapted from an idea in O'Reilly's `Learning the Korn Shell'
@@ -29,7 +29,7 @@
 # This program requires bash 2.x.
 # If bash 2.x is installed as "bash2", you can invoke  bashdb like this:
 #
-#   DEBUG_SHELL=/bin/bash2 /bin/bash2 bashdb script.sh
+#   DEBUG_SHELL=/System/Tools/bash2 /System/Tools/bash2 bashdb script.sh
 
 # TODO:
 #
@@ -60,7 +60,7 @@
 
 shift
 
-__debug=${TMPDIR-/tmp}/bashdb.$$
+__debug=${TMPDIR-/System/TemporaryFiles}/bashdb.$$
 sed -e '/^# bashdb - Bash shell debugger/,/^# -- DO NOT DELETE THIS LINE -- /d' "$0" > $__debug
 cat $_guineapig >> $__debug
 exec ${DEBUG_SHELL-bash} $__debug $_guineapig "$@"
@@ -118,7 +118,7 @@
     _showline $_curline
     _cmdloop
   elif (( $_steps == 0 )); then
-    # Assuming a real script will have the "#! /bin/sh" at line 1,
+    # Assuming a real script will have the "#! /System/Tools/sh" at line 1,
     # assume that when $_curline == 1 we are inside backticks.
     if (( ! $_trace )); then
       _msg "Stopped at line $_curline"
@@ -397,12 +397,12 @@
 
   # XXX - should use shell patterns
   if test -z "$line" \
-      || expr "$line" : '[ \t]*#.*' > /dev/null \
-      || expr "$line" : '[ \t]*;;[ \t]*$' > /dev/null \
-      || expr "$line" : '[ \t]*[^)]*)[ \t]*$' > /dev/null \
-      || expr "$line" : '[ \t]*;;[ \t]*#.**$' > /dev/null \
-      || expr "$line" : '[ \t]*[^)]*)[ \t]*;;[ \t]*$' > /dev/null \
-      || expr "$line" : '[ \t]*[^)]*)[ \t]*;;*[ \t]*#.*$' > /dev/null
+      || expr "$line" : '[ \t]*#.*' > /System/Devices/null \
+      || expr "$line" : '[ \t]*;;[ \t]*$' > /System/Devices/null \
+      || expr "$line" : '[ \t]*[^)]*)[ \t]*$' > /System/Devices/null \
+      || expr "$line" : '[ \t]*;;[ \t]*#.**$' > /System/Devices/null \
+      || expr "$line" : '[ \t]*[^)]*)[ \t]*;;[ \t]*$' > /System/Devices/null \
+      || expr "$line" : '[ \t]*[^)]*)[ \t]*;;*[ \t]*#.*$' > /System/Devices/null
   then
     return 0
   fi
@@ -519,7 +519,7 @@
 
 function _cleanup
 {
-  rm -f $__debug $_potbelliedpig 2> /dev/null
+  rm -f $__debug $_potbelliedpig 2> /System/Devices/null
 }
 
 function _menu
@@ -564,7 +564,7 @@
 let _i=1
 
 # Be careful about quoted newlines
-_potbelliedpig=${TMPDIR-/tmp}/$_guineapig.$$
+_potbelliedpig=${TMPDIR-/System/TemporaryFiles}/$_guineapig.$$
 sed 's,\\$,\\\\,' $_guineapig > $_potbelliedpig
 
 _msg "Reading source from file: $_guineapig"
@@ -574,7 +574,7 @@
 done < $_potbelliedpig
 
 trap _cleanup EXIT
-# Assuming a real script will have the "#! /bin/sh" at line 1,
+# Assuming a real script will have the "#! /System/Tools/sh" at line 1,
 # don't stop at line 1 on the first run
 let _steps=1
 LINENO=-1
diff -urN bash-3.0/examples/complete/complete-examples bash-3.0-STEP/examples/complete/complete-examples
--- bash-3.0/examples/complete/complete-examples	2002-03-14 02:41:54.000000000 +1300
+++ bash-3.0-STEP/examples/complete/complete-examples	2005-08-25 00:34:10.292532680 +1200
@@ -429,7 +429,7 @@
 
 	# if we don't want to use *.mk, we can take out the cat and use
 	# test -f $makef and input redirection	
-	COMPREPLY=( $(cat $makef 2>/dev/null | awk 'BEGIN {FS=":"} /^[^.# 	][^=]*:/ {print $1}' | tr -s ' ' '\012' | sort -u | eval $gcmd ) )
+	COMPREPLY=( $(cat $makef 2>/System/Devices/null | awk 'BEGIN {FS=":"} /^[^.# 	][^=]*:/ {print $1}' | tr -s ' ' '\012' | sort -u | eval $gcmd ) )
 }
 complete -F _make_targets -X '+($*|*.[cho])' make gmake pmake
 
diff -urN bash-3.0/examples/complete/complete.ianmac bash-3.0-STEP/examples/complete/complete.ianmac
--- bash-3.0/examples/complete/complete.ianmac	2000-07-14 01:43:26.000000000 +1200
+++ bash-3.0-STEP/examples/complete/complete.ianmac	2005-08-25 00:47:07.382397064 +1200
@@ -101,7 +101,7 @@
 			group=${cur#*.}
 			COMPREPLY=( $( awk 'BEGIN {FS=":"} \
 					{if ($1 ~ /^'$group'/) print $1}' \
-					/etc/group ) )
+					/System/Settings/group ) )
 			for (( i=0; i < ${#COMPREPLY[@]}; i++ )); do
 				COMPREPLY[i]=$user.${COMPREPLY[i]}
 			done
@@ -138,7 +138,7 @@
 complete -F _umount umount
 
 # GID completion. This will get a list of all valid group names from
-# /etc/group and should work anywhere.
+# /System/Settings/group and should work anywhere.
 #
 _gid_func ()
 {
@@ -147,13 +147,13 @@
         COMPREPLY=()
         cur=${COMP_WORDS[COMP_CWORD]}
 	COMPREPLY=( $( awk 'BEGIN {FS=":"} {if ($1 ~ /^'$cur'/) print $1}' \
-			   /etc/group ) )
+			   /System/Settings/group ) )
 	return 0
 }
 complete -F _gid_func groupdel groupmod
 
 # mount(8) completion. This will pull a list of possible mounts out of
-# /etc/fstab, unless the word being completed contains a ':', which
+# /System/Settings/fstab, unless the word being completed contains a ':', which
 # would indicate the specification of an NFS server. In that case, we
 # query the server for a list of all available exports and complete on
 # that instead.
@@ -167,12 +167,12 @@
 
 	case "$cur" in
 	*:*)
-	      COMPREPLY=( $( /usr/sbin/showmount -e --no-headers ${cur%%:*} |\
+	      COMPREPLY=( $( /System/AdminTools/showmount -e --no-headers ${cur%%:*} |\
 			       grep ^${cur#*:} | awk '{print $1}'))
 		return 0
 		;;
 	*)
-		COMPREPLY=( $( awk '{if ($2 ~ /\//) print $2}' /etc/fstab | \
+		COMPREPLY=( $( awk '{if ($2 ~ /\//) print $2}' /System/Settings/fstab | \
 			       grep ^$cur ))
 		return 0
 		;;
@@ -312,17 +312,17 @@
 		;;
 	-fstype)
 		# this is highly non-portable (the option to -d is a tab)
-		COMPREPLY=( $( cut -d'	' -f 2 /proc/filesystems | grep ^$cur ) )
+		COMPREPLY=( $( cut -d'	' -f 2 /System/Processes/filesystems | grep ^$cur ) )
 		return 0
 		;;
 	-gid)
 		COMPREPLY=( $( awk 'BEGIN {FS=":"} \
-				{if ($3 ~ /^'$cur'/) print $3}' /etc/group ) )
+				{if ($3 ~ /^'$cur'/) print $3}' /System/Settings/group ) )
 		return 0
 		;;
 	-group)
 		COMPREPLY=( $( awk 'BEGIN {FS=":"} \
-				{if ($1 ~ /^'$cur'/) print $1}' /etc/group ) )
+				{if ($1 ~ /^'$cur'/) print $1}' /System/Settings/group ) )
 		return 0
 		;;
 	-?(x)type)
@@ -331,7 +331,7 @@
 		;;
 	-uid)
 		COMPREPLY=( $( awk 'BEGIN {FS=":"} \
-				{if ($3 ~ /^'$cur'/) print $3}' /etc/passwd ) )
+				{if ($3 ~ /^'$cur'/) print $3}' /System/Settings/passwd ) )
 		return 0
 		;;
 	-user)
diff -urN bash-3.0/examples/complete/complete2.ianmac bash-3.0-STEP/examples/complete/complete2.ianmac
--- bash-3.0/examples/complete/complete2.ianmac	2000-08-15 01:44:59.000000000 +1200
+++ bash-3.0-STEP/examples/complete/complete2.ianmac	2005-08-25 00:46:57.491900648 +1200
@@ -257,7 +257,7 @@
 
 	case "$prev" in
 	@([1-6]|--@(list|add|del)))
-		COMPREPLY=( $( compgen -W "`(cd /etc/rc.d/init.d; echo *)`" \
+		COMPREPLY=( $( compgen -W "`(cd /System/Settings/rc.d/init.d; echo *)`" \
 			       $cur) )
 		return 0
 		;;
diff -urN bash-3.0/examples/functions/array-to-string bash-3.0-STEP/examples/functions/array-to-string
--- bash-3.0/examples/functions/array-to-string	2000-11-22 05:56:16.000000000 +1300
+++ bash-3.0-STEP/examples/functions/array-to-string	2005-08-25 00:33:16.812662856 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 
 # Format: array_to_string vname_of_array vname_of_string separator
 array_to_string()
diff -urN bash-3.0/examples/functions/coproc.bash bash-3.0-STEP/examples/functions/coproc.bash
--- bash-3.0/examples/functions/coproc.bash	2002-08-02 06:19:55.000000000 +1200
+++ bash-3.0-STEP/examples/functions/coproc.bash	2005-08-25 00:47:14.965244296 +1200
@@ -36,9 +36,9 @@
       #
       o|op|ope|open)
 	shift
-	local fifo="/var/tmp/coprocess.$$.$RANDOM"
+	local fifo="/System/ApplicationData/TemporaryFiles/coprocess.$$.$RANDOM"
 
-	local cmd="/bin/bash"
+	local cmd="/System/Tools/bash"
 	if (( $# > 0 )) ; then
 	  cmd="$@"
 	fi
diff -urN bash-3.0/examples/functions/coshell.README bash-3.0-STEP/examples/functions/coshell.README
--- bash-3.0/examples/functions/coshell.README	2001-09-25 06:27:29.000000000 +1200
+++ bash-3.0-STEP/examples/functions/coshell.README	2005-08-25 00:47:17.503858368 +1200
@@ -31,11 +31,11 @@
 coshell open ssh -l root otherbox
 coshell eval hostname
 coshell ls -l
-if coshell test -d /tmp ; then echo 'otherbox has a /tmp!' ; fi
+if coshell test -d /System/TemporaryFiles ; then echo 'otherbox has a /System/TemporaryFiles!' ; fi
 
-coshell sendfile /var/lib/upgrade.rpm /tmp/test.rpm || exit $?
-coshell eval rpm -ivh /tmp/test.rpm || exit $?
-coshell eval rm -f /tmp/test.rpm || exit $?
+coshell sendfile /var/lib/upgrade.rpm /System/TemporaryFiles/test.rpm || exit $?
+coshell eval rpm -ivh /System/TemporaryFiles/test.rpm || exit $?
+coshell eval rm -f /System/TemporaryFiles/test.rpm || exit $?
 coshell close
 exit 0
 
@@ -44,7 +44,7 @@
 
 - Shell quoting issue with 'coshell eval' commands - need to somehow
   re-quote words.
-- Interactive commands hang 'coshell eval', tried redirecting in </dev/null
+- Interactive commands hang 'coshell eval', tried redirecting in </System/Devices/null
   to executed command, but it caused strange shell exit problems.
 - Some way to copy stdin from local coshell eval to remote shell.  Probably
   logically impossible, but would be wonderfully useful.
diff -urN bash-3.0/examples/functions/coshell.bash bash-3.0-STEP/examples/functions/coshell.bash
--- bash-3.0/examples/functions/coshell.bash	2001-09-25 06:24:41.000000000 +1200
+++ bash-3.0-STEP/examples/functions/coshell.bash	2005-08-25 00:34:10.302531160 +1200
@@ -16,7 +16,7 @@
 	local ret=$?
 
 	# This should eat any ssh error messages or what not.
-	coshell eval : >/dev/null 2>&1
+	coshell eval : >/System/Devices/null 2>&1
 	return $ret
 	;;
 
diff -urN bash-3.0/examples/functions/dirfuncs bash-3.0-STEP/examples/functions/dirfuncs
--- bash-3.0/examples/functions/dirfuncs	1994-07-22 04:11:22.000000000 +1200
+++ bash-3.0-STEP/examples/functions/dirfuncs	2005-08-25 00:34:10.305530704 +1200
@@ -79,7 +79,7 @@
     ~*) dir=$HOME${dir#\~} ;;
     esac
 
-    cd2 ${dir:-$@} > /dev/null || return 1
+    cd2 ${dir:-$@} > /System/Devices/null || return 1
     dir=${OLDPWD#$HOME/}
     case $dir in
     $HOME)	dir=\~ ;;
diff -urN bash-3.0/examples/functions/emptydir bash-3.0-STEP/examples/functions/emptydir
--- bash-3.0/examples/functions/emptydir	2000-11-22 05:35:16.000000000 +1300
+++ bash-3.0-STEP/examples/functions/emptydir	2005-08-25 00:33:16.818661944 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 #Derived from:
 #
diff -urN bash-3.0/examples/functions/exitstat bash-3.0-STEP/examples/functions/exitstat
--- bash-3.0/examples/functions/exitstat	2002-08-02 06:20:24.000000000 +1200
+++ bash-3.0-STEP/examples/functions/exitstat	2005-08-25 00:34:10.308530248 +1200
@@ -11,7 +11,7 @@
     if [ ${status} -ne 0 ] && [ ${status} != 128 ]; then
        # If process exited by a signal, determine name of signal.
        if [ ${status} -gt 128 ]; then
-          signal="$(builtin kill -l $((${status} - 128)) 2>/dev/null)"
+          signal="$(builtin kill -l $((${status} - 128)) 2>/System/Devices/null)"
 	  if [ "$signal" ]; then signal="($signal)"; fi
        fi
        echo "[Exit ${status} ${signal}]" 1>&2
diff -urN bash-3.0/examples/functions/gethtml bash-3.0-STEP/examples/functions/gethtml
--- bash-3.0/examples/functions/gethtml	2001-01-18 07:09:59.000000000 +1300
+++ bash-3.0-STEP/examples/functions/gethtml	2005-08-25 00:34:10.311529792 +1200
@@ -18,7 +18,7 @@
 	host="$1"
 	port="${3:-80}"
 
-        exec 3<> /dev/tcp/$host/$port || {
+        exec 3<> /System/Devices/tcp/$host/$port || {
 		echo "$FUNCNAME: $host/$port: cannot connect" >&2
 		exit 1
 	}
diff -urN bash-3.0/examples/functions/getoptx.bash bash-3.0-STEP/examples/functions/getoptx.bash
--- bash-3.0/examples/functions/getoptx.bash	2002-08-02 06:20:45.000000000 +1200
+++ bash-3.0-STEP/examples/functions/getoptx.bash	2005-08-25 00:33:16.831659968 +1200
@@ -13,7 +13,7 @@
 
 #*** file getopt.sh ***
 
-#! /bin/bash
+#! /System/Tools/bash
 #
 # getopt.sh:
 # functions like getopts but do long-named options parsing
@@ -246,7 +246,7 @@
 
 #*** file getopt1 ***
 
-#! /bin/bash
+#! /System/Tools/bash
 # getopt1:
 # Sample script using the function getopt
 #
@@ -274,7 +274,7 @@
 #
 #*** file getopt2 ***
 #
-#! /bin/bash
+#! /System/Tools/bash
 # getopt2:
 # Sample script using the function getoptex
 #
diff -urN bash-3.0/examples/functions/keep bash-3.0-STEP/examples/functions/keep
--- bash-3.0/examples/functions/keep	1995-05-20 06:41:34.000000000 +1200
+++ bash-3.0-STEP/examples/functions/keep	2005-08-25 00:34:10.316529032 +1200
@@ -21,9 +21,9 @@
 
 	# set up an alias for the kept program
 	if [ $# = 1 ]; then
-		alias "$pn=fg $1 2>/dev/null || $1"
+		alias "$pn=fg $1 2>/System/Devices/null || $1"
 	else
-		alias "$1=fg $2 2>/dev/null || $2"
+		alias "$1=fg $2 2>/System/Devices/null || $2"
 	fi
 }
 
@@ -56,7 +56,7 @@
 
 
 # some things that should be kept
-#keep /usr/local/bin/emacs
-#keep e ${EDITOR:-/usr/local/bin/emacs}
-#keep edit ${EDITOR:-/usr/local/bin/emacs}
-#keep /usr/local/bin/emm
+#keep /usr/local/System/Tools/emacs
+#keep e ${EDITOR:-/usr/local/System/Tools/emacs}
+#keep edit ${EDITOR:-/usr/local/System/Tools/emacs}
+#keep /usr/local/System/Tools/emm
diff -urN bash-3.0/examples/functions/kshenv bash-3.0-STEP/examples/functions/kshenv
--- bash-3.0/examples/functions/kshenv	2002-08-02 06:21:08.000000000 +1200
+++ bash-3.0-STEP/examples/functions/kshenv	2005-08-25 00:34:10.320528424 +1200
@@ -67,7 +67,7 @@
 			if [ -z "$defarg" ]; then
 				builtin type $cmd | sed 1q
 			else
-				if builtin type $defarg -t $cmd | grep 'function$' >/dev/null 2>&1; then
+				if builtin type $defarg -t $cmd | grep 'function$' >/System/Devices/null 2>&1; then
 					# HAIRY awk script to suppress
 					# printing of function body -- could
 					# do it with sed, but I don't have
diff -urN bash-3.0/examples/functions/lowercase bash-3.0-STEP/examples/functions/lowercase
--- bash-3.0/examples/functions/lowercase	2000-04-18 08:55:21.000000000 +1200
+++ bash-3.0-STEP/examples/functions/lowercase	2005-08-25 00:33:16.845657840 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from
 # @(#) lowercase.ksh 1.0 92/10/08
diff -urN bash-3.0/examples/functions/manpage bash-3.0-STEP/examples/functions/manpage
--- bash-3.0/examples/functions/manpage	2002-12-01 11:24:47.000000000 +1300
+++ bash-3.0-STEP/examples/functions/manpage	2005-08-25 00:47:17.513856848 +1200
@@ -43,9 +43,9 @@
       if [ "$printing" != "" ]; then
         (cd "$i"; eval "$cmd") < "$file" | ${PAGER:-more}
       else
-        (cd "$i"; eval "$cmd") < "$file" > /tmp/manpage-$$
-        ${PAGER:-more} /tmp/manpage-$$
-        rm -f /tmp/manpage-$$
+        (cd "$i"; eval "$cmd") < "$file" > /System/TemporaryFiles/manpage-$$
+        ${PAGER:-more} /System/TemporaryFiles/manpage-$$
+        rm -f /System/TemporaryFiles/manpage-$$
       fi
       break
     fi
diff -urN bash-3.0/examples/functions/mhfold bash-3.0-STEP/examples/functions/mhfold
--- bash-3.0/examples/functions/mhfold	2002-04-05 03:24:06.000000000 +1200
+++ bash-3.0-STEP/examples/functions/mhfold	2005-08-25 00:47:17.520855784 +1200
@@ -8,9 +8,9 @@
 mhfold()
 {
 	list=`folders | awk '{if (1 < NR) print $1}'`
-	/bin/ls -lag ~/Mail > /tmp/fold$$
+	/System/Tools/ls -lag ~/Mail > /System/TemporaryFiles/fold$$
 	for i in $list; do
-		grep $i /tmp/fold$$
+		grep $i /System/TemporaryFiles/fold$$
 	done
-	/bin/rm -f /tmp/fold$$
+	/System/Tools/rm -f /System/TemporaryFiles/fold$$
 }
diff -urN bash-3.0/examples/functions/notify.bash bash-3.0-STEP/examples/functions/notify.bash
--- bash-3.0/examples/functions/notify.bash	1992-07-04 07:21:16.000000000 +1200
+++ bash-3.0-STEP/examples/functions/notify.bash	2005-08-25 00:34:10.323527968 +1200
@@ -25,7 +25,7 @@
 			j=$(jobs -n %$i)
 			if [ -n "$j" ]; then
 				echo "$j"
-				jobs -n %$i >/dev/null
+				jobs -n %$i >/System/Devices/null
 			else
 				newlist="newlist $i"
 			fi
diff -urN bash-3.0/examples/functions/pathfuncs bash-3.0-STEP/examples/functions/pathfuncs
--- bash-3.0/examples/functions/pathfuncs	1999-04-08 05:58:31.000000000 +1200
+++ bash-3.0-STEP/examples/functions/pathfuncs	2005-08-25 00:46:57.497899736 +1200
@@ -8,11 +8,11 @@
 #	add_path.sh - add dir to path
 #
 # DESCRIPTION:
-#	These functions originated in /etc/profile and ksh.kshrc, but
+#	These functions originated in /System/Settings/profile and ksh.kshrc, but
 #	are more useful in a separate file.
 #
 # SEE ALSO:
-#	/etc/profile
+#	/System/Settings/profile
 #
 # AUTHOR:
 #	Simon J. Gerraty <sjg@zen.void.oz.au>
diff -urN bash-3.0/examples/functions/recurse bash-3.0-STEP/examples/functions/recurse
--- bash-3.0/examples/functions/recurse	2002-08-02 06:21:52.000000000 +1200
+++ bash-3.0-STEP/examples/functions/recurse	2005-08-25 00:33:16.853656624 +1200
@@ -1,4 +1,4 @@
-#!/bin/bash
+#!/System/Tools/bash
 
 #From: kaz@ashi.footprints.net (Kaz Kylheku)
 #Newsgroups: comp.os.linux.misc
diff -urN bash-3.0/examples/functions/whatis bash-3.0-STEP/examples/functions/whatis
--- bash-3.0/examples/functions/whatis	1994-03-03 09:28:52.000000000 +1300
+++ bash-3.0-STEP/examples/functions/whatis	2005-08-25 00:34:10.326527512 +1200
@@ -22,7 +22,7 @@
 
 	for arg
 	do
-		case $(builtin type -type $arg 2>/dev/null) in
+		case $(builtin type -type $arg 2>/System/Devices/null) in
 		"alias")
 			builtin alias "$arg"
 			;;
diff -urN bash-3.0/examples/functions/which bash-3.0-STEP/examples/functions/which
--- bash-3.0/examples/functions/which	1999-04-07 05:07:06.000000000 +1200
+++ bash-3.0-STEP/examples/functions/which	2005-08-25 00:34:10.328527208 +1200
@@ -33,7 +33,7 @@
 		esac
 
 		if [ -n "$sflag" ]; then
-			builtin type -p $a $command >/dev/null 2>&1
+			builtin type -p $a $command >/System/Devices/null 2>&1
 		else
 			builtin type -p $a $command
 		fi
diff -urN bash-3.0/examples/functions/xfind.bash bash-3.0-STEP/examples/functions/xfind.bash
--- bash-3.0/examples/functions/xfind.bash	2002-08-02 06:23:25.000000000 +1200
+++ bash-3.0-STEP/examples/functions/xfind.bash	2005-08-25 00:33:16.856656168 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #From: kaz@cafe.net (Kaz Kylheku)
 #Newsgroups: comp.unix.shell
 #Subject: Why not roll your own @#$% find! (was: splitting directory off from filename)
diff -urN bash-3.0/examples/loadables/finfo.c bash-3.0-STEP/examples/loadables/finfo.c
--- bash-3.0/examples/loadables/finfo.c	2004-01-01 08:40:18.000000000 +1300
+++ bash-3.0-STEP/examples/loadables/finfo.c	2005-08-25 00:34:10.758461848 +1200
@@ -133,7 +133,7 @@
 	int	fd, r;
 	intmax_t lfd;
 
-	if (strncmp(f, "/dev/fd/", 8) == 0) {
+	if (strncmp(f, "/System/Devices/fd/", 8) == 0) {
 		if ((legal_number(f + 8, &lfd) == 0) || (int)lfd != lfd) {
 			builtin_error("%s: invalid fd", f + 8);
 			return ((struct stat *)0);
@@ -378,7 +378,7 @@
   "Display information about each FILE.  Only single operators should",
   "be supplied.  If no options are supplied, a summary of the info",
   "available about each FILE is printed.  If FILE is of the form",
-  "/dev/fd/XX, file descriptor XX is described.  Operators, if supplied,",
+  "/System/Devices/fd/XX, file descriptor XX is described.  Operators, if supplied,",
   "have the following meanings:",
   "",
   "	-a	last file access time",
diff -urN bash-3.0/examples/misc/aliasconv.bash bash-3.0-STEP/examples/misc/aliasconv.bash
--- bash-3.0/examples/misc/aliasconv.bash	2002-12-01 11:20:24.000000000 +1300
+++ bash-3.0-STEP/examples/misc/aliasconv.bash	2005-08-25 00:47:18.053774768 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # aliasconv.bash - convert csh aliases to bash aliases and functions
 #
@@ -7,11 +7,11 @@
 # Chet Ramey
 # chet@po.cwru.edu
 #
-trap 'rm -f /tmp/cb$$.?' 0 1 2 3 6 15
+trap 'rm -f /System/TemporaryFiles/cb$$.?' 0 1 2 3 6 15
 
 T=$'\t'
 
-cat << \EOF >/tmp/cb$$.1
+cat << \EOF >/System/TemporaryFiles/cb$$.1
 mkalias ()
 {
 	case $2 in
@@ -31,9 +31,9 @@
 # since they whole thing is going to be surrounded by single quotes when
 # passed to mkalias
 
-sed -e "s:':\\'\\\'\\':" -e "s/^\([a-zA-Z0-9_-]*\)$T\(.*\)$/mkalias \1 '\2'/" >>/tmp/cb$$.1
+sed -e "s:':\\'\\\'\\':" -e "s/^\([a-zA-Z0-9_-]*\)$T\(.*\)$/mkalias \1 '\2'/" >>/System/TemporaryFiles/cb$$.1
 
-$BASH /tmp/cb$$.1 | sed -e 's/\$cwd/\$PWD/g' \
+$BASH /System/TemporaryFiles/cb$$.1 | sed -e 's/\$cwd/\$PWD/g' \
 		     -e 's/\$term/\$TERM/g' \
 		     -e 's/\$home/\$HOME/g' \
 		     -e 's/\$user/\$USER/g' \
diff -urN bash-3.0/examples/misc/aliasconv.sh bash-3.0-STEP/examples/misc/aliasconv.sh
--- bash-3.0/examples/misc/aliasconv.sh	2002-12-01 11:20:23.000000000 +1300
+++ bash-3.0-STEP/examples/misc/aliasconv.sh	2005-08-25 00:47:18.042776440 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # aliasconv.sh - convert csh aliases to bash aliases and functions
 #
@@ -7,11 +7,11 @@
 # Chet Ramey
 # chet@po.cwru.edu
 #
-trap 'rm -f /tmp/cb$$.?' 0 1 2 3 6 15
+trap 'rm -f /System/TemporaryFiles/cb$$.?' 0 1 2 3 6 15
 
 T='	'
 
-cat << \EOF >/tmp/cb$$.1
+cat << \EOF >/System/TemporaryFiles/cb$$.1
 mkalias ()
 {
 	case $2 in
@@ -31,9 +31,9 @@
 # since they whole thing is going to be surrounded by single quotes when
 # passed to mkalias
 
-sed -e "s:':\\'\\\'\\':" -e "s/^\([a-zA-Z0-9_-]*\)$T\(.*\)$/mkalias \1 '\2'/" >>/tmp/cb$$.1
+sed -e "s:':\\'\\\'\\':" -e "s/^\([a-zA-Z0-9_-]*\)$T\(.*\)$/mkalias \1 '\2'/" >>/System/TemporaryFiles/cb$$.1
 
-sh /tmp/cb$$.1 | sed -e 's/\$cwd/\$PWD/g' \
+sh /System/TemporaryFiles/cb$$.1 | sed -e 's/\$cwd/\$PWD/g' \
 		     -e 's/\$term/\$TERM/g' \
 		     -e 's/\$home/\$HOME/g' \
 		     -e 's/\$user/\$USER/g' \
diff -urN bash-3.0/examples/misc/cshtobash bash-3.0-STEP/examples/misc/cshtobash
--- bash-3.0/examples/misc/cshtobash	2002-12-01 11:23:41.000000000 +1300
+++ bash-3.0-STEP/examples/misc/cshtobash	2005-08-25 00:47:18.087769600 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # cshtobash - convert csh aliases, environment variables, and variables to
 #	      bash equivalents
@@ -15,7 +15,7 @@
 # Chet Ramey
 # chet@po.cwru.edu
 #
-trap 'rm -f /tmp/cb$$.? cshout cshin' 0 1 2 3 6 15
+trap 'rm -f /System/TemporaryFiles/cb$$.? cshout cshin' 0 1 2 3 6 15
 
 T=$'\t'
 
@@ -23,17 +23,17 @@
 
 cat << EOF >cshin
 $SOURCE
-alias >! /tmp/cb$$.a
-setenv >! /tmp/cb$$.e
-set >! /tmp/cb$$.v
+alias >! /System/TemporaryFiles/cb$$.a
+setenv >! /System/TemporaryFiles/cb$$.e
+set >! /System/TemporaryFiles/cb$$.v
 EOF
 
 # give csh a minimal environment, similar to what login would provide
-/usr/bin/env - USER=$USER HOME=$HOME PATH=/usr/bin:/bin:/usr/ucb:. TERM=$TERM SHELL=$SHELL /bin/csh -i < ./cshin > cshout 2>&1
+/System/Tools/env - USER=$USER HOME=$HOME PATH=/System/Tools:/bin:/usr/ucb:. TERM=$TERM SHELL=$SHELL /System/Tools/csh -i < ./cshin > cshout 2>&1
 
 # First convert aliases
 
-cat << \EOF >/tmp/cb$$.1
+cat << \EOF >/System/TemporaryFiles/cb$$.1
 mkalias ()
 {
 	case $2 in
@@ -49,12 +49,12 @@
 }
 EOF
 
-sed "s/^\([a-zA-Z0-9_]*\)$T\(.*\)$/mkalias \1 '\2'/" < /tmp/cb$$.a >>/tmp/cb$$.1
+sed "s/^\([a-zA-Z0-9_]*\)$T\(.*\)$/mkalias \1 '\2'/" < /System/TemporaryFiles/cb$$.a >>/System/TemporaryFiles/cb$$.1
 
 echo '# csh aliases'
 echo
 
-$BASH /tmp/cb$$.1 | sed -e 's/\$cwd/\$PWD/g' \
+$BASH /System/TemporaryFiles/cb$$.1 | sed -e 's/\$cwd/\$PWD/g' \
 		   -e 's/\$term/\$TERM/g' \
 		   -e 's/\$home/\$HOME/g' \
 		   -e 's/\$user/\$USER/g' \
@@ -70,7 +70,7 @@
     -e '/^PWD/d' \
     -e "s/'/'"\\\\"''"/g \
     -e "s/^\([A-Za-z0-9_]*=\)/export \1'/" \
-    -e "s/$/'/" < /tmp/cb$$.e
+    -e "s/$/'/" < /System/TemporaryFiles/cb$$.e
 
 # Finally, convert local variables
 echo
@@ -82,7 +82,7 @@
     -e '/^[A-Za-z0-9_]*=[^(]/{
 	s/=/='"'/"'
 	s/$/'"'/"'
-	}' < /tmp/cb$$.v |
+	}' < /System/TemporaryFiles/cb$$.v |
 sed -e '/^argv=/d' -e '/^cwd=/d' -e '/^filec=/d' -e '/^status=/d' \
 	 -e '/^verbose=/d' \
 	 -e '/^term=/d' \
@@ -110,7 +110,7 @@
 echo '# special csh variables converted to bash equivalents'
 echo
 
-sed -e 's/'"$T"'/=/' < /tmp/cb$$.v |
+sed -e 's/'"$T"'/=/' < /System/TemporaryFiles/cb$$.v |
 grep "^cdpath=" |
 sed 's/(//
      s/ /:/g
@@ -118,7 +118,7 @@
      s/cdpath=/CDPATH=/'
 
 
-sed -e 's/'"$T"'/=/' < /tmp/cb$$.v |
+sed -e 's/'"$T"'/=/' < /System/TemporaryFiles/cb$$.v |
 grep "^mail=" |
 sed 's/(//
      s/ /:/g
diff -urN bash-3.0/examples/misc/suncmd.termcap bash-3.0-STEP/examples/misc/suncmd.termcap
--- bash-3.0/examples/misc/suncmd.termcap	1991-02-28 14:58:42.000000000 +1300
+++ bash-3.0-STEP/examples/misc/suncmd.termcap	2005-08-25 00:46:57.518896544 +1200
@@ -17,7 +17,7 @@
 #screen.
 #
 #The problem with cmdtool, in case that is less than obvious, is that
-#almost none of the capabilities advertised in /etc/termcap are enabled
+#almost none of the capabilities advertised in /System/Settings/termcap are enabled
 #while scrolling is enabled.  It has other problems too, like being
 #part of an outdated proprietary windowing system, but there's probably
 #no need to dwell on that.  In a sense, though, the sun-cmd termcap
diff -urN bash-3.0/examples/obashdb/bashdb bash-3.0-STEP/examples/obashdb/bashdb
--- bash-3.0/examples/obashdb/bashdb	1997-01-18 10:23:12.000000000 +1300
+++ bash-3.0-STEP/examples/obashdb/bashdb	2005-08-25 00:47:17.479862016 +1200
@@ -20,7 +20,7 @@
 }
 shift
 
-_tmpdir=/tmp
+_tmpdir=/System/TemporaryFiles
 _libdir=.
 _dbgfile=$_tmpdir/bashdb$$		#temp file for script being debugged
 
diff -urN bash-3.0/examples/obashdb/bashdb.fns bash-3.0-STEP/examples/obashdb/bashdb.fns
--- bash-3.0/examples/obashdb/bashdb.fns	2002-12-01 11:25:55.000000000 +1300
+++ bash-3.0-STEP/examples/obashdb/bashdb.fns	2005-08-25 00:47:17.489860496 +1200
@@ -88,7 +88,7 @@
 	if [ -z "${_linebp}" ]; then
 		return 1
 	fi
-	echo "${_curline}" | grep -E "(${_linebp%\|})" >/dev/null 2>&1
+	echo "${_curline}" | grep -E "(${_linebp%\|})" >/System/Devices/null 2>&1
 	return $?
 }
 
@@ -101,7 +101,7 @@
 		return 1;
 	fi
 	l=${_lines[$_curline-$_firstline+1]}
-	echo "${l}" | grep -E "\\*(${_stringbp%\|})\\*" >/dev/null 2>&1
+	echo "${l}" | grep -E "\\*(${_stringbp%\|})\\*" >/System/Devices/null 2>&1
 	return $?
 }
 
@@ -201,7 +201,7 @@
 
 # erase temp files before exiting
 _cleanup() {
-	rm $_dbgfile 2>/dev/null
+	rm $_dbgfile 2>/System/Devices/null
 }
 
 
@@ -213,11 +213,11 @@
 
 	SEDCMD="$_firstline,$(($_firstline+$_BUFSIZ))p"
 
-	sed -n "$SEDCMD" $_guineapig > /tmp/_script.$$
+	sed -n "$SEDCMD" $_guineapig > /System/TemporaryFiles/_script.$$
 	while read -r _lines[$_i]; do
 		_i=_i+1
-	done  < /tmp/_script.$$
-	rm -f /tmp/_script.$$ 2>/dev/null
+	done  < /System/TemporaryFiles/_script.$$
+	rm -f /System/TemporaryFiles/_script.$$ 2>/System/Devices/null
 }
 
 _print() {
diff -urN bash-3.0/examples/scripts/adventure.sh bash-3.0-STEP/examples/scripts/adventure.sh
--- bash-3.0/examples/scripts/adventure.sh	2000-06-13 08:49:33.000000000 +1200
+++ bash-3.0-STEP/examples/scripts/adventure.sh	2005-08-25 00:34:10.354523256 +1200
@@ -1,4 +1,4 @@
-#!/bin/bash
+#!/System/Tools/bash
 #	ash -- "Adventure shell"
 #	last edit:	86/04/21	D A Gwyn
 #	SCCS ID:	@(#)ash.sh	1.4
@@ -80,14 +80,14 @@
 	
 MAINT=chet@ins.cwru.edu
 
-PATH=/usr/ucb:/bin:/usr/bin:/usr/local/bin:.
+PATH=/usr/ucb:/bin:/System/Tools:/usr/local/bin:.
 export PATH
 
 trap 'echo Ouch!' 2 3
 #trap '' 18			# disable Berkeley job control
 
 #ash_lk(){ echo " $1 " | fgrep " $2 " >&- 2>&-; }
-ash_lk(){ echo " $1 " | fgrep -q " $2 " >/dev/null 2>&1 ; }
+ash_lk(){ echo " $1 " | fgrep -q " $2 " >/System/Devices/null 2>&1 ; }
 ash_pr(){ echo $* | tr ' ' '\012' | pr -5 -t -w75 -l$[ ( $# + 4 ) / 5 ]; }
 ash_rm(){ echo " $1 " | sed -e "s/ $2 / /" -e 's/^ //' -e 's/ $//'; }
 
@@ -104,7 +104,7 @@
 }
 KNAP=.knapsack			# $HOME/$KNAP contains objects being "carried"
 if [ ! -d $KNAP ]
-then	mkdir $KNAP >/dev/null 2>&1
+then	mkdir $KNAP >/System/Devices/null 2>&1
 	if [ $? = 0 ]
 	then	echo 'You found a discarded empty knapsack.'
 	else	echo 'You have no knapsack to carry things in.'
@@ -285,7 +285,7 @@
 				for it in $obj $x
 				do	if ash_lk "$obs $hobs $exs $hexs" "$it"
 					then	echo "Upon close inspection of the $it, you see:"
-						ls -ld $it 2>/dev/null
+						ls -ld $it 2>/System/Devices/null
 						if [ $? != 0 ]
 						then	echo "-- when you look directly at the $it, it vanishes."
 						fi
@@ -304,7 +304,7 @@
 					case "$1" in
 					to)	if [ "$2" ]
 						then	shift
-							if PATH=$OPATH $* <$obj 2>/dev/null
+							if PATH=$OPATH $* <$obj 2>/System/Devices/null
 							then	echo "The $1 monster devours your $obj."
 								if rm -f $obj # >&- 2>&-
 								then	obs=`ash_rm "$obs" "$obj"`
@@ -478,7 +478,7 @@
 					case "$1" in
 					from)	if [ "$2" ]
 						then	shift
-							if PATH=$OPATH $* >$obj 2>/dev/null
+							if PATH=$OPATH $* >$obj 2>/System/Devices/null
 							then	echo "The $1 monster drops the $obj."
 								obs=`echo $obj $obs`
 							else	echo "The $1 monster runs away as you approach."
diff -urN bash-3.0/examples/scripts/bcsh.sh bash-3.0-STEP/examples/scripts/bcsh.sh
--- bash-3.0/examples/scripts/bcsh.sh	2002-08-02 06:32:15.000000000 +1200
+++ bash-3.0-STEP/examples/scripts/bcsh.sh	2005-08-25 00:47:17.974786776 +1200
@@ -243,7 +243,7 @@
 #	will have to re-set the values of '$n' and '$c'.
 #
 #	This program may run out of stack space on a 16-bit machine where
-#	/bin/sh is not split-space.
+#	/System/Tools/sh is not split-space.
 #
 #	Mail checking is done every 10 commands if $MAIL is set in your
 #	environment.  For anything fancier, you will have to hack the code.
@@ -317,7 +317,7 @@
 
 # the alias file may contain 1 blank line, so a test -s will not work
 
-case "`cat $aliasfile 2> /dev/null`" in
+case "`cat $aliasfile 2> /System/Devices/null`" in
 	"")
 		doalias=no
 		;;
@@ -350,7 +350,7 @@
 		cp $ohist $histfile
 	fi
 else
-	cat /dev/null > $histfile
+	cat /System/Devices/null > $histfile
 	cmdno=1
 	lastcmd=
 fi
@@ -389,8 +389,8 @@
 
 trap ':' 2
 trap exit 3
-trap "tail -n $savehist $histfile>/tmp/hist$$;uniq /tmp/hist$$ > $histfile;\
-rm -f /tmp/*$$;exit 0" 15
+trap "tail -n $savehist $histfile>/System/TemporaryFiles/hist$$;uniq /System/TemporaryFiles/hist$$ > $histfile;\
+rm -f /System/TemporaryFiles/*$$;exit 0" 15
 
 getcmd=yes
 mailcheck=
@@ -490,8 +490,8 @@
 			read line
 			cmd="${cmd};$line"
 		done
-		echo "$cmd" > /tmp/bcsh$$
-		ed - /tmp/bcsh$$ << ++++
+		echo "$cmd" > /System/TemporaryFiles/bcsh$$
+		ed - /System/TemporaryFiles/bcsh$$ << ++++
 		s/end/done/
 		s/foreach[ 	]\(.*\)(/for \1 in /
 		s/)//
@@ -528,7 +528,7 @@
 			esac
 			cmd="${cmd};$line"
 		done
-		echo "$cmd" > /tmp/bcsh$$
+		echo "$cmd" > /System/TemporaryFiles/bcsh$$
 		;;
 	if[\ \	]*)
 		while test "$line" != "fi" && test "$line" != "endif"
@@ -545,12 +545,12 @@
 			esac
 			cmd="${cmd};$line"
 		done
-		echo "$cmd" > /tmp/bcsh$$
-		case "`grep then /tmp/bcsh$$`" in
+		echo "$cmd" > /System/TemporaryFiles/bcsh$$
+		case "`grep then /System/TemporaryFiles/bcsh$$`" in
 		"")
 			# fix 'if foo bar' cases
 
-			ed - /tmp/bcsh$$ << ++++
+			ed - /System/TemporaryFiles/bcsh$$ << ++++
 			s/)/);then/
 			s/.*/;fi/
 			w
@@ -566,7 +566,7 @@
 			cmd="${cmd}@$line"
 		done
 		cmd="`echo \"$cmd\" | tr '@' ' '`"
-		echo "$cmd" > /tmp/bcsh$$
+		echo "$cmd" > /System/TemporaryFiles/bcsh$$
 		;;
 	switch[\ \	]*)
 		while test "$line" != "endsw"
@@ -575,8 +575,8 @@
 			read line
 			cmd="${cmd}@$line"
 		done
-		echo "$cmd" > /tmp/bcsh$$
-		ed - /tmp/bcsh$$ << '++++'
+		echo "$cmd" > /System/TemporaryFiles/bcsh$$
+		ed - /System/TemporaryFiles/bcsh$$ << '++++'
 		1,$s/@/\
 /g
 		g/switch.*(/s//case "/
@@ -591,7 +591,7 @@
 	*)/
 		w
 ++++
-		cmd="`cat /tmp/bcsh$$`"
+		cmd="`cat /System/TemporaryFiles/bcsh$$`"
 		;;
 	*!*)
 		hist=yes
@@ -902,33 +902,33 @@
 		continue
 		;;
 	*~e)
-		echo "$cmd" | sed -e "s@~e@@" > /tmp/bcsh$$
-		$EDITOR /tmp/bcsh$$
-		cmd="`cat /tmp/bcsh$$`"
+		echo "$cmd" | sed -e "s@~e@@" > /System/TemporaryFiles/bcsh$$
+		$EDITOR /System/TemporaryFiles/bcsh$$
+		cmd="`cat /System/TemporaryFiles/bcsh$$`"
 		getcmd=no
 		continue
 		;;
 	*~v)
-		echo "$cmd" | sed -e "s@~v@@" > /tmp/bcsh$$
-		echo "$lastcmd" > /tmp/bcsh$$
-		$VISUAL /tmp/bcsh$$
-		cmd="`cat /tmp/bcsh$$`"
+		echo "$cmd" | sed -e "s@~v@@" > /System/TemporaryFiles/bcsh$$
+		echo "$lastcmd" > /System/TemporaryFiles/bcsh$$
+		$VISUAL /System/TemporaryFiles/bcsh$$
+		cmd="`cat /System/TemporaryFiles/bcsh$$`"
 		getcmd=no
 		continue
 		;;
 	exec[\ \	]*)
-		tail -n $savehist $histfile>/tmp/hist$$
-		uniq /tmp/hist$$ > $histfile
-		rm -f /tmp/*$$
-		echo $cmd > /tmp/cmd$$
-		. /tmp/cmd$$
+		tail -n $savehist $histfile>/System/TemporaryFiles/hist$$
+		uniq /System/TemporaryFiles/hist$$ > $histfile
+		rm -f /System/TemporaryFiles/*$$
+		echo $cmd > /System/TemporaryFiles/cmd$$
+		. /System/TemporaryFiles/cmd$$
 		;;
 	login[\ \	]*|newgrp[\ \	]*)
-		tail -n $savehist $histfile>/tmp/hist$$
-		uniq /tmp/hist$$ > $histfile
-		rm -f /tmp/*$$
-		echo $cmd > /tmp/cmd$$
-		. /tmp/cmd$$
+		tail -n $savehist $histfile>/System/TemporaryFiles/hist$$
+		uniq /System/TemporaryFiles/hist$$ > $histfile
+		rm -f /System/TemporaryFiles/*$$
+		echo $cmd > /System/TemporaryFiles/cmd$$
+		. /System/TemporaryFiles/cmd$$
 		;;
 	logout|exit|bye)
 		if test -s "$logoutfile"
@@ -936,9 +936,9 @@
 			# sh $logoutfile
 			$SHELL $logoutfile
 		fi
-		tail -n $savehist $histfile > /tmp/hist$$
-		uniq /tmp/hist$$ > $histfile
-		rm -f /tmp/*$$
+		tail -n $savehist $histfile > /System/TemporaryFiles/hist$$
+		uniq /System/TemporaryFiles/hist$$ > $histfile
+		rm -f /System/TemporaryFiles/*$$
 		exit 0
 		;;
 	h|history)
@@ -958,8 +958,8 @@
 	source[\ \	]*)
 		set - $cmd
 		shift
-		echo . $*  > /tmp/cmd$$
-		. /tmp/cmd$$
+		echo . $*  > /System/TemporaryFiles/cmd$$
+		. /System/TemporaryFiles/cmd$$
 		run=no
 		;;
 	wait)
@@ -967,8 +967,8 @@
 		run=no
 		;;
 	.[\ \	]*)
-		echo $cmd > /tmp/cmd$$
-		. /tmp/cmd$$
+		echo $cmd > /System/TemporaryFiles/cmd$$
+		. /System/TemporaryFiles/cmd$$
 		run=no
 		;;
 	cd|cd[\ \	]*)
@@ -977,9 +977,9 @@
 		# to replace the try-it-and-see below with a couple of tests,
 		# but it is probably just as fast like this.
 
-		echo $cmd > /tmp/cmd$$
-		if ($SHELL /tmp/cmd$$) ; then
-			. /tmp/cmd$$
+		echo $cmd > /System/TemporaryFiles/cmd$$
+		if ($SHELL /System/TemporaryFiles/cmd$$) ; then
+			. /System/TemporaryFiles/cmd$$
 		fi
 		run=no
 		;;
@@ -987,15 +987,15 @@
 		# these are the only commands I can think of whose syntax
 		# includes an equals sign.  Add others as you find them.
 
-		echo "$cmd" > /tmp/bcsh$$
+		echo "$cmd" > /System/TemporaryFiles/bcsh$$
 		;;
 	setenv*|*=*)
 		# handle setting shell variables, turning cshell syntax to Bourne
 		# syntax -- note all variables must be exported or they will not
 		# be usable in other commands
 
-		echo "$cmd" > /tmp/cmd$$
-		ed - /tmp/cmd$$ << ++++
+		echo "$cmd" > /System/TemporaryFiles/cmd$$
+		ed - /System/TemporaryFiles/cmd$$ << ++++
 		g/^setenv[ 	]/s/[ 	]/@/
 		g/^setenv@/s/[ 	]/=/
 		g/^setenv@/s///
@@ -1005,8 +1005,8 @@
 		s/^/export /
 		w
 ++++
-		. /tmp/cmd$$
-		rm -f /tmp/cmd$$
+		. /System/TemporaryFiles/cmd$$
+		rm -f /System/TemporaryFiles/cmd$$
 		run=no
 		;;
 	unset[\ \	]*|umask[\ \	]*|export[\ \	]*|set[\ \	]*)
@@ -1113,12 +1113,12 @@
 				esac
 				;;
 			*)
-				echo "$cmd" > /tmp/bcsh$$
+				echo "$cmd" > /System/TemporaryFiles/bcsh$$
 				;;
 			esac
 			;;
 		no)
-			echo "$cmd" > /tmp/bcsh$$
+			echo "$cmd" > /System/TemporaryFiles/bcsh$$
 			;;
 		esac
 		;;
@@ -1140,7 +1140,7 @@
 		case "$exclaim" in
 		yes)
 			cmd="`echo \"$cmd\" | sed -e 's@REALEXCLAMATIONMARK@!@g'`"
-			echo "$cmd" > /tmp/bcsh$$
+			echo "$cmd" > /System/TemporaryFiles/bcsh$$
 			;;
 		esac
 		case "$echoit" in
@@ -1154,7 +1154,7 @@
 			yes)
 				case "$cmd" in
 				*\>![\ \	]*)
-					ed - /tmp/bcsh$$ << ++++
+					ed - /System/TemporaryFiles/bcsh$$ << ++++
 					g/>!/s//>/
 					w
 ++++
@@ -1179,13 +1179,13 @@
 								y*)
 									;;
 								*)
-									echo ':' > /tmp/bcsh$$
+									echo ':' > /System/TemporaryFiles/bcsh$$
 									;;
 								esac
 								;;
 							*)
 								echo "${outfile}: file exists"
-								echo ':' > /tmp/bcsh$$
+								echo ':' > /System/TemporaryFiles/bcsh$$
 								;;
 							esac
 						fi
@@ -1197,7 +1197,7 @@
 			*)
 				case "$cmd" in
 				*\>![\ \	]*)
-					ed - /tmp/bcsh$$ << ++++
+					ed - /System/TemporaryFiles/bcsh$$ << ++++
 					g/>!/s//>/g
 					w
 ++++
@@ -1205,7 +1205,7 @@
 				esac
 				;;
 			esac
-			(trap 'exit 1' 2 3; $BASH /tmp/bcsh$$)
+			(trap 'exit 1' 2 3; $BASH /System/TemporaryFiles/bcsh$$)
 			;;
 		esac
 		case "$cmd" in
diff -urN bash-3.0/examples/scripts/center bash-3.0-STEP/examples/scripts/center
--- bash-3.0/examples/scripts/center	1999-05-01 07:13:52.000000000 +1200
+++ bash-3.0-STEP/examples/scripts/center	2005-08-25 00:34:10.373520368 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # center - center a group of lines
 #
@@ -10,7 +10,7 @@
 
 if [[ $# == 0 ]]
 then
-	set -- /dev/stdin
+	set -- /System/Devices/stdin
 fi
 
 for file
diff -urN bash-3.0/examples/scripts/dd-ex.sh bash-3.0-STEP/examples/scripts/dd-ex.sh
--- bash-3.0/examples/scripts/dd-ex.sh	2000-09-07 03:45:41.000000000 +1200
+++ bash-3.0-STEP/examples/scripts/dd-ex.sh	2005-08-25 00:47:17.983785408 +1200
@@ -1,16 +1,16 @@
-#!/bin/sh
+#!/System/Tools/sh
 
-# this is a line editor using only /bin/sh, /bin/dd and /bin/rm
+# this is a line editor using only /System/Tools/sh, /System/Tools/dd and /System/Tools/rm
 
-# /bin/rm is not really required, but it is nice to clean up temporary files
+# /System/Tools/rm is not really required, but it is nice to clean up temporary files
 
 PATH=
-dd=/bin/dd
-rm=/bin/rm
+dd=/System/Tools/dd
+rm=/System/Tools/rm
 
 # temporary files we might need
-tmp=/tmp/silly.$$
-ed=/tmp/ed.$$
+tmp=/System/TemporaryFiles/silly.$$
+ed=/System/TemporaryFiles/ed.$$
 trap "$rm -f $tmp $tmp.1 $tmp.2 $tmp.3 $tmp.4 $tmp.5 $tmp.6 $ed.a $ed.b $ed.c; exit" 0 1 2 3
 
 # from now on, no more rm - the above trap is enough
@@ -24,15 +24,15 @@
 Echo () {
 case "$1" in
   -n) shift
-      $dd of=$tmp 2>/dev/null <<EOF 
+      $dd of=$tmp 2>/System/Devices/null <<EOF 
 $@
 EOF
       IFS="+"
-      set `$dd if=$tmp bs=1 of=/dev/null skip=1 2>&1`
+      set `$dd if=$tmp bs=1 of=/System/Devices/null skip=1 2>&1`
       IFS="$saveIFS"
-      $dd if=$tmp bs=1 count=$1 2>/dev/null
+      $dd if=$tmp bs=1 count=$1 2>/System/Devices/null
       ;;
-  *)  $dd 2>/dev/null <<EOF 
+  *)  $dd 2>/System/Devices/null <<EOF 
 $@
 EOF
       ;;
@@ -60,7 +60,7 @@
 	*) go=false ;;
       esac
     done
-  ) 2>/dev/null
+  ) 2>/System/Devices/null
 }
 
 # arithmetic using dd!
@@ -71,19 +71,19 @@
 add () {
   result="$1"
   shift
-  $dd if=/dev/null of=$tmp bs=1 2>/dev/null
+  $dd if=/System/Devices/null of=$tmp bs=1 2>/System/Devices/null
   for n in "$@"
   do
     case "$n" in
       0) ;;
-      *) zero | $dd of=$tmp.1 bs=1 "count=$n" 2>/dev/null
-	 ( $dd if=$tmp; $dd if=$tmp.1 ) 2>/dev/null | $dd of=$tmp.2 2>/dev/null
-	 $dd if=$tmp.2 of=$tmp 2>/dev/null
+      *) zero | $dd of=$tmp.1 bs=1 "count=$n" 2>/System/Devices/null
+	 ( $dd if=$tmp; $dd if=$tmp.1 ) 2>/System/Devices/null | $dd of=$tmp.2 2>/System/Devices/null
+	 $dd if=$tmp.2 of=$tmp 2>/System/Devices/null
 	 ;;
     esac
   done
   IFS="+"
-  set `$dd if=$tmp bs=1 of=/dev/null 2>&1`
+  set `$dd if=$tmp bs=1 of=/System/Devices/null 2>&1`
   IFS="$saveIFS"
   eval $result='$1'
 }
@@ -93,9 +93,9 @@
 
 subtract () {
   result="$1"
-  zero | $dd of=$tmp bs=1 "count=$2" 2>/dev/null
+  zero | $dd of=$tmp bs=1 "count=$2" 2>/System/Devices/null
   IFS="+"
-  set `$dd if=$tmp bs=1 of=/dev/null "skip=$3" 2>&1`
+  set `$dd if=$tmp bs=1 of=/System/Devices/null "skip=$3" 2>&1`
   IFS="$saveIFS"
   case "$1" in
     dd*) set 0 ;;
@@ -108,9 +108,9 @@
 
 multiply () {
   result="$1"
-  zero | $dd "bs=$2" of=$tmp "count=$3" 2>/dev/null
+  zero | $dd "bs=$2" of=$tmp "count=$3" 2>/System/Devices/null
   IFS="+"
-  set `$dd if=$tmp bs=1 of=/dev/null 2>&1`
+  set `$dd if=$tmp bs=1 of=/System/Devices/null 2>&1`
   IFS="$saveIFS"
   eval $result='$1'
 }
@@ -120,9 +120,9 @@
 
 divide () {
   result="$1"
-  zero | $dd bs=1 of=$tmp "count=$2" 2>/dev/null
+  zero | $dd bs=1 of=$tmp "count=$2" 2>/System/Devices/null
   IFS="+"
-  set `$dd if=$tmp "bs=$3" of=/dev/null 2>&1`
+  set `$dd if=$tmp "bs=$3" of=/System/Devices/null 2>&1`
   IFS="$saveIFS"
   eval $result='$1'
 }
@@ -200,7 +200,7 @@
 
 open () {
   file="$1"
-  set `$dd "if=$file" of=/dev/null 2>&1`
+  set `$dd "if=$file" of=/System/Devices/null 2>&1`
   case "$1" in
     dd*) return 1
   esac
@@ -209,16 +209,16 @@
   len=0
   while $go
   do
-    case "`$dd "if=$file" bs=1 skip=$len count=1 2>/dev/null`" in
+    case "`$dd "if=$file" bs=1 skip=$len count=1 2>/System/Devices/null`" in
       ?*) go=true ;;
       *) go=false ;;
     esac
     add len 1 $len
   done
   # now $len is the length of the first line (including newline)
-  $dd "if=$file" bs=1 count=$len of=$ed.c 2>/dev/null
-  $dd "if=$file" bs=1 skip=$len of=$ed.b 2>/dev/null
-  $dd if=/dev/null of=$ed.a 2>/dev/null
+  $dd "if=$file" bs=1 count=$len of=$ed.c 2>/System/Devices/null
+  $dd "if=$file" bs=1 skip=$len of=$ed.b 2>/System/Devices/null
+  $dd if=/System/Devices/null of=$ed.a 2>/System/Devices/null
   lineno=1
 }
 
@@ -226,20 +226,20 @@
 
 save () {
   # make a backup copy of the original
-  $dd "if=$1" "of=$1.bak" 2>/dev/null
+  $dd "if=$1" "of=$1.bak" 2>/System/Devices/null
   # and save
-  ( $dd if=$ed.a; $dd if=$ed.c; $dd if=$ed.b ) > "$1" 2>/dev/null
+  ( $dd if=$ed.a; $dd if=$ed.c; $dd if=$ed.b ) > "$1" 2>/System/Devices/null
 }
 
 # replace n1 n2 bla replaces n2 chars of current line, starting n1-th
 
 replace () {
-  $dd if=$ed.c of=$tmp.1 bs=1 "count=$1" 2>/dev/null
-  ( $dd if=$ed.c "skip=$1" bs=1 | $dd of=$tmp.2 bs=1 "skip=$2" ) 2>/dev/null
+  $dd if=$ed.c of=$tmp.1 bs=1 "count=$1" 2>/System/Devices/null
+  ( $dd if=$ed.c "skip=$1" bs=1 | $dd of=$tmp.2 bs=1 "skip=$2" ) 2>/System/Devices/null
   shift
   shift
-  ( $dd if=$tmp.1; Echo -n "$@"; $dd if=$tmp.2 ) > $tmp.3 2>/dev/null
-  $dd if=$tmp.3 of=$ed.c 2>/dev/null
+  ( $dd if=$tmp.1; Echo -n "$@"; $dd if=$tmp.2 ) > $tmp.3 2>/System/Devices/null
+  $dd if=$tmp.3 of=$ed.c 2>/System/Devices/null
 }
 
 # rstring n s bla
@@ -250,16 +250,16 @@
   shift;
   # first we have to find it - this is fun!
   # we have $tmp.4 => text before string, $tmp.5 => text after
-  $dd if=/dev/null of=$tmp.4 2>/dev/null
-  $dd if=$ed.c of=$tmp.5 2>/dev/null
+  $dd if=/System/Devices/null of=$tmp.4 2>/System/Devices/null
+  $dd if=$ed.c of=$tmp.5 2>/System/Devices/null
   string="$1"
   shift
-  $dd of=$tmp.6 2>/dev/null <<EOF
+  $dd of=$tmp.6 2>/System/Devices/null <<EOF
 $@
 EOF
   while :
   do
-    case "`$dd if=$tmp.5 2>/dev/null`" in
+    case "`$dd if=$tmp.5 2>/System/Devices/null`" in
       $string*)
 	  if lt $n 2
 	  then
@@ -267,29 +267,29 @@
 	    Echo -n "$@" > $tmp.2
 	    Echo -n "$string" > $tmp.1
 	    IFS="+"
-	    set `$dd bs=1 if=$tmp.1 of=/dev/null 2>&1`
+	    set `$dd bs=1 if=$tmp.1 of=/System/Devices/null 2>&1`
 	    IFS="$saveIFS"
 	    slen=$1
 	    IFS="+"
 	    ( $dd if=$tmp.4; $dd if=$tmp.2; $dd if=$tmp.5 bs=1 skip=$slen ) \
-		  2>/dev/null > $tmp
-	    $dd if=$tmp of=$ed.c 2>/dev/null
+		  2>/System/Devices/null > $tmp
+	    $dd if=$tmp of=$ed.c 2>/System/Devices/null
 	    return 0
 	  else
 	    subtract n $n 1
-	    ( $dd if=$tmp.4; $dd if=$tmp.5 bs=1 count=1 ) > $tmp 2>/dev/null
-	    $dd if=$tmp of=$tmp.4 2>/dev/null
+	    ( $dd if=$tmp.4; $dd if=$tmp.5 bs=1 count=1 ) > $tmp 2>/System/Devices/null
+	    $dd if=$tmp of=$tmp.4 2>/System/Devices/null
 	    # and remove it from $tmp.5
-	    $dd if=$tmp.5 of=$tmp bs=1 skip=1 2>/dev/null
-	    $dd if=$tmp of=$tmp.5 2>/dev/null
+	    $dd if=$tmp.5 of=$tmp bs=1 skip=1 2>/System/Devices/null
+	    $dd if=$tmp of=$tmp.5 2>/System/Devices/null
 	  fi
 	  ;;
       ?*) # add one more byte...
-	  ( $dd if=$tmp.4; $dd if=$tmp.5 bs=1 count=1 ) > $tmp 2>/dev/null
-	  $dd if=$tmp of=$tmp.4 2>/dev/null
+	  ( $dd if=$tmp.4; $dd if=$tmp.5 bs=1 count=1 ) > $tmp 2>/System/Devices/null
+	  $dd if=$tmp of=$tmp.4 2>/System/Devices/null
 	  # and remove it from $tmp.5
-	  $dd if=$tmp.5 of=$tmp bs=1 skip=1 2>/dev/null
-	  $dd if=$tmp of=$tmp.5 2>/dev/null
+	  $dd if=$tmp.5 of=$tmp bs=1 skip=1 2>/System/Devices/null
+	  $dd if=$tmp of=$tmp.5 2>/System/Devices/null
 	  ;;
       *)  # not found
 	  return 1
@@ -301,27 +301,27 @@
 # skip to next line
 next () {
   add l $lineno 1
-  ( $dd if=$ed.a; $dd if=$ed.c ) 2>/dev/null > $tmp.3
-  $dd if=$ed.b of=$tmp.4 2>/dev/null
+  ( $dd if=$ed.a; $dd if=$ed.c ) 2>/System/Devices/null > $tmp.3
+  $dd if=$ed.b of=$tmp.4 2>/System/Devices/null
   open $tmp.4
-  $dd if=$tmp.3 of=$ed.a 2>/dev/null
+  $dd if=$tmp.3 of=$ed.a 2>/System/Devices/null
   lineno=$l
 }
 
 # delete current line
 delete () {
   l=$lineno
-  $dd if=$ed.a 2>/dev/null > $tmp.1
-  $dd if=$ed.b of=$tmp.2 2>/dev/null
+  $dd if=$ed.a 2>/System/Devices/null > $tmp.1
+  $dd if=$ed.b of=$tmp.2 2>/System/Devices/null
   open $tmp.2
-  $dd if=$tmp.1 of=$ed.a 2>/dev/null
+  $dd if=$tmp.1 of=$ed.a 2>/System/Devices/null
   lineno=$l
 }
 
 # insert before current line (without changing current)
 insert () {
-  ( $dd if=$ed.a; Echo "$@" ) 2>/dev/null > $tmp.1
-  $dd if=$tmp.1 of=$ed.a 2>/dev/null
+  ( $dd if=$ed.a; Echo "$@" ) 2>/System/Devices/null > $tmp.1
+  $dd if=$tmp.1 of=$ed.a 2>/System/Devices/null
   add lineno $lineno 1
 }
 
@@ -332,7 +332,7 @@
     *) subtract lineno $lineno 1
        # read last line of $ed.a
        IFS='+'
-       set `$dd if=$ed.a of=/dev/null bs=1 2>&1`
+       set `$dd if=$ed.a of=/System/Devices/null bs=1 2>&1`
        IFS="$saveIFS"
        size=$1
        # empty?
@@ -344,7 +344,7 @@
        case "$size" in
 	 0) ;;
 	 *) subtract size1 $size 1
-	    case "`$dd if=$ed.a bs=1 skip=$size count=1 2>/dev/null`" in
+	    case "`$dd if=$ed.a bs=1 skip=$size count=1 2>/System/Devices/null`" in
 	      ?*) ;;
 	      *) size=$size1 ;;
 	    esac
@@ -355,7 +355,7 @@
        do
 	 case "$size" in
 	   0) go=false ;;
-	   *) case "`$dd if=$ed.a bs=1 skip=$size count=1 2>/dev/null`" in
+	   *) case "`$dd if=$ed.a bs=1 skip=$size count=1 2>/System/Devices/null`" in
 	        ?*)  go=true; subtract size $size 1 ;;
 	        *)   go=false; add size $size 1 ;;
 	      esac
@@ -364,19 +364,19 @@
        done
        # now $size is the size of the first n-1 lines
        # add $ed.c to $ed.b
-       ( $dd if=$ed.c; $dd if=$ed.b ) 2>/dev/null > $tmp.5
-       $dd if=$tmp.5 of=$ed.b 2>/dev/null
+       ( $dd if=$ed.c; $dd if=$ed.b ) 2>/System/Devices/null > $tmp.5
+       $dd if=$tmp.5 of=$ed.b 2>/System/Devices/null
        # move line to ed.c
        case "$size" in
-	 0) $dd if=$ed.a of=$ed.c 2>/dev/null
-	    $dd if=/dev/null of=$tmp.5 2>/dev/null
+	 0) $dd if=$ed.a of=$ed.c 2>/System/Devices/null
+	    $dd if=/System/Devices/null of=$tmp.5 2>/System/Devices/null
 	    ;;
-	 *) $dd if=$ed.a of=$ed.c bs=1 skip=$size 2>/dev/null
-	    $dd if=$ed.a of=$tmp.5 bs=1 count=$size 2>/dev/null
+	 *) $dd if=$ed.a of=$ed.c bs=1 skip=$size 2>/System/Devices/null
+	    $dd if=$ed.a of=$tmp.5 bs=1 count=$size 2>/System/Devices/null
 	    ;;
        esac
        # move rest to ed.a
-       $dd if=$tmp.5 of=$ed.a 2>/dev/null
+       $dd if=$tmp.5 of=$ed.a 2>/System/Devices/null
     ;;
   esac
 }
@@ -403,7 +403,7 @@
 
 lineout () {
   Echo -n "$lineno: "
-  $dd if=$ed.c 2>/dev/null
+  $dd if=$ed.c 2>/System/Devices/null
 }
 
 state=closed
diff -urN bash-3.0/examples/scripts/fixfiles.bash bash-3.0-STEP/examples/scripts/fixfiles.bash
--- bash-3.0/examples/scripts/fixfiles.bash	2002-08-02 06:32:36.000000000 +1200
+++ bash-3.0-STEP/examples/scripts/fixfiles.bash	2005-08-25 00:33:16.903649024 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # From: c2a192@ugrad.cs.ubc.ca (Kazimir Kylheku)
 # Newsgroups: comp.unix.shell,comp.os.linux.misc
diff -urN bash-3.0/examples/scripts/inpath bash-3.0-STEP/examples/scripts/inpath
--- bash-3.0/examples/scripts/inpath	1995-05-16 07:02:51.000000000 +1200
+++ bash-3.0-STEP/examples/scripts/inpath	2005-08-25 00:33:16.906648568 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 #
 # Search $PATH for a file the same name as $1; return TRUE if found.
 #
diff -urN bash-3.0/examples/scripts/krand.bash bash-3.0-STEP/examples/scripts/krand.bash
--- bash-3.0/examples/scripts/krand.bash	1997-09-05 06:18:40.000000000 +1200
+++ bash-3.0-STEP/examples/scripts/krand.bash	2005-08-25 00:34:10.686472792 +1200
@@ -47,11 +47,11 @@
 esac
 
 # Check that specified values are integers:
-expr "$Lower" + 0 >/dev/null 2>&1
+expr "$Lower" + 0 >/System/Devices/null 2>&1
 [ $? -eq 2 ] && { errexit "lower ($Lower) not an integer"; }
-expr "$Upper" + 0 >/dev/null 2>&1
+expr "$Upper" + 0 >/System/Devices/null 2>&1
 [ $? -eq 2 ] && { errexit "upper ($Upper) not an integer"; }
-expr "$Seed" + 0 >/dev/null 2>&1
+expr "$Seed" + 0 >/System/Devices/null 2>&1
 [ $? -eq 2 ] && { errexit "seed ($Seed) not an integer"; }
 
 # Check that values are in the correct range:
diff -urN bash-3.0/examples/scripts/line-input.bash bash-3.0-STEP/examples/scripts/line-input.bash
--- bash-3.0/examples/scripts/line-input.bash	2002-08-02 06:33:33.000000000 +1200
+++ bash-3.0-STEP/examples/scripts/line-input.bash	2005-08-25 00:34:10.689472336 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 #From: kaz@cafe.net (Kaz Kylheku)
 #Newsgroups: comp.unix.shell
@@ -70,7 +70,7 @@
 
 function getkey
 {
-	eval $1="\"\$(dd bs=1 count=1 2> /dev/null)\""
+	eval $1="\"\$(dd bs=1 count=1 2> /System/Devices/null)\""
 }
 
 #
diff -urN bash-3.0/examples/scripts/nohup.bash bash-3.0-STEP/examples/scripts/nohup.bash
--- bash-3.0/examples/scripts/nohup.bash	1996-11-02 06:04:35.000000000 +1300
+++ bash-3.0-STEP/examples/scripts/nohup.bash	2005-08-25 00:34:10.692471880 +1200
@@ -23,7 +23,7 @@
 command=$(ctype "$1")
 oldmask=$(umask)
 umask u=rw,og=		# default mode for nohup.out
-exec 0< /dev/null	# disconnect input
+exec 0< /System/Devices/null	# disconnect input
 if [ -t 1 ]; then	# redirect output if necessary
 	if [ -w . ]; then
 		echo 'Sending output to nohup.out'
diff -urN bash-3.0/examples/scripts/scrollbar bash-3.0-STEP/examples/scripts/scrollbar
--- bash-3.0/examples/scripts/scrollbar	1997-09-05 06:39:48.000000000 +1200
+++ bash-3.0-STEP/examples/scripts/scrollbar	2005-08-25 00:33:16.912647656 +1200
@@ -1,4 +1,4 @@
-#!/bin/bash
+#!/System/Tools/bash
 #
 # scrollbar - display scrolling text
 #
diff -urN bash-3.0/examples/scripts/scrollbar2 bash-3.0-STEP/examples/scripts/scrollbar2
--- bash-3.0/examples/scripts/scrollbar2	1997-09-05 06:42:00.000000000 +1200
+++ bash-3.0-STEP/examples/scripts/scrollbar2	2005-08-25 00:33:16.915647200 +1200
@@ -1,4 +1,4 @@
-#!/bin/bash
+#!/System/Tools/bash
 #
 # scrollbar - display scrolling text
 #
diff -urN bash-3.0/examples/scripts/spin.bash bash-3.0-STEP/examples/scripts/spin.bash
--- bash-3.0/examples/scripts/spin.bash	1997-04-02 09:56:15.000000000 +1200
+++ bash-3.0-STEP/examples/scripts/spin.bash	2005-08-25 00:33:16.918646744 +1200
@@ -1,4 +1,4 @@
-#!/bin/bash
+#!/System/Tools/bash
 #
 # spin.bash -- provide a `spinning wheel' to show progress
 #
diff -urN bash-3.0/examples/scripts/timeout bash-3.0-STEP/examples/scripts/timeout
--- bash-3.0/examples/scripts/timeout	1998-03-04 07:29:53.000000000 +1300
+++ bash-3.0-STEP/examples/scripts/timeout	2005-08-25 00:34:10.695471424 +1200
@@ -48,6 +48,6 @@
 		kill $SIG $$ && kill -0 $$ || exit
 		SIG=-KILL
 	done
-) 2> /dev/null &
+) 2> /System/Devices/null &
 
 exec "$@"
diff -urN bash-3.0/examples/scripts/vtree2 bash-3.0-STEP/examples/scripts/vtree2
--- bash-3.0/examples/scripts/vtree2	2002-04-05 03:26:07.000000000 +1200
+++ bash-3.0-STEP/examples/scripts/vtree2	2005-08-25 00:33:16.920646440 +1200
@@ -1,4 +1,4 @@
-#!/bin/bash
+#!/System/Tools/bash
 #
 # vtree - make a tree printout of the specified directory, with disk usage
 #	  in 1k blocks
diff -urN bash-3.0/examples/scripts/vtree3 bash-3.0-STEP/examples/scripts/vtree3
--- bash-3.0/examples/scripts/vtree3	1996-12-17 11:23:57.000000000 +1300
+++ bash-3.0-STEP/examples/scripts/vtree3	2005-08-25 00:33:16.923645984 +1200
@@ -1,4 +1,4 @@
-#!/bin/ksh
+#!/System/Tools/ksh
 #
 # Name: dirtree
 # Programmer:
diff -urN bash-3.0/examples/scripts/vtree3a bash-3.0-STEP/examples/scripts/vtree3a
--- bash-3.0/examples/scripts/vtree3a	1999-11-30 09:48:00.000000000 +1300
+++ bash-3.0-STEP/examples/scripts/vtree3a	2005-08-25 00:33:16.926645528 +1200
@@ -1,4 +1,4 @@
-#!/bin/bash
+#!/System/Tools/bash
 #
 # Name: dirtree
 # Programmer:
diff -urN bash-3.0/examples/scripts/websrv.sh bash-3.0-STEP/examples/scripts/websrv.sh
--- bash-3.0/examples/scripts/websrv.sh	1999-04-27 03:56:25.000000000 +1200
+++ bash-3.0-STEP/examples/scripts/websrv.sh	2005-08-25 00:33:16.930644920 +1200
@@ -1,4 +1,4 @@
-#!/bin/sh
+#!/System/Tools/sh
 #for instructions or updates go to:
 #<A HREF="http://math.ucr.edu:8889/">This script's home page</A>
 #email me questions or comments at:
diff -urN bash-3.0/examples/scripts/xterm_title bash-3.0-STEP/examples/scripts/xterm_title
--- bash-3.0/examples/scripts/xterm_title	1999-10-28 05:20:46.000000000 +1300
+++ bash-3.0-STEP/examples/scripts/xterm_title	2005-08-25 00:34:10.704470056 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # xterm_title - print the contents of the xterm title bar
 #
@@ -15,10 +15,10 @@
 	exit 1
 fi
 
-exec </dev/tty
+exec </System/Devices/tty
 old=$(stty -g)
 stty raw -echo min 0  time ${1-10}
-echo -e "\033[21t\c" > /dev/tty
+echo -e "\033[21t\c" > /System/Devices/tty
 IFS='' read -r a
 stty $old
 b=${a#???}
diff -urN bash-3.0/examples/scripts/zprintf bash-3.0-STEP/examples/scripts/zprintf
--- bash-3.0/examples/scripts/zprintf	1996-10-17 07:39:47.000000000 +1300
+++ bash-3.0-STEP/examples/scripts/zprintf	2005-08-25 00:33:16.933644464 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # zprintf - function that calls gawk to do printf for those systems that
 #	    don't have a printf executable
diff -urN bash-3.0/examples/scripts.noah/bash.sub.bash bash-3.0-STEP/examples/scripts.noah/bash.sub.bash
--- bash-3.0/examples/scripts.noah/bash.sub.bash	1995-05-20 07:24:11.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.noah/bash.sub.bash	2005-08-25 00:46:57.513897304 +1200
@@ -18,7 +18,7 @@
 #
 #:end docstring:
 
-default_FPATH="~friedman/etc/init/bash/functions/lib"
+default_FPATH="~friedman/System/Settings/init/bash/functions/lib"
 
 source "${default_FPATH}/feature"
 REQUIRE_FAILURE_FATAL=t
diff -urN bash-3.0/examples/scripts.noah/mktmp.bash bash-3.0-STEP/examples/scripts.noah/mktmp.bash
--- bash-3.0/examples/scripts.noah/mktmp.bash	1995-05-26 07:45:54.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.noah/mktmp.bash	2005-08-25 00:34:10.738464888 +1200
@@ -36,7 +36,7 @@
     if [ "${createp:+set}" = "set" ]; then
        # Version which creates file atomically through noclobber test.   
        set -o noclobber
-       (> "${tmpfile}") 2> /dev/null
+       (> "${tmpfile}") 2> /System/Devices/null
        while [ $? -ne 0 ] ; do
           # Detect whether file really exists or creation lost because of
           # some other permissions problem.  If the latter, we don't want
@@ -48,7 +48,7 @@
              return 1
           fi
           tmpfile="${template}${RANDOM}"
-          (> "${tmpfile}") 2> /dev/null
+          (> "${tmpfile}") 2> /System/Devices/null
        done
        test "${noclobber_status}" != "set" && set +o noclobber
     else
diff -urN bash-3.0/examples/scripts.noah/remap_keys.bash bash-3.0-STEP/examples/scripts.noah/remap_keys.bash
--- bash-3.0/examples/scripts.noah/remap_keys.bash	1995-05-26 03:58:51.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.noah/remap_keys.bash	2005-08-25 00:34:10.741464432 +1200
@@ -33,7 +33,7 @@
     fi
 
     while : ; do
-       bind_output="$(bind -q ${unbind_function} 2> /dev/null)"
+       bind_output="$(bind -q ${unbind_function} 2> /System/Devices/null)"
 
        case "${bind_output}" in
           "${unbind_function} can be invoked via"* ) ;;
diff -urN bash-3.0/examples/scripts.noah/send_mail.bash bash-3.0-STEP/examples/scripts.noah/send_mail.bash
--- bash-3.0/examples/scripts.noah/send_mail.bash	1995-05-26 08:18:11.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.noah/send_mail.bash	2005-08-25 00:47:18.031778112 +1200
@@ -34,10 +34,10 @@
     local To
     local Cc
     local Bcc
-    local tmpfile="/tmp/send_mail$$"
+    local tmpfile="/System/TemporaryFiles/send_mail$$"
 
     while [ -e "${tmpfile}" ]; do
-       tmpfile="/tmp/send_mail${RANDOM}"
+       tmpfile="/System/TemporaryFiles/send_mail${RANDOM}"
     done
 
     # Lines consisting only of dots need one more dot appended.  SMTP
@@ -120,7 +120,7 @@
     # Not sure if an address is *required* after the HELO.. every sendmail
     # I tried talking to didn't seem to care.  Some sendmails don't care
     # if there's a HELO at all. 
-    cat <<- __EOF__ | telnet ${MAILHOST:-localhost} 25 > /dev/null 2>&1
+    cat <<- __EOF__ | telnet ${MAILHOST:-localhost} 25 > /System/Devices/null 2>&1
 	HELO
 	mail from: ${From:-${DefaultFrom}}
 	$(for name in ${To} ${Cc} ${Bcc} ; do
diff -urN bash-3.0/examples/scripts.noah/string.bash bash-3.0-STEP/examples/scripts.noah/string.bash
--- bash-3.0/examples/scripts.noah/string.bash	2002-08-02 06:24:46.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.noah/string.bash	2005-08-25 00:34:10.748463368 +1200
@@ -80,7 +80,7 @@
 {
     [ "$1" = "$2" ] && return 0
 
-    [ "${1}" '<' "${2}" ] > /dev/null && return -1
+    [ "${1}" '<' "${2}" ] > /System/Devices/null && return -1
 
     return 1
 }
diff -urN bash-3.0/examples/scripts.v2/arc2tarz bash-3.0-STEP/examples/scripts.v2/arc2tarz
--- bash-3.0/examples/scripts.v2/arc2tarz	1995-05-10 06:24:33.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/arc2tarz	2005-08-25 00:47:17.986784952 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from:
 # arc2tarz: convert arced file to tarred, compressed form.
@@ -43,7 +43,7 @@
 	exit 0
 fi
 
-[ -z "$TMP" ] && tmpdir=/tmp/arc2tarz.$$ || tmpdir=$TMP/arc2tarz.$$
+[ -z "$TMP" ] && tmpdir=/System/TemporaryFiles/arc2tarz.$$ || tmpdir=$TMP/arc2tarz.$$
 
 case "$1" in
 *.arc)	arcfile=$1 ;;
diff -urN bash-3.0/examples/scripts.v2/bashrand bash-3.0-STEP/examples/scripts.v2/bashrand
--- bash-3.0/examples/scripts.v2/bashrand	1996-10-17 06:44:53.000000000 +1300
+++ bash-3.0-STEP/examples/scripts.v2/bashrand	2005-08-25 00:34:10.713468688 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 # bashrand - generate a random number in a specified range with an
 #	     optionally specified ``seed'' value.
 #
@@ -30,17 +30,17 @@
 esac
 
 # Check that specified values are integers:
-expr "$Lower" + 0 >/dev/null 2>&1 || {
+expr "$Lower" + 0 >/System/Devices/null 2>&1 || {
 	echo "$PROG: lower ($Lower) not an integer" >&2
 	exit 1
 }
 
-expr "$Upper" + 0 >/dev/null 2>&1 || {
+expr "$Upper" + 0 >/System/Devices/null 2>&1 || {
 	echo "$PROG: upper ($Upper) not an integer" >&2
 	exit 1
 }
 
-expr "$SEED" + 0 >/dev/null 2>&1 || {
+expr "$SEED" + 0 >/System/Devices/null 2>&1 || {
 	echo "$PROG: seed ($SEED) not an integer" >&2
 	exit 1
 }
diff -urN bash-3.0/examples/scripts.v2/cal2day.bash bash-3.0-STEP/examples/scripts.v2/cal2day.bash
--- bash-3.0/examples/scripts.v2/cal2day.bash	1997-11-26 09:53:28.000000000 +1300
+++ bash-3.0-STEP/examples/scripts.v2/cal2day.bash	2005-08-25 00:33:16.945642640 +1200
@@ -1,4 +1,4 @@
-#!/bin/bash
+#!/System/Tools/bash
 # cal2day - "parse" appropriate calendar output to match date number
 #	    with day name.
 #
diff -urN bash-3.0/examples/scripts.v2/cdhist.bash bash-3.0-STEP/examples/scripts.v2/cdhist.bash
--- bash-3.0/examples/scripts.v2/cdhist.bash	2002-08-02 06:25:48.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/cdhist.bash	2005-08-25 00:47:17.990784344 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # cdhist - cd replacement with a directory stack like pushd/popd
 #
@@ -165,7 +165,7 @@
 cd /
 
 echo CDHIST: "${CDHIST[@]}"
-for dir in /tmp /bin - -2 -l
+for dir in /System/TemporaryFiles /bin - -2 -l
 do
 	cd $dir
 	echo CDHIST: "${CDHIST[@]}"
diff -urN bash-3.0/examples/scripts.v2/corename bash-3.0-STEP/examples/scripts.v2/corename
--- bash-3.0/examples/scripts.v2/corename	1995-05-10 08:59:22.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/corename	2005-08-25 00:34:10.716468232 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from:
 # @(#) corename.ksh 1.0 93/04/01
@@ -37,7 +37,7 @@
     cd $dir
 
     # the adb output syntax is highly variable.  this works on SunOS 4.x
-    set -- $(adb $file < /dev/null 2>&1 | sed 1q)
+    set -- $(adb $file < /System/Devices/null 2>&1 | sed 1q)
     name=${7#??}
     echo "$i: ${name%??}"
 done
diff -urN bash-3.0/examples/scripts.v2/fman bash-3.0-STEP/examples/scripts.v2/fman
--- bash-3.0/examples/scripts.v2/fman	2002-08-02 06:26:16.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/fman	2005-08-25 00:46:57.505898520 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from:
 # fman: new man program
@@ -6,7 +6,7 @@
 # 91/07/03 john h. dubois iii (john@armory.com)
 # 91/07/11 made it unpack man pages if neccessary
 # 91/07/16 fixed test for whether man file pattern was expanded
-# 92/01/21 made it read /etc/default/man to get section order,
+# 92/01/21 made it read /System/Settings/default/man to get section order,
 #          and only display the first section found.
 # 92/02/06 changed name to fman
 # 92/02/07 fixed bug in notfound
@@ -57,7 +57,7 @@
     done
     [ -z "$indexes" ] && return
     # Make grep give filename
-    [ NIndex -lt 2 ] && indexes="$indexes /dev/null"
+    [ NIndex -lt 2 ] && indexes="$indexes /System/Devices/null"
     # set positional parameters to
     # indexfile:searchname pagename section ...
     # e.g.
@@ -216,7 +216,7 @@
 O=1:n:l:6:8:2:3:4:5:7:p:o
 T=$TERM
 M=${MANPATH:-/usr/local/man:/usr/man}
-[ -f /etc/default/man ] && . /etc/default/man
+[ -f /System/Settings/default/man ] && . /System/Settings/default/man
 [ -n "$P" ] && PAGER=$P
 [ -n "$O" ] && ORDER=$O
 [ -n "$T" ] && TERM=$T
diff -urN bash-3.0/examples/scripts.v2/frcp bash-3.0-STEP/examples/scripts.v2/frcp
--- bash-3.0/examples/scripts.v2/frcp	2002-08-02 06:26:53.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/frcp	2005-08-25 00:33:16.959640512 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from:
 #
@@ -17,8 +17,8 @@
 #	done.
 #
 # full path to ftp binary
-if [ -x /usr/bin/ftp ]; then
-	FTP=/usr/bin/ftp;
+if [ -x /System/Tools/ftp ]; then
+	FTP=/System/Tools/ftp;
 elif [ -x /usr/ucb/ftp ]; then
 	FTP=/usr/ucb/ftp
 else
diff -urN bash-3.0/examples/scripts.v2/lowercase bash-3.0-STEP/examples/scripts.v2/lowercase
--- bash-3.0/examples/scripts.v2/lowercase	1996-05-29 09:32:04.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/lowercase	2005-08-25 00:33:16.961640208 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from
 # @(#) lowercase.ksh 1.0 92/10/08
diff -urN bash-3.0/examples/scripts.v2/ncp bash-3.0-STEP/examples/scripts.v2/ncp
--- bash-3.0/examples/scripts.v2/ncp	1995-05-10 05:59:59.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/ncp	2005-08-25 00:33:16.969638992 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from:
 # @(#) ncp.ksh,nmv.ksh 1.1 94/07/23
@@ -58,7 +58,7 @@
 name=${0##*/}
 
 case "$name" in
-ncp|nmv) cmd=/bin/${name#?} ;;
+ncp|nmv) cmd=/System/Tools/${name#?} ;;
 *) echo "$name: Must be invoked as ncp or nmv." 1>&2 ; exit 2;;
 esac
 
diff -urN bash-3.0/examples/scripts.v2/newext bash-3.0-STEP/examples/scripts.v2/newext
--- bash-3.0/examples/scripts.v2/newext	1995-05-11 08:21:25.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/newext	2005-08-25 00:33:16.972638536 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from:
 # newext: change filename extension
diff -urN bash-3.0/examples/scripts.v2/nmv bash-3.0-STEP/examples/scripts.v2/nmv
--- bash-3.0/examples/scripts.v2/nmv	1995-05-10 05:59:59.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/nmv	2005-08-25 00:33:16.979637472 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from:
 # @(#) ncp.ksh,nmv.ksh 1.1 94/07/23
@@ -58,7 +58,7 @@
 name=${0##*/}
 
 case "$name" in
-ncp|nmv) cmd=/bin/${name#?} ;;
+ncp|nmv) cmd=/System/Tools/${name#?} ;;
 *) echo "$name: Must be invoked as ncp or nmv." 1>&2 ; exit 2;;
 esac
 
diff -urN bash-3.0/examples/scripts.v2/pages bash-3.0-STEP/examples/scripts.v2/pages
--- bash-3.0/examples/scripts.v2/pages	1995-05-10 05:16:02.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/pages	2005-08-25 00:34:10.723467168 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from:
 # @(#) pages.sh 1.0 92/09/26
@@ -130,7 +130,7 @@
 }
 
 function ErrExit(S) {
-    print S > "/dev/stderr"
+    print S > "/System/Devices/stderr"
     Err = 1
     exit 1
 }
diff -urN bash-3.0/examples/scripts.v2/pf bash-3.0-STEP/examples/scripts.v2/pf
--- bash-3.0/examples/scripts.v2/pf	1995-05-10 04:54:38.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/pf	2005-08-25 00:33:16.989635952 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from:
 #
@@ -15,7 +15,7 @@
 #
 # conversion to bash v2 by Chet Ramey; renamed to pf
 #
-DefPager=/local/bin/less
+DefPager=/local/System/Tools/less
 
 istrue()
 {
diff -urN bash-3.0/examples/scripts.v2/pmtop bash-3.0-STEP/examples/scripts.v2/pmtop
--- bash-3.0/examples/scripts.v2/pmtop	2002-04-05 03:26:32.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/pmtop	2005-08-25 00:33:17.020631240 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # pmtop - poor man's `top' for SunOS 4.x
 #
diff -urN bash-3.0/examples/scripts.v2/ren bash-3.0-STEP/examples/scripts.v2/ren
--- bash-3.0/examples/scripts.v2/ren	2002-04-04 10:09:03.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/ren	2005-08-25 00:47:18.009781456 +1200
@@ -1,4 +1,4 @@
-#!/bin/bash
+#!/System/Tools/bash
 #@ This program came from: ftp://ftp.armory.com/pub/scripts/ren
 #@ Look there for the latest version.
 #@ If you don't find it, look through http://www.armory.com/~ftp/
@@ -11,7 +11,7 @@
 # 1995-01-23 Allow filename set to be given on command line.
 # 1997-09-24 1.4 Let [] be used for globbing.  Added x option.
 # 1997-11-26 1.4.1 Notice if the sequences of globbing chars aren't the same.
-# 1999-05-13 Changed name to ren to avoid conflict with /etc/rename
+# 1999-05-13 Changed name to ren to avoid conflict with /System/Settings/rename
 # 2000-01-01 1.4.2 Let input patterns that contain whitespace be used.
 # 2001-02-14 1.5 Better test for whether old & new globbing seqs are identical.
 # 2001-02-20 1.6 Added pP options.
@@ -121,10 +121,10 @@
 If you are unsure whether a $name command will do what you intend, issue it
 with the -t option first to be sure.
 Examples:
-$name \"/tmp/foo*.ba.?\" \"/tmp/new*x?\"
-    All filenames in /tmp that match foo*.ba.? will have the \"foo\" part
+$name \"/System/TemporaryFiles/foo*.ba.?\" \"/System/TemporaryFiles/new*x?\"
+    All filenames in /System/TemporaryFiles that match foo*.ba.? will have the \"foo\" part
     replaced by \"new\" and the \".ba.\" part replaced by \"x\".
-    For example, /tmp/fooblah.ba.baz would be renamed to /tmp/newblahxbaz.
+    For example, /System/TemporaryFiles/fooblah.ba.baz would be renamed to /System/TemporaryFiles/newblahxbaz.
 $name \* \*- foo bar baz
     foo, bar, and baz will be renamed to foo-, bar-, and baz-.
 $name '????????' '????-??-??'
@@ -254,7 +254,7 @@
 	# indication and when last expression evaluates to 0, so evaluate 1
 	# after test expression.
 	i=1
-	let "$op" 1 2>/dev/null || {
+	let "$op" 1 2>/System/Devices/null || {
 	    print -ru2 -- \
 	    "$name: Bad operation given with -m: $op"
 	    exit 1
diff -urN bash-3.0/examples/scripts.v2/rename bash-3.0-STEP/examples/scripts.v2/rename
--- bash-3.0/examples/scripts.v2/rename	2000-01-20 06:09:41.000000000 +1300
+++ bash-3.0-STEP/examples/scripts.v2/rename	2005-08-25 00:47:18.016780392 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from:
 # @(#) rename.ksh 1.1 94/05/10
@@ -20,8 +20,8 @@
 must occur in the same order in newpattern.  Variables parts
 can be '?' and '*'.
 Example: 
-rename \"/tmp/foo*.ba.?\" \"/tmp/new*x?\"
-All files in /tmp that match foo*.ba.? will have the \"foo\" part
+rename \"/System/TemporaryFiles/foo*.ba.?\" \"/System/TemporaryFiles/new*x?\"
+All files in /System/TemporaryFiles that match foo*.ba.? will have the \"foo\" part
 replaced by \"new\" and the \".ba.\" part replaced by \"x\"."
 }
 
diff -urN bash-3.0/examples/scripts.v2/repeat bash-3.0-STEP/examples/scripts.v2/repeat
--- bash-3.0/examples/scripts.v2/repeat	2002-08-02 06:28:20.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/repeat	2005-08-25 00:33:17.004633672 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from:
 # repeat: repeat a command.
diff -urN bash-3.0/examples/scripts.v2/shprof bash-3.0-STEP/examples/scripts.v2/shprof
--- bash-3.0/examples/scripts.v2/shprof	1995-12-22 05:35:05.000000000 +1300
+++ bash-3.0-STEP/examples/scripts.v2/shprof	2005-08-25 00:47:18.025779024 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # shprof - a line profiler for shell scripts
 #
@@ -7,7 +7,7 @@
 #
 # converted to bash v2 syntax by Chet Ramey
 #
-TMPFILE=${TMP:-/tmp}/shprof$$
+TMPFILE=${TMP:-/System/TemporaryFiles}/shprof$$
 
 trap 'rm -f $TMPFILE' EXIT
 
diff -urN bash-3.0/examples/scripts.v2/untar bash-3.0-STEP/examples/scripts.v2/untar
--- bash-3.0/examples/scripts.v2/untar	1995-05-11 09:32:12.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/untar	2005-08-25 00:33:17.008633064 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from:
 # @(#) untar.ksh 1.0 93/11/10
diff -urN bash-3.0/examples/scripts.v2/uuenc bash-3.0-STEP/examples/scripts.v2/uuenc
--- bash-3.0/examples/scripts.v2/uuenc	1995-05-10 05:25:33.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/uuenc	2005-08-25 00:47:18.022779480 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from:
 # @(#) uuenc.ksh 1.0 93/09/18
@@ -24,8 +24,8 @@
 component of the file's path as the stored filename in the uuencoded
 archive and, with a .${SUF} appended, as the name to store the archive in.
 Example: 
-$name /tmp/foo
-The file /tmp/foo is uuencoded, with \"foo\" stored as the name to uudecode
+$name /System/TemporaryFiles/foo
+The file /System/TemporaryFiles/foo is uuencoded, with \"foo\" stored as the name to uudecode
 the file into, and the output is stored in a file in the current directory
 with the name \"foo.${SUF}\".
 Options:
diff -urN bash-3.0/examples/scripts.v2/vtree bash-3.0-STEP/examples/scripts.v2/vtree
--- bash-3.0/examples/scripts.v2/vtree	2002-08-02 06:29:07.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/vtree	2005-08-25 00:34:10.732465800 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from:
 # vtree: visual directory tree
@@ -51,7 +51,7 @@
 pwd     # print path of root of tree
 
 # find all directories depth first; ignore permission errors
-find . -type d -print 2> /dev/null | \
+find . -type d -print 2> /System/Devices/null | \
 gawk -F/ '
 
 # Do this block for NR == 1 instead of BEGIN because command line var
diff -urN bash-3.0/examples/scripts.v2/where bash-3.0-STEP/examples/scripts.v2/where
--- bash-3.0/examples/scripts.v2/where	1995-05-10 06:55:30.000000000 +1200
+++ bash-3.0-STEP/examples/scripts.v2/where	2005-08-25 00:33:17.017631696 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # original from:
 # @(#) where.ksh 1.1 94/07/11
diff -urN bash-3.0/examples/startup-files/Bashrc.bfox bash-3.0-STEP/examples/startup-files/Bashrc.bfox
--- bash-3.0/examples/startup-files/Bashrc.bfox	1995-08-02 04:53:45.000000000 +1200
+++ bash-3.0-STEP/examples/startup-files/Bashrc.bfox	2005-08-25 00:33:20.183150464 +1200
@@ -12,13 +12,13 @@
 
 # Where's the Gnu stuff at?
 GNU=/usr/gnu/bin
-X11=/usr/bin/X11
+X11=/System/Tools/X11
 
 UTIL_PATH=$GNU:$X11
-STANDARD_PATH=/usr/local/bin:/usr/ucb:/bin:/usr/bin:/usr/etc:/etc:/usr/games
+STANDARD_PATH=/usr/local/bin:/usr/ucb:/bin:/System/Tools:/usr/etc:/etc:/usr/games
 
-if [ -d $HOME/bin/$HOSTTYPE ]; then
-	MY_PATH=$HOME/bin/$HOSTTYPE
+if [ -d $HOME/System/Tools/$HOSTTYPE ]; then
+	MY_PATH=$HOME/System/Tools/$HOSTTYPE
 fi
 
 if [ -d $HOME/bin ]; then
diff -urN bash-3.0/examples/startup-files/apple/aliases bash-3.0-STEP/examples/startup-files/apple/aliases
--- bash-3.0/examples/startup-files/apple/aliases	2002-04-05 03:27:35.000000000 +1200
+++ bash-3.0-STEP/examples/startup-files/apple/aliases	2005-08-25 00:33:17.026630328 +1200
@@ -11,7 +11,7 @@
 alias         .='cwd'
 alias        ..='cd ..'
 alias      cd..='cd ..'
-alias      cdwd='cd $(/bin/pwd)'
+alias      cdwd='cd $(/System/Tools/pwd)'
 alias       cwd='echo $PWD'
 alias         l='ls -lg'
 
diff -urN bash-3.0/examples/startup-files/apple/login bash-3.0-STEP/examples/startup-files/apple/login
--- bash-3.0/examples/startup-files/apple/login	1999-04-08 07:33:56.000000000 +1200
+++ bash-3.0-STEP/examples/startup-files/apple/login	2005-08-25 00:47:07.518376392 +1200
@@ -2,7 +2,7 @@
 # Set path
 ##
 
-export PATH="${HOME}/${MACHTYPE}/bin:${HOME}/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"
+export PATH="${HOME}/${MACHTYPE}/bin:${HOME}/bin:/usr/local/bin:/System/Tools:/bin:/System/AdminTools:/sbin"
 
 export MANPATH="${HOME}/man:/usr/local/share/man:/usr/share/man"
 
diff -urN bash-3.0/examples/startup-files/bash-profile bash-3.0-STEP/examples/startup-files/bash-profile
--- bash-3.0/examples/startup-files/bash-profile	1996-05-25 07:24:43.000000000 +1200
+++ bash-3.0-STEP/examples/startup-files/bash-profile	2005-08-25 00:46:57.516896848 +1200
@@ -4,19 +4,19 @@
 
 HISTFILE=~/.history/history.$HOSTNAME
 
-PATH1=/usr/homes/chet/bin.$HOSTTYPE:/usr/local/bin/gnu:
-PATH2=/usr/local/bin:/usr/ucb:/bin:/usr/bin/X11:.
-PATH3=/usr/bin:/usr/new/bin:/usr/contrib/bin
+PATH1=/usr/homes/chet/bin.$HOSTTYPE:/usr/local/System/Tools/gnu:
+PATH2=/usr/local/bin:/usr/ucb:/bin:/System/Tools/X11:.
+PATH3=/System/Tools:/usr/new/bin:/usr/contrib/bin
 PATH=$PATH1:$PATH2:$PATH3
 
-EDITOR=/usr/local/bin/ce VISUAL=/usr/local/bin/ce FCEDIT=/usr/local/bin/ce
+EDITOR=/usr/local/System/Tools/ce VISUAL=/usr/local/System/Tools/ce FCEDIT=/usr/local/System/Tools/ce
 
-SHELL=${SHELL:-${BASH:-/bin/bash}}
+SHELL=${SHELL:-${BASH:-/System/Tools/bash}}
 
-PAGER=/usr/local/bin/less
+PAGER=/usr/local/System/Tools/less
 LESS='-i -e -M -P%t?f%f :stdin .?pb%pb\%:?lbLine %lb:?bbByte %bb:-...'
 #
-# Bogus 1003.2 variables.  This should really be in /etc/profile
+# Bogus 1003.2 variables.  This should really be in /System/Settings/profile
 #
 LOGNAME=${USER-$(whoami)}
 TZ=US/Eastern
diff -urN bash-3.0/examples/startup-files/bashrc bash-3.0-STEP/examples/startup-files/bashrc
--- bash-3.0/examples/startup-files/bashrc	1996-05-25 07:26:45.000000000 +1200
+++ bash-3.0-STEP/examples/startup-files/bashrc	2005-08-25 00:33:17.048626984 +1200
@@ -4,9 +4,9 @@
 
 # bogus
 if [ -f /unix ] ; then	
-	alias ls='/bin/ls -CF'
+	alias ls='/System/Tools/ls -CF'
 else
-	alias ls='/bin/ls -F'
+	alias ls='/System/Tools/ls -F'
 fi
 alias ll='ls -l'
 alias dir='ls -ba'
@@ -23,7 +23,7 @@
 alias mroe=more
 alias pdw=pwd
 
-hash -p /usr/bin/mail mail
+hash -p /System/Tools/mail mail
 
 if [ -z "$HOST" ] ; then
 	export HOST=${HOSTNAME}
diff -urN bash-3.0/execute_cmd.c bash-3.0-STEP/execute_cmd.c
--- bash-3.0/execute_cmd.c	2004-07-05 06:12:58.000000000 +1200
+++ bash-3.0-STEP/execute_cmd.c	2005-08-25 00:34:10.869444976 +1200
@@ -457,14 +457,14 @@
 {
   int fd;
 
-  fd = open ("/dev/null", O_RDONLY);
+  fd = open ("/System/Devices/null", O_RDONLY);
   if (fd > 0)
     {
       dup2 (fd, 0);
       close (fd);
     }
   else if (fd < 0)
-    internal_error (_("cannot redirect standard input from /dev/null: %s"), strerror (errno));
+    internal_error (_("cannot redirect standard input from /System/Devices/null: %s"), strerror (errno));
 }
 
 #define DESCRIBE_PID(pid) do { if (interactive) describe_pid (pid); } while (0)
@@ -1248,7 +1248,7 @@
 
   /* If this is a user subshell, set a flag if stdin was redirected.
      This is used later to decide whether to redirect fd 0 to
-     /dev/null for async commands in the subshell.  This adds more
+     /System/Devices/null for async commands in the subshell.  This adds more
      sh compatibility, but I'm not sure it's the right thing to do. */
   if (user_subshell)
     {
@@ -1257,7 +1257,7 @@
     }
 
   /* If this is an asynchronous command (command &), we want to
-     redirect the standard input from /dev/null in the absence of
+     redirect the standard input from /System/Devices/null in the absence of
      any specific redirection involving stdin. */
   if (should_redir_stdin && stdin_redir == 0)
     async_redirect_stdin ();
@@ -1466,7 +1466,7 @@
       /* If this shell was compiled without job control support,
 	 if we are currently in a subshell via `( xxx )', or if job
 	 control is not active then the standard input for an
-	 asynchronous command is forced to /dev/null. */
+	 asynchronous command is forced to /System/Devices/null. */
 #if defined (JOB_CONTROL)
       if ((subshell_environment || !job_control) && !stdin_redir)
 #else
diff -urN bash-3.0/externs.h bash-3.0-STEP/externs.h
--- bash-3.0/externs.h	2004-04-13 15:30:08.000000000 +1200
+++ bash-3.0-STEP/externs.h	2005-08-25 00:47:18.091768992 +1200
@@ -349,7 +349,7 @@
 extern void timeval_to_secs ();
 extern void print_timeval ();
 
-/* declarations for functions defined in lib/sh/tmpfile.c */
+/* declarations for functions defined in lib/sh/System/TemporaryFilesfile.c */
 #define MT_USETMPDIR		0x0001
 #define MT_READWRITE		0x0002
 #define MT_USERANDOM		0x0004
diff -urN bash-3.0/general.c bash-3.0-STEP/general.c
--- bash-3.0/general.c	2004-04-15 15:20:13.000000000 +1200
+++ bash-3.0-STEP/general.c	2005-08-25 00:34:10.883442848 +1200
@@ -356,7 +356,7 @@
 }
 
 /* There is a bug in the NeXT 2.1 rlogind that causes opens
-   of /dev/tty to fail. */
+   of /System/Devices/tty to fail. */
 
 #if defined (__BEOS__)
 /* On BeOS, opening in non-blocking mode exposes a bug in BeOS, so turn it
@@ -371,7 +371,7 @@
   int tty_fd;
   char *tty;
 
-  tty_fd = open ("/dev/tty", O_RDWR|O_NONBLOCK);
+  tty_fd = open ("/System/Devices/tty", O_RDWR|O_NONBLOCK);
 
   if (tty_fd < 0)
     {
diff -urN bash-3.0/include/chartypes.h bash-3.0-STEP/include/chartypes.h
--- bash-3.0/include/chartypes.h	2002-04-04 01:32:22.000000000 +1200
+++ bash-3.0-STEP/include/chartypes.h	2005-08-25 00:33:17.063624704 +1200
@@ -27,7 +27,7 @@
 
    "... Some ctype macros are valid only for character codes that
    isascii says are ASCII (SGI's IRIX-4.0.5 is one such system --when
-   using /bin/cc or gcc but without giving an ansi option).  So, all
+   using /System/Tools/cc or gcc but without giving an ansi option).  So, all
    ctype uses should be through macros like ISPRINT...  If
    STDC_HEADERS is defined, then autoconf has verified that the ctype
    macros don't need to be guarded with references to isascii. ...
diff -urN bash-3.0/include/stdc.h bash-3.0-STEP/include/stdc.h
--- bash-3.0/include/stdc.h	2003-05-31 07:07:44.000000000 +1200
+++ bash-3.0-STEP/include/stdc.h	2005-08-25 00:47:11.964700448 +1200
@@ -22,7 +22,7 @@
 #if !defined (_STDC_H_)
 #define _STDC_H_
 
-/* Adapted from BSD /usr/include/sys/cdefs.h. */
+/* Adapted from BSD /usr/include/System/SystemFS/cdefs.h. */
 
 /* A function can be defined using prototypes and compile on both ANSI C
    and traditional C compilers with something like this:
diff -urN bash-3.0/input.c bash-3.0-STEP/input.c
--- bash-3.0/input.c	2003-12-19 18:09:03.000000000 +1300
+++ bash-3.0-STEP/input.c	2005-08-25 00:46:57.524895632 +1200
@@ -291,7 +291,7 @@
 /* This is the buffered stream analogue of dup2(fd1, fd2).  The
    BUFFERED_STREAM corresponding to fd2 is deallocated, if one exists.
    BUFFERS[fd1] is copied to BUFFERS[fd2].  This is called by the
-   redirect code for constructs like 4<&0 and 3</etc/rc.local. */
+   redirect code for constructs like 4<&0 and 3</System/Settings/rc.local. */
 int
 duplicate_buffered_stream (fd1, fd2)
      int fd1, fd2;
@@ -578,7 +578,7 @@
 
 struct stat dsb;		/* can be used from gdb */
 
-/* imitate /bin/cat */
+/* imitate /System/Tools/cat */
 main(argc, argv)
 int	argc;
 char	**argv;
diff -urN bash-3.0/jobs.c bash-3.0-STEP/jobs.c
--- bash-3.0/jobs.c	2004-04-24 08:28:25.000000000 +1200
+++ bash-3.0-STEP/jobs.c	2005-08-25 00:34:10.907439200 +1200
@@ -1295,7 +1295,7 @@
 
 #if defined (BUFFERED_INPUT)
   /* If default_buffered_input is active, we are reading a script.  If
-     the command is asynchronous, we have already duplicated /dev/null
+     the command is asynchronous, we have already duplicated /System/Devices/null
      as fd 0, but have not changed the buffered stream corresponding to
      the old fd 0.  We don't want to sync the stream in this case. */
   if (default_buffered_input != -1 &&
@@ -2471,6 +2471,7 @@
   PROCESS *child;
   pid_t pid;
   int call_set_current, last_stopped_job, job, children_exited, waitpid_flags;
+  static int wcontinued_not_supported = 0;
 
   call_set_current = children_exited = 0;
   last_stopped_job = NO_JOB;
@@ -2484,7 +2485,15 @@
 			: 0;
       if (sigchld || block == 0)
 	waitpid_flags |= WNOHANG;
+    retry:
+      if (wcontinued_not_supported)
+	waitpid_flags &= ~WCONTINUED;
       pid = WAITPID (-1, &status, waitpid_flags);
+      if (pid == -1 && errno == EINVAL)
+	{
+	  wcontinued_not_supported = 1;
+	  goto retry;
+	}
 
       /* The check for WNOHANG is to make sure we decrement sigchld only
 	 if it was non-zero before we called waitpid. */
diff -urN bash-3.0/jobs.c~ bash-3.0-STEP/jobs.c~
--- bash-3.0/jobs.c~	1970-01-01 12:00:00.000000000 +1200
+++ bash-3.0-STEP/jobs.c~	2005-08-25 00:34:10.925436464 +1200
@@ -0,0 +1,3535 @@
+/* The thing that makes children, remembers them, and contains wait loops. */
+
+/* This file works with both POSIX and BSD systems.  It implements job
+   control. */
+
+/* Copyright (C) 1989-2003 Free Software Foundation, Inc.
+
+   This file is part of GNU Bash, the Bourne Again SHell.
+
+   Bash is free software; you can redistribute it and/or modify it under
+   the terms of the GNU General Public License as published by the Free
+   Software Foundation; either version 2, or (at your option) any later
+   version.
+
+   Bash is distributed in the hope that it will be useful, but WITHOUT ANY
+   WARRANTY; without even the implied warranty of MERCHANTABILITY or
+   FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
+   for more details.
+
+   You should have received a copy of the GNU General Public License along
+   with Bash; see the file COPYING.  If not, write to the Free Software
+   Foundation, 59 Temple Place, Suite 330, Boston, MA 02111 USA. */
+
+#include "config.h"
+
+#include "bashtypes.h"
+#include "trap.h"
+#include <stdio.h>
+#include <signal.h>
+#include <errno.h>
+
+#if defined (HAVE_UNISTD_H)
+#  include <unistd.h>
+#endif
+
+#include "posixtime.h"
+
+#if defined (HAVE_SYS_RESOURCE_H) && defined (HAVE_WAIT3) && !defined (_POSIX_VERSION) && !defined (RLIMTYPE)
+#  include <sys/resource.h>
+#endif /* !_POSIX_VERSION && HAVE_SYS_RESOURCE_H && HAVE_WAIT3 && !RLIMTYPE */
+
+#if defined (HAVE_SYS_FILE_H)
+#  include <sys/file.h>
+#endif
+
+#include "filecntl.h"
+#include <sys/ioctl.h>
+#include <sys/param.h>
+
+#if defined (BUFFERED_INPUT)
+#  include "input.h"
+#endif
+
+/* Need to include this up here for *_TTY_DRIVER definitions. */
+#include "shtty.h"
+
+/* Define this if your output is getting swallowed.  It's a no-op on
+   machines with the termio or termios tty drivers. */
+/* #define DRAIN_OUTPUT */
+
+/* For the TIOCGPGRP and TIOCSPGRP ioctl parameters on HP-UX */
+#if defined (hpux) && !defined (TERMIOS_TTY_DRIVER)
+#  include <bsdtty.h>
+#endif /* hpux && !TERMIOS_TTY_DRIVER */
+
+#if !defined (STRUCT_WINSIZE_IN_SYS_IOCTL)
+/* For struct winsize on SCO */
+/*   sys/ptem.h has winsize but needs mblk_t from sys/stream.h */
+#  if defined (HAVE_SYS_PTEM_H) && defined (TIOCGWINSZ) && defined (SIGWINCH)
+#    if defined (HAVE_SYS_STREAM_H)
+#      include <sys/stream.h>
+#    endif
+#    include <sys/ptem.h>
+#  endif /* HAVE_SYS_PTEM_H && TIOCGWINSZ && SIGWINCH */
+#endif /* !STRUCT_WINSIZE_IN_SYS_IOCTL */
+
+#include "bashansi.h"
+#include "bashintl.h"
+#include "shell.h"
+#include "jobs.h"
+#include "flags.h"
+
+#include "builtins/builtext.h"
+#include "builtins/common.h"
+
+#if !defined (errno)
+extern int errno;
+#endif /* !errno */
+
+#define DEFAULT_CHILD_MAX 32
+#define MAX_JOBS_IN_ARRAY 4096		/* testing */
+
+/* Take care of system dependencies that must be handled when waiting for
+   children.  The arguments to the WAITPID macro match those to the Posix.1
+   waitpid() function. */
+
+#if defined (ultrix) && defined (mips) && defined (_POSIX_VERSION)
+#  define WAITPID(pid, statusp, options) \
+	wait3 ((union wait *)statusp, options, (struct rusage *)0)
+#else
+#  if defined (_POSIX_VERSION) || defined (HAVE_WAITPID)
+#    define WAITPID(pid, statusp, options) \
+	waitpid ((pid_t)pid, statusp, options)
+#  else
+#    if defined (HAVE_WAIT3)
+#      define WAITPID(pid, statusp, options) \
+	wait3 (statusp, options, (struct rusage *)0)
+#    else
+#      define WAITPID(pid, statusp, options) \
+	wait3 (statusp, options, (int *)0)
+#    endif /* HAVE_WAIT3 */
+#  endif /* !_POSIX_VERSION && !HAVE_WAITPID*/
+#endif /* !(Ultrix && mips && _POSIX_VERSION) */
+
+/* getpgrp () varies between systems.  Even systems that claim to be
+   Posix.1 compatible lie sometimes (Ultrix, SunOS4, apollo). */
+#if defined (GETPGRP_VOID)
+#  define getpgid(p) getpgrp ()
+#else
+#  define getpgid(p) getpgrp (p)
+#endif /* !GETPGRP_VOID */
+
+/* If the system needs it, REINSTALL_SIGCHLD_HANDLER will reinstall the
+   handler for SIGCHLD. */
+#if defined (MUST_REINSTALL_SIGHANDLERS)
+#  define REINSTALL_SIGCHLD_HANDLER signal (SIGCHLD, sigchld_handler)
+#else
+#  define REINSTALL_SIGCHLD_HANDLER
+#endif /* !MUST_REINSTALL_SIGHANDLERS */
+
+/* Some systems let waitpid(2) tell callers about stopped children. */
+#if !defined (WCONTINUED)
+#  define WCONTINUED 0
+#endif
+#if !defined (WIFCONTINUED)
+#  define WIFCONTINUED(s)	(0)
+#endif
+
+/* The number of additional slots to allocate when we run out. */
+#define JOB_SLOTS 8
+
+typedef int sh_job_map_func_t __P((JOB *, int, int, int));
+
+#if defined (READLINE)
+extern void rl_set_screen_size __P((int, int));
+#endif
+
+/* Variables used here but defined in other files. */
+extern int subshell_environment, line_number;
+extern int posixly_correct, shell_level;
+extern int interrupt_immediately;
+extern int last_command_exit_value, last_command_exit_signal;
+extern int loop_level, breaking;
+extern int sourcelevel;
+extern sh_builtin_func_t *this_shell_builtin;
+extern char *shell_name, *this_command_name;
+extern sigset_t top_level_mask;
+extern procenv_t wait_intr_buf;
+extern int wait_signal_received;
+extern WORD_LIST *subst_assign_varlist;
+
+/* The array of known jobs. */
+JOB **jobs = (JOB **)NULL;
+
+/* The number of slots currently allocated to JOBS. */
+int job_slots = 0;
+
+/* The controlling tty for this shell. */
+int shell_tty = -1;
+
+/* The shell's process group. */
+pid_t shell_pgrp = NO_PID;
+
+/* The terminal's process group. */
+pid_t terminal_pgrp = NO_PID;
+
+/* The process group of the shell's parent. */
+pid_t original_pgrp = NO_PID;
+
+/* The process group of the pipeline currently being made. */
+pid_t pipeline_pgrp = (pid_t)0;
+
+#if defined (PGRP_PIPE)
+/* Pipes which each shell uses to communicate with the process group leader
+   until all of the processes in a pipeline have been started.  Then the
+   process leader is allowed to continue. */
+int pgrp_pipe[2] = { -1, -1 };
+#endif
+
+/* The job which is current; i.e. the one that `%+' stands for. */
+int current_job = NO_JOB;
+
+/* The previous job; i.e. the one that `%-' stands for. */
+int previous_job = NO_JOB;
+
+/* Last child made by the shell.  */
+pid_t last_made_pid = NO_PID;
+
+/* Pid of the last asynchronous child. */
+pid_t last_asynchronous_pid = NO_PID;
+
+/* The pipeline currently being built. */
+PROCESS *the_pipeline = (PROCESS *)NULL;
+
+/* If this is non-zero, do job control. */
+int job_control = 1;
+
+/* Call this when you start making children. */
+int already_making_children = 0;
+
+/* If this is non-zero, $LINES and $COLUMNS are reset after every process
+   exits from get_tty_state(). */
+int check_window_size;
+
+/* Functions local to this file. */
+
+static void get_new_window_size __P((int));
+
+static void run_sigchld_trap __P((int));
+
+static sighandler wait_sigint_handler __P((int));
+static sighandler sigchld_handler __P((int));
+static sighandler sigwinch_sighandler __P((int));
+static sighandler sigcont_sighandler __P((int));
+static sighandler sigstop_sighandler __P((int));
+
+static int waitchld __P((pid_t, int));
+
+static PROCESS *find_pipeline __P((pid_t, int, int *));
+
+static char *current_working_directory __P((void));
+static char *job_working_directory __P((void));
+static char *j_strsignal __P((int));
+static char *printable_job_status __P((int, PROCESS *, int));
+
+static pid_t find_last_pid __P((int, int));
+
+static int set_new_line_discipline __P((int));
+static int map_over_jobs __P((sh_job_map_func_t *, int, int));
+static int job_last_stopped __P((int));
+static int job_last_running __P((int));
+static int most_recent_job_in_state __P((int, JOB_STATE));
+static int find_job __P((pid_t, int));
+static int print_job __P((JOB *, int, int, int));
+static int process_exit_status __P((WAIT));
+static int process_exit_signal __P((WAIT));
+static int job_exit_status __P((int));
+static int job_exit_signal __P((int));
+static int set_job_status_and_cleanup __P((int));
+
+static WAIT raw_job_exit_status __P((int));
+
+static void notify_of_job_status __P((void));
+static void cleanup_dead_jobs __P((void));
+static int compact_jobs_list __P((int));
+static void discard_pipeline __P((PROCESS *));
+static void add_process __P((char *, pid_t));
+static void print_pipeline __P((PROCESS *, int, int, FILE *));
+static void pretty_print_job __P((int, int, FILE *));
+static void set_current_job __P((int));
+static void reset_current __P((void));
+static void set_job_running __P((int));
+static void setjstatus __P((int));
+static void mark_all_jobs_as_dead __P((void));
+static void mark_dead_jobs_as_notified __P((int));
+static void restore_sigint_handler __P((void));
+#if defined (PGRP_PIPE)
+static void pipe_read __P((int *));
+static void pipe_close __P((int *));
+#endif
+
+#if defined (ARRAY_VARS)
+static int *pstatuses;		/* list of pipeline statuses */
+static int statsize;
+#endif
+
+/* Used to synchronize between wait_for and other functions and the SIGCHLD
+   signal handler. */
+static int sigchld;
+static int queue_sigchld;
+
+#define QUEUE_SIGCHLD(os)	(os) = sigchld, queue_sigchld++
+
+#define UNQUEUE_SIGCHLD(os) \
+	do { \
+	  queue_sigchld--; \
+	  if (queue_sigchld == 0 && os != sigchld) \
+	    waitchld (-1, 0); \
+	} while (0)
+
+static SigHandler *old_tstp, *old_ttou, *old_ttin;
+static SigHandler *old_cont = (SigHandler *)SIG_DFL;
+
+#if defined (TIOCGWINSZ) && defined (SIGWINCH)
+static SigHandler *old_winch = (SigHandler *)SIG_DFL;
+#endif
+
+/* A place to temporarily save the current pipeline. */
+static PROCESS *saved_pipeline;
+static int saved_already_making_children;
+
+/* Set this to non-zero whenever you don't want the jobs list to change at
+   all: no jobs deleted and no status change notifications.  This is used,
+   for example, when executing SIGCHLD traps, which may run arbitrary
+   commands. */
+static int jobs_list_frozen;
+
+static char retcode_name_buffer[64];
+
+static long child_max = -1L;
+
+#if !defined (_POSIX_VERSION)
+
+/* These are definitions to map POSIX 1003.1 functions onto existing BSD
+   library functions and system calls. */
+#define setpgid(pid, pgrp)	setpgrp (pid, pgrp)
+#define tcsetpgrp(fd, pgrp)	ioctl ((fd), TIOCSPGRP, &(pgrp))
+
+pid_t
+tcgetpgrp (fd)
+     int fd;
+{
+  pid_t pgrp;
+
+  /* ioctl will handle setting errno correctly. */
+  if (ioctl (fd, TIOCGPGRP, &pgrp) < 0)
+    return (-1);
+  return (pgrp);
+}
+
+#endif /* !_POSIX_VERSION */
+
+/* Return the working directory for the current process.  Unlike
+   job_working_directory, this does not call malloc (), nor do any
+   of the functions it calls.  This is so that it can safely be called
+   from a signal handler. */
+static char *
+current_working_directory ()
+{
+  char *dir;
+  static char d[PATH_MAX];
+
+  dir = get_string_value ("PWD");
+
+  if (dir == 0 && the_current_working_directory && no_symbolic_links)
+    dir = the_current_working_directory;
+
+  if (dir == 0)
+    {
+      dir = getcwd (d, sizeof(d));
+      if (dir)
+	dir = d;
+    }
+
+  return (dir == 0) ? "<unknown>" : dir;
+}
+
+/* Return the working directory for the current process. */
+static char *
+job_working_directory ()
+{
+  char *dir;
+
+  dir = get_string_value ("PWD");
+  if (dir)
+    return (savestring (dir));
+
+  dir = get_working_directory ("job-working-directory");
+  if (dir)
+    return (dir);
+
+  return (savestring ("<unknown>"));
+}
+
+void
+making_children ()
+{
+  if (already_making_children)
+    return;
+
+  already_making_children = 1;
+  start_pipeline ();
+}
+
+void
+stop_making_children ()
+{
+  already_making_children = 0;
+}
+
+void
+cleanup_the_pipeline ()
+{
+  if (the_pipeline)
+    {
+      discard_pipeline (the_pipeline);
+      the_pipeline = (PROCESS *)NULL;
+    }
+}
+
+void
+save_pipeline (clear)
+     int clear;
+{
+  saved_pipeline = the_pipeline;
+  saved_already_making_children = already_making_children;
+  if (clear)
+    the_pipeline = (PROCESS *)NULL;
+}
+
+void
+restore_pipeline (discard)
+     int discard;
+{
+  PROCESS *old_pipeline;
+
+  old_pipeline = the_pipeline;
+  the_pipeline = saved_pipeline;
+  already_making_children = saved_already_making_children;
+  if (discard)
+    discard_pipeline (old_pipeline);
+}
+
+/* Start building a pipeline.  */
+void
+start_pipeline ()
+{
+  if (the_pipeline)
+    {
+      cleanup_the_pipeline ();
+      pipeline_pgrp = 0;
+#if defined (PGRP_PIPE)
+      pipe_close (pgrp_pipe);
+#endif
+    }
+
+#if defined (PGRP_PIPE)
+  if (job_control)
+    {
+      if (pipe (pgrp_pipe) == -1)
+	sys_error ("start_pipeline: pgrp pipe");
+    }
+#endif
+}
+
+/* Stop building a pipeline.  Install the process list in the job array.
+   This returns the index of the newly installed job.
+   DEFERRED is a command structure to be executed upon satisfactory
+   execution exit of this pipeline. */
+int
+stop_pipeline (async, deferred)
+     int async;
+     COMMAND *deferred;
+{
+  register int i, j;
+  JOB *newjob;
+  sigset_t set, oset;
+
+  BLOCK_CHILD (set, oset);
+
+#if defined (PGRP_PIPE)
+  /* The parent closes the process group synchronization pipe. */
+  pipe_close (pgrp_pipe);
+#endif
+
+  cleanup_dead_jobs ();
+
+  if (job_slots == 0)
+    {
+      job_slots = JOB_SLOTS;
+      jobs = (JOB **)xmalloc (job_slots * sizeof (JOB *));
+
+      /* Now blank out these new entries. */
+      for (i = 0; i < job_slots; i++)
+	jobs[i] = (JOB *)NULL;
+    }
+
+  /* Scan from the last slot backward, looking for the next free one. */
+  /* XXX - revisit this interactive assumption */
+  if (interactive)
+    {
+      for (i = job_slots; i; i--)
+	if (jobs[i - 1])
+	  break;
+    }
+  else
+    {
+      /* If we're not interactive, we don't need to monotonically increase
+	 the job number (in fact, we don't care about the job number at all),
+	 so we can simply scan for the first free slot.  This helps to keep
+	 us from continuously reallocating the jobs array when running
+	 certain kinds of shell loops, and saves time spent searching. */
+      for (i = 0; i < job_slots; i++)
+	if (jobs[i] == 0)
+	  break;
+    }
+
+  /* Do we need more room? */
+
+  /* First try compaction */
+  if (subshell_environment && interactive_shell && i == job_slots && job_slots >= MAX_JOBS_IN_ARRAY)
+    i = compact_jobs_list (0);
+
+  /* If we can't compact, reallocate */
+  if (i == job_slots)
+    {
+      job_slots += JOB_SLOTS;
+      jobs = (JOB **)xrealloc (jobs, ((1 + job_slots) * sizeof (JOB *)));
+
+      for (j = i; j < job_slots; j++)
+	jobs[j] = (JOB *)NULL;
+    }
+
+  /* Add the current pipeline to the job list. */
+  if (the_pipeline)
+    {
+      register PROCESS *p;
+      int any_alive, any_stopped;
+
+      newjob = (JOB *)xmalloc (sizeof (JOB));
+
+      for (p = the_pipeline; p->next != the_pipeline; p = p->next)
+	;
+      p->next = (PROCESS *)NULL;
+      newjob->pipe = REVERSE_LIST (the_pipeline, PROCESS *);
+      for (p = newjob->pipe; p->next; p = p->next)
+	;
+      p->next = newjob->pipe;
+
+      the_pipeline = (PROCESS *)NULL;
+      newjob->pgrp = pipeline_pgrp;
+      pipeline_pgrp = 0;
+
+      newjob->flags = 0;
+
+      /* Flag to see if in another pgrp. */
+      if (job_control)
+	newjob->flags |= J_JOBCONTROL;
+
+      /* Set the state of this pipeline. */
+      p = newjob->pipe;
+      any_alive = any_stopped = 0;
+      do
+	{
+	  any_alive |= p->running;
+	  any_stopped |= WIFSTOPPED (p->status);
+	  p = p->next;
+	}
+      while (p != newjob->pipe);
+
+      newjob->state = any_alive ? JRUNNING : (any_stopped ? JSTOPPED : JDEAD);
+      newjob->wd = job_working_directory ();
+      newjob->deferred = deferred;
+
+      newjob->j_cleanup = (sh_vptrfunc_t *)NULL;
+      newjob->cleanarg = (PTR_T) NULL;
+
+      jobs[i] = newjob;
+      if (newjob->state == JDEAD && (newjob->flags & J_FOREGROUND))
+	setjstatus (i);
+    }
+  else
+    newjob = (JOB *)NULL;
+
+  if (async)
+    {
+      if (newjob)
+	newjob->flags &= ~J_FOREGROUND;
+      reset_current ();
+    }
+  else
+    {
+      if (newjob)
+	{
+	  newjob->flags |= J_FOREGROUND;
+	  /*
+	   *		!!!!! NOTE !!!!!  (chet@ins.cwru.edu)
+	   *
+	   * The currently-accepted job control wisdom says to set the
+	   * terminal's process group n+1 times in an n-step pipeline:
+	   * once in the parent and once in each child.  This is where
+	   * the parent gives it away.
+	   *
+	   */
+	  if (job_control && newjob->pgrp)
+	    give_terminal_to (newjob->pgrp, 0);
+	}
+    }
+
+  stop_making_children ();
+  UNBLOCK_CHILD (oset);
+  return (current_job);
+}
+
+/* Delete all DEAD jobs that the user had received notification about. */
+static void
+cleanup_dead_jobs ()
+{
+  register int i;
+  int os;
+
+  if (job_slots == 0 || jobs_list_frozen)
+    return;
+
+  QUEUE_SIGCHLD(os);
+
+  for (i = 0; i < job_slots; i++)
+    if (jobs[i] && DEADJOB (i) && IS_NOTIFIED (i))
+      delete_job (i, 0);
+
+  UNQUEUE_SIGCHLD(os);
+}
+
+/* Compact the jobs list by removing dead jobs.  Assumed that we have filled
+   the jobs array to some predefined maximum.  Called when the shell is not
+   the foreground process (subshell_environment != 0).  Returns the first
+   available slot in the compacted list.  If that value is job_slots, then
+   the list needs to be reallocated.  The jobs array is in new memory if
+   this returns > 0 and < job_slots.  FLAGS is reserved for future use. */
+static int
+compact_jobs_list (flags)
+     int flags;
+{
+  sigset_t set, oset;
+  register int i, j;
+  int nremove, ndel;
+  JOB **newlist;
+
+  if (job_slots == 0 || jobs_list_frozen)
+    return job_slots;
+
+  if (child_max < 0)
+    child_max = getmaxchild ();
+
+  /* Take out at most a quarter of the jobs in the jobs array, but leave at
+     least child_max */
+  nremove = job_slots >> 2;
+  if ((job_slots - nremove) < child_max)
+    nremove = job_slots - child_max;
+
+  /* need to increase jobs list to at least CHILD_MAX entries */
+  if (nremove < 0)
+    return job_slots;
+
+  BLOCK_CHILD (set, oset);  
+
+  for (ndel = i = 0; i < job_slots; i++)
+    if (jobs[i])
+      {
+	if (DEADJOB (i) && (find_last_pid (i, 0) != last_asynchronous_pid))
+	  {
+	    delete_job (i, 0);
+	    ndel++;
+	    if (ndel == nremove)
+	      break;
+	  }
+      }
+
+  if (ndel == 0)
+    {
+      UNBLOCK_CHILD (oset);
+      return job_slots;
+    }
+
+  newlist = (JOB **)xmalloc ((1 + job_slots) * sizeof (JOB *));
+  for (i = j = 0; i < job_slots; i++)
+    if (jobs[i])
+      newlist[j++] = jobs[i];
+
+  ndel = j;
+  for ( ; j < job_slots; j++)
+    newlist[j] = (JOB *)NULL;
+
+  free (jobs);
+  jobs = newlist;
+
+  UNBLOCK_CHILD (oset);
+
+  return ndel;
+}
+
+/* Delete the job at INDEX from the job list.  Must be called
+   with SIGCHLD blocked. */
+void
+delete_job (job_index, warn_stopped)
+     int job_index, warn_stopped;
+{
+  register JOB *temp;
+
+  if (job_slots == 0 || jobs_list_frozen)
+    return;
+
+  if (warn_stopped && subshell_environment == 0 && STOPPED (job_index))
+    internal_warning (_("deleting stopped job %d with process group %ld"), job_index+1, (long)jobs[job_index]->pgrp);
+
+  temp = jobs[job_index];
+  if (job_index == current_job || job_index == previous_job)
+    reset_current ();
+
+  jobs[job_index] = (JOB *)NULL;
+
+  free (temp->wd);
+  discard_pipeline (temp->pipe);
+
+  if (temp->deferred)
+    dispose_command (temp->deferred);
+
+  free (temp);
+}
+
+/* Must be called with SIGCHLD blocked. */
+void
+nohup_job (job_index)
+     int job_index;
+{
+  register JOB *temp;
+
+  if (job_slots == 0)
+    return;
+
+  if (temp = jobs[job_index])
+    temp->flags |= J_NOHUP;
+}
+
+/* Get rid of the data structure associated with a process chain. */
+static void
+discard_pipeline (chain)
+     register PROCESS *chain;
+{
+  register PROCESS *this, *next;
+
+  this = chain;
+  do
+    {
+      next = this->next;
+      FREE (this->command);
+      free (this);
+      this = next;
+    }
+  while (this != chain);
+}
+
+/* Add this process to the chain being built in the_pipeline.
+   NAME is the command string that will be exec'ed later.
+   PID is the process id of the child. */
+static void
+add_process (name, pid)
+     char *name;
+     pid_t pid;
+{
+  PROCESS *t, *p;
+
+  t = (PROCESS *)xmalloc (sizeof (PROCESS));
+  t->next = the_pipeline;
+  t->pid = pid;
+  WSTATUS (t->status) = 0;
+  t->running = PS_RUNNING;
+  t->command = name;
+  the_pipeline = t;
+
+  if (t->next == 0)
+    t->next = t;
+  else
+    {
+      p = t->next;
+      while (p->next != t->next)
+	p = p->next;
+      p->next = t;
+    }
+}
+
+#if 0
+/* Take the last job and make it the first job.  Must be called with
+   SIGCHLD blocked. */
+int
+rotate_the_pipeline ()
+{
+  PROCESS *p;
+
+  if (the_pipeline->next == the_pipeline)
+    return;
+  for (p = the_pipeline; p->next != the_pipeline; p = p->next)
+    ;
+  the_pipeline = p;
+}
+
+/* Reverse the order of the processes in the_pipeline.  Must be called with
+   SIGCHLD blocked. */
+int
+reverse_the_pipeline ()
+{
+  PROCESS *p, *n;
+
+  if (the_pipeline->next == the_pipeline)
+    return;
+
+  for (p = the_pipeline; p->next != the_pipeline; p = p->next)
+    ;
+  p->next = (PROCESS *)NULL;
+
+  n = REVERSE_LIST (the_pipeline, PROCESS *);
+
+  the_pipeline = n;
+  for (p = the_pipeline; p->next; p = p->next)
+    ;
+  p->next = the_pipeline;
+}
+#endif
+
+/* Map FUNC over the list of jobs.  If FUNC returns non-zero,
+   then it is time to stop mapping, and that is the return value
+   for map_over_jobs.  FUNC is called with a JOB, arg1, arg2,
+   and INDEX. */
+static int
+map_over_jobs (func, arg1, arg2)
+     sh_job_map_func_t *func;
+     int arg1, arg2;
+{
+  register int i;
+  int result;
+  sigset_t set, oset;
+
+  if (job_slots == 0)
+    return 0;
+
+  BLOCK_CHILD (set, oset);
+
+  for (i = result = 0; i < job_slots; i++)
+    {
+      if (jobs[i])
+	{
+	  result = (*func)(jobs[i], arg1, arg2, i);
+	  if (result)
+	    break;
+	}
+    }
+
+  UNBLOCK_CHILD (oset);
+
+  return (result);
+}
+
+/* Cause all the jobs in the current pipeline to exit. */
+void
+terminate_current_pipeline ()
+{
+  if (pipeline_pgrp && pipeline_pgrp != shell_pgrp)
+    {
+      killpg (pipeline_pgrp, SIGTERM);
+      killpg (pipeline_pgrp, SIGCONT);
+    }
+}
+
+/* Cause all stopped jobs to exit. */
+void
+terminate_stopped_jobs ()
+{
+  register int i;
+
+  for (i = 0; i < job_slots; i++)
+    {
+      if (jobs[i] && STOPPED (i))
+	{
+	  killpg (jobs[i]->pgrp, SIGTERM);
+	  killpg (jobs[i]->pgrp, SIGCONT);
+	}
+    }
+}
+
+/* Cause all jobs, running or stopped, to receive a hangup signal.  If
+   a job is marked J_NOHUP, don't send the SIGHUP. */
+void
+hangup_all_jobs ()
+{
+  register int i;
+
+  for (i = 0; i < job_slots; i++)
+    {
+      if (jobs[i])
+	{
+	  if  ((jobs[i]->flags & J_NOHUP) == 0)
+	    killpg (jobs[i]->pgrp, SIGHUP);
+	  if (STOPPED (i))
+	    killpg (jobs[i]->pgrp, SIGCONT);
+	}
+    }
+}
+
+void
+kill_current_pipeline ()
+{
+  stop_making_children ();
+  start_pipeline ();
+}
+
+/* Return the pipeline that PID belongs to.  Note that the pipeline
+   doesn't have to belong to a job.  Must be called with SIGCHLD blocked. */
+static PROCESS *
+find_pipeline (pid, running_only, jobp)
+     pid_t pid;
+     int running_only;
+     int *jobp;		/* index into jobs list or NO_JOB */
+{
+  int job;
+  register PROCESS *p;
+
+  /* See if this process is in the pipeline that we are building. */
+  if (jobp)
+    *jobp = NO_JOB;
+  if (the_pipeline)
+    {
+      p = the_pipeline;
+      do
+	{
+	  /* Return it if we found it. */
+	  if (p->pid == pid)
+	    {
+	      if ((running_only && PRUNNING(p)) || (running_only == 0))
+		return (p);
+	    }
+
+	  p = p->next;
+	}
+      while (p != the_pipeline);
+    }
+
+  job = find_job (pid, running_only);
+  if (jobp)
+    *jobp = job;
+  return (job == NO_JOB) ? (PROCESS *)NULL : jobs[job]->pipe;
+}
+
+/* Return the job index that PID belongs to, or NO_JOB if it doesn't
+   belong to any job.  Must be called with SIGCHLD blocked. */
+static int
+find_job (pid, running_only)
+     pid_t pid;
+     int running_only;
+{
+  register int i;
+  register PROCESS *p;
+
+  for (i = 0; i < job_slots; i++)
+    {
+      if (jobs[i])
+	{
+	  p = jobs[i]->pipe;
+
+	  do
+	    {
+	      if (p->pid == pid)
+		{
+		  if ((running_only && PRUNNING(p)) || (running_only == 0))
+		    return (i);
+		}
+
+	      p = p->next;
+	    }
+	  while (p != jobs[i]->pipe);
+	}
+    }
+
+  return (NO_JOB);
+}
+
+/* Find a job given a PID.  If BLOCK is non-zero, block SIGCHLD as
+   required by find_job. */
+int
+get_job_by_pid (pid, block)
+     pid_t pid;
+     int block;
+{
+  int job;
+  sigset_t set, oset;
+
+  if (block)
+    BLOCK_CHILD (set, oset);
+
+  job = find_job (pid, 0);
+
+  if (block)
+    UNBLOCK_CHILD (oset);
+
+  return job;
+}
+
+/* Print descriptive information about the job with leader pid PID. */
+void
+describe_pid (pid)
+     pid_t pid;
+{
+  int job;
+  sigset_t set, oset;
+
+  BLOCK_CHILD (set, oset);
+
+  job = find_job (pid, 0);
+
+  if (job != NO_JOB)
+    printf ("[%d] %ld\n", job + 1, (long)pid);
+  else
+    programming_error (_("describe_pid: %ld: no such pid"), (long)pid);
+
+  UNBLOCK_CHILD (oset);
+}
+
+static char *
+j_strsignal (s)
+     int s;
+{
+  char *x;
+
+  x = strsignal (s);
+  if (x == 0)
+    {
+      x = retcode_name_buffer;
+      sprintf (x, "Signal %d", s);
+    }
+  return x;
+}
+
+static char *
+printable_job_status (j, p, format)
+     int j;
+     PROCESS *p;
+     int format;
+{
+  static char *temp;
+  int es;
+
+  temp = "Done";
+
+  if (STOPPED (j) && format == 0)
+    {
+      if (posixly_correct == 0 || p == 0 || (WIFSTOPPED (p->status) == 0))
+	temp = "Stopped";
+      else
+	{
+	  temp = retcode_name_buffer;
+	  sprintf (temp, "Stopped(%s)", signal_name (WSTOPSIG (p->status)));
+	}
+    }
+  else if (RUNNING (j))
+    temp = "Running";
+  else
+    {
+      if (WIFSTOPPED (p->status))
+	temp = j_strsignal (WSTOPSIG (p->status));
+      else if (WIFSIGNALED (p->status))
+	temp = j_strsignal (WTERMSIG (p->status));
+      else if (WIFEXITED (p->status))
+	{
+	  temp = retcode_name_buffer;
+	  es = WEXITSTATUS (p->status);
+	  if (es == 0)
+	    strcpy (temp, "Done");
+	  else if (posixly_correct)
+	    sprintf (temp, "Done(%d)", es);
+	  else
+	    sprintf (temp, "Exit %d", es);
+	}
+      else
+	temp = "Unknown status";
+    }
+
+  return temp;
+}
+
+/* This is the way to print out information on a job if you
+   know the index.  FORMAT is:
+
+    JLIST_NORMAL)   [1]+ Running	   emacs
+    JLIST_LONG  )   [1]+ 2378 Running      emacs
+    -1	  )   [1]+ 2378	      emacs
+
+    JLIST_NORMAL)   [1]+ Stopped	   ls | more
+    JLIST_LONG  )   [1]+ 2369 Stopped      ls
+			 2367	    | more
+    JLIST_PID_ONLY)
+	Just list the pid of the process group leader (really
+	the process group).
+    JLIST_CHANGED_ONLY)
+	Use format JLIST_NORMAL, but list only jobs about which
+	the user has not been notified. */
+
+/* Print status for pipeline P.  If JOB_INDEX is >= 0, it is the index into
+   the JOBS array corresponding to this pipeline.  FORMAT is as described
+   above.  Must be called with SIGCHLD blocked.
+
+   If you're printing a pipeline that's not in the jobs array, like the
+   current pipeline as it's being created, pass -1 for JOB_INDEX */
+static void
+print_pipeline (p, job_index, format, stream)
+     PROCESS *p;
+     int job_index, format;
+     FILE *stream;
+{
+  PROCESS *first, *last, *show;
+  int es, name_padding;
+  char *temp;
+
+  if (p == 0)
+    return;
+
+  first = last = p;
+  while (last->next != first)
+    last = last->next;
+
+  for (;;)
+    {
+      if (p != first)
+	fprintf (stream, format ? "     " : " |");
+
+      if (format != JLIST_STANDARD)
+	fprintf (stream, "%5ld", (long)p->pid);
+
+      fprintf (stream, " ");
+
+      if (format > -1 && job_index >= 0)
+	{
+	  show = format ? p : last;
+	  temp = printable_job_status (job_index, show, format);
+
+	  if (p != first)
+	    {
+	      if (format)
+		{
+		  if (show->running == first->running &&
+		      WSTATUS (show->status) == WSTATUS (first->status))
+		    temp = "";
+		}
+	      else
+		temp = (char *)NULL;
+	    }
+
+	  if (temp)
+	    {
+	      fprintf (stream, "%s", temp);
+
+	      es = STRLEN (temp);
+	      if (es == 0)
+		es = 2;	/* strlen ("| ") */
+	      name_padding = LONGEST_SIGNAL_DESC - es;
+
+	      fprintf (stream, "%*s", name_padding, "");
+
+	      if ((WIFSTOPPED (show->status) == 0) &&
+		  (WIFCONTINUED (show->status) == 0) &&
+		  WIFCORED (show->status))
+		fprintf (stream, "(core dumped) ");
+	    }
+	}
+
+      if (p != first && format)
+	fprintf (stream, "| ");
+
+      if (p->command)
+	fprintf (stream, "%s", p->command);
+
+      if (p == last && job_index >= 0)
+	{
+	  temp = current_working_directory ();
+
+	  if (RUNNING (job_index) && (IS_FOREGROUND (job_index) == 0))
+	    fprintf (stream, " &");
+
+	  if (strcmp (temp, jobs[job_index]->wd) != 0)
+	    fprintf (stream,
+	      "  (wd: %s)", polite_directory_format (jobs[job_index]->wd));
+	}
+
+      if (format || (p == last))
+	{
+	  /* We need to add a CR only if this is an interactive shell, and
+	     we're reporting the status of a completed job asynchronously.
+	     We can't really check whether this particular job is being
+	     reported asynchronously, so just add the CR if the shell is
+	     currently interactive and asynchronous notification is enabled. */
+	  if (asynchronous_notification && interactive)
+	    fprintf (stream, "\r\n");
+	  else
+	    fprintf (stream, "\n");
+	}
+
+      if (p == last)
+	break;
+      p = p->next;
+    }
+  fflush (stream);
+}
+
+/* Print information to STREAM about jobs[JOB_INDEX] according to FORMAT.
+   Must be called with SIGCHLD blocked or queued with queue_sigchld */
+static void
+pretty_print_job (job_index, format, stream)
+     int job_index, format;
+     FILE *stream;
+{
+  register PROCESS *p;
+
+  /* Format only pid information about the process group leader? */
+  if (format == JLIST_PID_ONLY)
+    {
+      fprintf (stream, "%ld\n", (long)jobs[job_index]->pipe->pid);
+      return;
+    }
+
+  if (format == JLIST_CHANGED_ONLY)
+    {
+      if (IS_NOTIFIED (job_index))
+	return;
+      format = JLIST_STANDARD;
+    }
+
+  if (format != JLIST_NONINTERACTIVE)
+    fprintf (stream, "[%d]%c ", job_index + 1,
+	      (job_index == current_job) ? '+':
+		(job_index == previous_job) ? '-' : ' ');
+
+  if (format == JLIST_NONINTERACTIVE)
+    format = JLIST_LONG;
+
+  p = jobs[job_index]->pipe;
+
+  print_pipeline (p, job_index, format, stream);
+
+  /* We have printed information about this job.  When the job's
+     status changes, waitchld () sets the notification flag to 0. */
+  jobs[job_index]->flags |= J_NOTIFIED;
+}
+
+static int
+print_job (job, format, state, job_index)
+     JOB *job;
+     int format, state, job_index;
+{
+  if (state == -1 || (JOB_STATE)state == job->state)
+    pretty_print_job (job_index, format, stdout);
+  return (0);
+}
+
+void
+list_one_job (job, format, ignore, job_index)
+     JOB *job;
+     int format, ignore, job_index;
+{
+  pretty_print_job (job_index, format, stdout);
+}
+
+void
+list_stopped_jobs (format)
+     int format;
+{
+  cleanup_dead_jobs ();
+  map_over_jobs (print_job, format, (int)JSTOPPED);
+}
+
+void
+list_running_jobs (format)
+     int format;
+{
+  cleanup_dead_jobs ();
+  map_over_jobs (print_job, format, (int)JRUNNING);
+}
+
+/* List jobs.  If FORMAT is non-zero, then the long form of the information
+   is printed, else just a short version. */
+void
+list_all_jobs (format)
+     int format;
+{
+  cleanup_dead_jobs ();
+  map_over_jobs (print_job, format, -1);
+}
+
+/* Fork, handling errors.  Returns the pid of the newly made child, or 0.
+   COMMAND is just for remembering the name of the command; we don't do
+   anything else with it.  ASYNC_P says what to do with the tty.  If
+   non-zero, then don't give it away. */
+pid_t
+make_child (command, async_p)
+     char *command;
+     int async_p;
+{
+  sigset_t set, oset;
+  pid_t pid;
+
+  sigemptyset (&set);
+  sigaddset (&set, SIGCHLD);
+  sigaddset (&set, SIGINT);
+  sigemptyset (&oset);
+  sigprocmask (SIG_BLOCK, &set, &oset);
+
+  making_children ();
+
+#if defined (BUFFERED_INPUT)
+  /* If default_buffered_input is active, we are reading a script.  If
+     the command is asynchronous, we have already duplicated /System/Devices/null
+     as fd 0, but have not changed the buffered stream corresponding to
+     the old fd 0.  We don't want to sync the stream in this case. */
+  if (default_buffered_input != -1 &&
+      (!async_p || default_buffered_input > 0))
+    sync_buffered_stream (default_buffered_input);
+#endif /* BUFFERED_INPUT */
+
+  /* Create the child, handle severe errors. */
+  if ((pid = fork ()) < 0)
+    {
+      sys_error ("fork");
+
+      /* Kill all of the processes in the current pipeline. */
+      terminate_current_pipeline ();
+
+      /* Discard the current pipeline, if any. */
+      if (the_pipeline)
+	kill_current_pipeline ();
+
+      throw_to_top_level ();	/* Reset signals, etc. */
+    }
+
+  if (pid == 0)
+    {
+      /* In the child.  Give this child the right process group, set the
+	 signals to the default state for a new process. */
+      pid_t mypid;
+
+      mypid = getpid ();
+#if defined (BUFFERED_INPUT)
+      /* Close default_buffered_input if it's > 0.  We don't close it if it's
+	 0 because that's the file descriptor used when redirecting input,
+	 and it's wrong to close the file in that case. */
+      unset_bash_input (0);
+#endif /* BUFFERED_INPUT */
+
+      /* Restore top-level signal mask. */
+      sigprocmask (SIG_SETMASK, &top_level_mask, (sigset_t *)NULL);
+
+      if (job_control)
+	{
+	  /* All processes in this pipeline belong in the same
+	     process group. */
+
+	  if (pipeline_pgrp == 0)	/* This is the first child. */
+	    pipeline_pgrp = mypid;
+
+	  /* Check for running command in backquotes. */
+	  if (pipeline_pgrp == shell_pgrp)
+	    ignore_tty_job_signals ();
+	  else
+	    default_tty_job_signals ();
+
+	  /* Set the process group before trying to mess with the terminal's
+	     process group.  This is mandated by POSIX. */
+	  /* This is in accordance with the Posix 1003.1 standard,
+	     section B.7.2.4, which says that trying to set the terminal
+	     process group with tcsetpgrp() to an unused pgrp value (like
+	     this would have for the first child) is an error.  Section
+	     B.4.3.3, p. 237 also covers this, in the context of job control
+	     shells. */
+	  if (setpgid (mypid, pipeline_pgrp) < 0)
+	    sys_error ("child setpgid (%ld to %ld)", (long)mypid, (long)pipeline_pgrp);
+
+	  /* By convention (and assumption above), if
+	     pipeline_pgrp == shell_pgrp, we are making a child for
+	     command substitution.
+	     In this case, we don't want to give the terminal to the
+	     shell's process group (we could be in the middle of a
+	     pipeline, for example). */
+	  if (async_p == 0 && pipeline_pgrp != shell_pgrp)
+	    give_terminal_to (pipeline_pgrp, 0);
+
+#if defined (PGRP_PIPE)
+	  if (pipeline_pgrp == mypid)
+	    pipe_read (pgrp_pipe);
+#endif
+	}
+      else			/* Without job control... */
+	{
+	  if (pipeline_pgrp == 0)
+	    pipeline_pgrp = shell_pgrp;
+
+	  /* If these signals are set to SIG_DFL, we encounter the curious
+	     situation of an interactive ^Z to a running process *working*
+	     and stopping the process, but being unable to do anything with
+	     that process to change its state.  On the other hand, if they
+	     are set to SIG_IGN, jobs started from scripts do not stop when
+	     the shell running the script gets a SIGTSTP and stops. */
+
+	  default_tty_job_signals ();
+	}
+
+#if defined (PGRP_PIPE)
+      /* Release the process group pipe, since our call to setpgid ()
+	 is done.  The last call to pipe_close is done in stop_pipeline. */
+      pipe_close (pgrp_pipe);
+#endif /* PGRP_PIPE */
+
+      if (async_p)
+	last_asynchronous_pid = getpid ();
+    }
+  else
+    {
+      /* In the parent.  Remember the pid of the child just created
+	 as the proper pgrp if this is the first child. */
+
+      if (job_control)
+	{
+	  if (pipeline_pgrp == 0)
+	    {
+	      pipeline_pgrp = pid;
+	      /* Don't twiddle terminal pgrps in the parent!  This is the bug,
+		 not the good thing of twiddling them in the child! */
+	      /* give_terminal_to (pipeline_pgrp, 0); */
+	    }
+	  /* This is done on the recommendation of the Rationale section of
+	     the POSIX 1003.1 standard, where it discusses job control and
+	     shells.  It is done to avoid possible race conditions. (Ref.
+	     1003.1 Rationale, section B.4.3.3, page 236). */
+	  setpgid (pid, pipeline_pgrp);
+	}
+      else
+	{
+	  if (pipeline_pgrp == 0)
+	    pipeline_pgrp = shell_pgrp;
+	}
+
+      /* Place all processes into the jobs array regardless of the
+	 state of job_control. */
+      add_process (command, pid);
+
+      if (async_p)
+	last_asynchronous_pid = pid;
+
+      last_made_pid = pid;
+
+      /* Unblock SIGINT and SIGCHLD. */
+      sigprocmask (SIG_SETMASK, &oset, (sigset_t *)NULL);
+    }
+
+  return (pid);
+}
+
+/* These two functions are called only in child processes. */
+void
+ignore_tty_job_signals ()
+{
+  set_signal_handler (SIGTSTP, SIG_IGN);
+  set_signal_handler (SIGTTIN, SIG_IGN);
+  set_signal_handler (SIGTTOU, SIG_IGN);
+}
+
+void
+default_tty_job_signals ()
+{
+  set_signal_handler (SIGTSTP, SIG_DFL);
+  set_signal_handler (SIGTTIN, SIG_DFL);
+  set_signal_handler (SIGTTOU, SIG_DFL);
+}
+
+/* When we end a job abnormally, or if we stop a job, we set the tty to the
+   state kept in here.  When a job ends normally, we set the state in here
+   to the state of the tty. */
+
+static TTYSTRUCT shell_tty_info;
+
+#if defined (NEW_TTY_DRIVER)
+static struct tchars shell_tchars;
+static struct ltchars shell_ltchars;
+#endif /* NEW_TTY_DRIVER */
+
+#if defined (NEW_TTY_DRIVER) && defined (DRAIN_OUTPUT)
+/* Since the BSD tty driver does not allow us to change the tty modes
+   while simultaneously waiting for output to drain and preserving
+   typeahead, we have to drain the output ourselves before calling
+   ioctl.  We cheat by finding the length of the output queue, and
+   using select to wait for an appropriate length of time.  This is
+   a hack, and should be labeled as such (it's a hastily-adapted
+   mutation of a `usleep' implementation).  It's only reason for
+   existing is the flaw in the BSD tty driver. */
+
+static int ttspeeds[] =
+{
+  0, 50, 75, 110, 134, 150, 200, 300, 600, 1200,
+  1800, 2400, 4800, 9600, 19200, 38400
+};
+
+static void
+draino (fd, ospeed)
+     int fd, ospeed;
+{
+  register int delay = ttspeeds[ospeed];
+  int n;
+
+  if (!delay)
+    return;
+
+  while ((ioctl (fd, TIOCOUTQ, &n) == 0) && n)
+    {
+      if (n > (delay / 100))
+	{
+	  struct timeval tv;
+
+	  n *= 10;		/* 2 bits more for conservativeness. */
+	  tv.tv_sec = n / delay;
+	  tv.tv_usec = ((n % delay) * 1000000) / delay;
+	  select (fd, (fd_set *)0, (fd_set *)0, (fd_set *)0, &tv);
+	}
+      else
+	break;
+    }
+}
+#endif /* NEW_TTY_DRIVER && DRAIN_OUTPUT */
+
+/* Return the fd from which we are actually getting input. */
+#define input_tty() (shell_tty != -1) ? shell_tty : fileno (stderr)
+
+/* Fill the contents of shell_tty_info with the current tty info. */
+int
+get_tty_state ()
+{
+  int tty;
+
+  tty = input_tty ();
+  if (tty != -1)
+    {
+#if defined (NEW_TTY_DRIVER)
+      ioctl (tty, TIOCGETP, &shell_tty_info);
+      ioctl (tty, TIOCGETC, &shell_tchars);
+      ioctl (tty, TIOCGLTC, &shell_ltchars);
+#endif /* NEW_TTY_DRIVER */
+
+#if defined (TERMIO_TTY_DRIVER)
+      ioctl (tty, TCGETA, &shell_tty_info);
+#endif /* TERMIO_TTY_DRIVER */
+
+#if defined (TERMIOS_TTY_DRIVER)
+      if (tcgetattr (tty, &shell_tty_info) < 0)
+	{
+#if 0
+	  /* Only print an error message if we're really interactive at
+	     this time. */
+	  if (interactive)
+	    sys_error ("[%ld: %d] tcgetattr", (long)getpid (), shell_level);
+#endif
+	  return -1;
+	}
+#endif /* TERMIOS_TTY_DRIVER */
+      if (check_window_size)
+	get_new_window_size (0);
+    }
+  return 0;
+}
+
+/* Make the current tty use the state in shell_tty_info. */
+int
+set_tty_state ()
+{
+  int tty;
+
+  tty = input_tty ();
+  if (tty != -1)
+    {
+#if defined (NEW_TTY_DRIVER)
+#  if defined (DRAIN_OUTPUT)
+      draino (tty, shell_tty_info.sg_ospeed);
+#  endif /* DRAIN_OUTPUT */
+      ioctl (tty, TIOCSETN, &shell_tty_info);
+      ioctl (tty, TIOCSETC, &shell_tchars);
+      ioctl (tty, TIOCSLTC, &shell_ltchars);
+#endif /* NEW_TTY_DRIVER */
+
+#if defined (TERMIO_TTY_DRIVER)
+      ioctl (tty, TCSETAW, &shell_tty_info);
+#endif /* TERMIO_TTY_DRIVER */
+
+#if defined (TERMIOS_TTY_DRIVER)
+      if (tcsetattr (tty, TCSADRAIN, &shell_tty_info) < 0)
+	{
+	  /* Only print an error message if we're really interactive at
+	     this time. */
+	  if (interactive)
+	    sys_error ("[%ld: %d] tcsetattr", (long)getpid (), shell_level);
+	  return -1;
+	}
+#endif /* TERMIOS_TTY_DRIVER */
+    }
+  return 0;
+}
+
+/* Given an index into the jobs array JOB, return the pid of the last
+   process in that job's pipeline.  This is the one whose exit status
+   counts.  Must be called with SIGCHLD blocked or queued. */
+static pid_t
+find_last_pid (job, block)
+     int job;
+     int block;
+{
+  register PROCESS *p;
+  sigset_t set, oset;
+
+  if (block)
+    BLOCK_CHILD (set, oset);
+
+  p = jobs[job]->pipe;
+  while (p->next != jobs[job]->pipe)
+    p = p->next;
+
+  if (block)
+    UNBLOCK_CHILD (oset);
+
+  return (p->pid);
+}
+
+/* Wait for a particular child of the shell to finish executing.
+   This low-level function prints an error message if PID is not
+   a child of this shell.  It returns -1 if it fails, or whatever
+   wait_for returns otherwise.  If the child is not found in the
+   jobs table, it returns 127. */
+int
+wait_for_single_pid (pid)
+     pid_t pid;
+{
+  register PROCESS *child;
+  sigset_t set, oset;
+  int r, job;
+
+  BLOCK_CHILD (set, oset);
+  child = find_pipeline (pid, 0, (int *)NULL);
+  UNBLOCK_CHILD (oset);
+
+  if (child == 0)
+    {
+      internal_error (_("wait: pid %ld is not a child of this shell"), (long)pid);
+      return (127);
+    }
+
+  r = wait_for (pid);
+
+  /* POSIX.2: if we just waited for a job, we can remove it from the jobs
+     table. */
+  BLOCK_CHILD (set, oset);
+  job = find_job (pid, 0);
+  if (job != NO_JOB && jobs[job] && DEADJOB (job))
+    jobs[job]->flags |= J_NOTIFIED;
+  UNBLOCK_CHILD (oset);
+
+  return r;
+}
+
+/* Wait for all of the backgrounds of this shell to finish. */
+void
+wait_for_background_pids ()
+{
+  register int i, r, waited_for;
+  sigset_t set, oset;
+  pid_t pid;
+
+  for (waited_for = 0;;)
+    {
+      BLOCK_CHILD (set, oset);
+
+      /* find first running job; if none running in foreground, break */
+      for (i = 0; i < job_slots; i++)
+	if (jobs[i] && RUNNING (i) && IS_FOREGROUND (i) == 0)
+	  break;
+
+      if (i == job_slots)
+	{
+	  UNBLOCK_CHILD (oset);
+	  break;
+	}
+
+      /* now wait for the last pid in that job. */
+      pid = find_last_pid (i, 0);
+      UNBLOCK_CHILD (oset);
+      QUIT;
+      errno = 0;		/* XXX */
+      r = wait_for_single_pid (pid);
+      if (r == -1)
+	{
+	  /* If we're mistaken about job state, compensate. */
+	  if (errno == ECHILD)
+	    mark_all_jobs_as_dead ();
+	}
+      else
+	waited_for++;
+    }
+
+  /* POSIX.2 says the shell can discard the statuses of all completed jobs if
+     `wait' is called with no arguments. */
+  mark_dead_jobs_as_notified (1);
+  cleanup_dead_jobs ();
+}
+
+/* Make OLD_SIGINT_HANDLER the SIGINT signal handler. */
+#define INVALID_SIGNAL_HANDLER (SigHandler *)wait_for_background_pids
+static SigHandler *old_sigint_handler = INVALID_SIGNAL_HANDLER;
+
+static void
+restore_sigint_handler ()
+{
+  if (old_sigint_handler != INVALID_SIGNAL_HANDLER)
+    {
+      set_signal_handler (SIGINT, old_sigint_handler);
+      old_sigint_handler = INVALID_SIGNAL_HANDLER;
+    }
+}
+
+static int wait_sigint_received;
+
+/* Handle SIGINT while we are waiting for children in a script to exit.
+   The `wait' builtin should be interruptible, but all others should be
+   effectively ignored (i.e. not cause the shell to exit). */
+static sighandler
+wait_sigint_handler (sig)
+     int sig;
+{
+  SigHandler *sigint_handler;
+
+  if (interrupt_immediately ||
+      (this_shell_builtin && this_shell_builtin == wait_builtin))
+    {
+      last_command_exit_value = EXECUTION_FAILURE;
+      restore_sigint_handler ();
+      /* If we got a SIGINT while in `wait', and SIGINT is trapped, do
+	 what POSIX.2 says (see builtins/wait.def for more info). */
+      if (this_shell_builtin && this_shell_builtin == wait_builtin &&
+	  signal_is_trapped (SIGINT) &&
+	  ((sigint_handler = trap_to_sighandler (SIGINT)) == trap_handler))
+	{
+	  interrupt_immediately = 0;
+	  trap_handler (SIGINT);	/* set pending_traps[SIGINT] */
+	  wait_signal_received = SIGINT;
+	  longjmp (wait_intr_buf, 1);
+	}
+      
+      ADDINTERRUPT;
+      QUIT;
+    }
+
+  /* XXX - should this be interrupt_state?  If it is, the shell will act
+     as if it got the SIGINT interrupt. */
+  wait_sigint_received = 1;
+
+  /* Otherwise effectively ignore the SIGINT and allow the running job to
+     be killed. */
+  SIGRETURN (0);
+}
+
+static int
+process_exit_signal (status)
+     WAIT status;
+{
+  return (WIFSIGNALED (status) ? WTERMSIG (status) : 0);
+}
+
+static int
+process_exit_status (status)
+     WAIT status;
+{
+  if (WIFSIGNALED (status))
+    return (128 + WTERMSIG (status));
+  else if (WIFSTOPPED (status) == 0)
+    return (WEXITSTATUS (status));
+  else
+    return (EXECUTION_SUCCESS);
+}
+
+/* Return the exit status of the last process in the pipeline for job JOB.
+   This is the exit status of the entire job. */
+static WAIT
+raw_job_exit_status (job)
+     int job;
+{
+  register PROCESS *p;
+  int fail;
+
+  if (pipefail_opt)
+    {
+      fail = 0;
+      for (p = jobs[job]->pipe; p->next != jobs[job]->pipe; p = p->next)
+        if (p->status != EXECUTION_SUCCESS) fail = p->status;
+      return fail;
+    }
+
+  for (p = jobs[job]->pipe; p->next != jobs[job]->pipe; p = p->next)
+    ;
+  return (p->status);
+}
+
+/* Return the exit status of job JOB.  This is the exit status of the last
+   (rightmost) process in the job's pipeline, modified if the job was killed
+   by a signal or stopped. */
+static int
+job_exit_status (job)
+     int job;
+{
+  return (process_exit_status (raw_job_exit_status (job)));
+}
+
+static int
+job_exit_signal (job)
+     int job;
+{
+  return (process_exit_signal (raw_job_exit_status (job)));
+}
+
+#define FIND_CHILD(pid, child) \
+  do \
+    { \
+      child = find_pipeline (pid, 0, (int *)NULL); \
+      if (child == 0) \
+	{ \
+	  give_terminal_to (shell_pgrp, 0); \
+	  UNBLOCK_CHILD (oset); \
+	  internal_error (_("wait_for: No record of process %ld"), (long)pid); \
+	  restore_sigint_handler (); \
+	  return (termination_state = 127); \
+	} \
+    } \
+  while (0)
+
+/* Wait for pid (one of our children) to terminate, then
+   return the termination state.  Returns 127 if PID is not found in
+   the jobs table.  Returns -1 if waitchld() returns -1, indicating
+   that there are no unwaited-for child processes. */
+int
+wait_for (pid)
+     pid_t pid;
+{
+  int job, termination_state, r;
+  WAIT s;
+  register PROCESS *child;
+  sigset_t set, oset;
+  register PROCESS *p;
+
+  /* In the case that this code is interrupted, and we longjmp () out of it,
+     we are relying on the code in throw_to_top_level () to restore the
+     top-level signal mask. */
+  BLOCK_CHILD (set, oset);
+
+  /* Ignore interrupts while waiting for a job run without job control
+     to finish.  We don't want the shell to exit if an interrupt is
+     received, only if one of the jobs run is killed via SIGINT.  If
+     job control is not set, the job will be run in the same pgrp as
+     the shell, and the shell will see any signals the job gets. */
+
+  /* This is possibly a race condition -- should it go in stop_pipeline? */
+  wait_sigint_received = 0;
+  if (job_control == 0)
+    old_sigint_handler = set_signal_handler (SIGINT, wait_sigint_handler);
+
+  termination_state = last_command_exit_value;
+
+  if (interactive && job_control == 0)
+    QUIT;
+
+  /* If we say wait_for (), then we have a record of this child somewhere.
+     If it and none of its peers are running, don't call waitchld(). */
+
+  job = NO_JOB;
+  do
+    {
+      FIND_CHILD (pid, child);
+
+      /* If this child is part of a job, then we are really waiting for the
+	 job to finish.  Otherwise, we are waiting for the child to finish.
+	 We check for JDEAD in case the job state has been set by waitchld
+	 after receipt of a SIGCHLD. */
+      if (job == NO_JOB)
+	job = find_job (pid, 0);
+
+      /* waitchld() takes care of setting the state of the job.  If the job
+	 has already exited before this is called, sigchld_handler will have
+	 called waitchld and the state will be set to JDEAD. */
+
+      if (child->running || (job != NO_JOB && RUNNING (job)))
+	{
+#if defined (WAITPID_BROKEN)    /* SCOv4 */
+	  sigset_t suspend_set;
+	  sigemptyset (&suspend_set);
+	  sigsuspend (&suspend_set);
+#else /* !WAITPID_BROKEN */
+#  if defined (MUST_UNBLOCK_CHLD)
+	  struct sigaction act, oact;
+	  sigset_t nullset, chldset;
+
+	  sigemptyset (&nullset);
+	  sigemptyset (&chldset);
+	  sigprocmask (SIG_SETMASK, &nullset, &chldset);
+	  act.sa_handler = SIG_DFL;
+	  sigemptyset (&act.sa_mask);
+	  sigemptyset (&oact.sa_mask);
+	  act.sa_flags = 0;
+	  sigaction (SIGCHLD, &act, &oact);
+#  endif
+	  queue_sigchld = 1;
+	  r = waitchld (pid, 1);
+#  if defined (MUST_UNBLOCK_CHLD)
+	  sigaction (SIGCHLD, &oact, (struct sigaction *)NULL);
+	  sigprocmask (SIG_SETMASK, &chldset, (sigset_t *)NULL);
+#  endif
+	  queue_sigchld = 0;
+	  if (r == -1 && errno == ECHILD && this_shell_builtin == wait_builtin)
+	    {
+	      termination_state = -1;
+	      goto wait_for_return;
+	    }
+
+	  /* If child is marked as running, but waitpid() returns -1/ECHILD,
+	     there is something wrong.  Somewhere, wait should have returned
+	     that child's pid.  Mark the child as not running and the job,
+	     if it exists, as JDEAD. */
+	  if (r == -1 && errno == ECHILD)
+	    {
+	      child->running = PS_DONE;
+	      child->status = 0;	/* XXX -- can't find true status */
+	      if (job != NO_JOB)
+		jobs[job]->state = JDEAD;
+	    }
+#endif /* WAITPID_BROKEN */
+	}
+
+      /* If the shell is interactive, and job control is disabled, see
+	 if the foreground process has died due to SIGINT and jump out
+	 of the wait loop if it has.  waitchld has already restored the
+	 old SIGINT signal handler. */
+      if (interactive && job_control == 0)
+	QUIT;
+    }
+  while (child->running || (job != NO_JOB && RUNNING (job)));
+
+  /* The exit state of the command is either the termination state of the
+     child, or the termination state of the job.  If a job, the status
+     of the last child in the pipeline is the significant one.  If the command
+     or job was terminated by a signal, note that value also. */
+  termination_state = (job != NO_JOB) ? job_exit_status (job)
+				      : process_exit_status (child->status);
+  last_command_exit_signal = (job != NO_JOB) ? job_exit_signal (job)
+					     : process_exit_signal (child->status);
+
+  if (job == NO_JOB || IS_JOBCONTROL (job))
+    {
+      /* XXX - under what circumstances is a job not present in the jobs
+	 table (job == NO_JOB)?
+	 	1.  command substitution
+
+	 In the case of command substitution, at least, it's probably not
+	 the right thing to give the terminal to the shell's process group,
+	 even though there is code in subst.c:command_substitute to work
+	 around it.
+
+	 Things that don't:
+		$PROMPT_COMMAND execution
+		process substitution
+       */
+#if 0
+if (job == NO_JOB)
+  itrace("wait_for: job == NO_JOB, giving the terminal to shell_pgrp (%ld)", (long)shell_pgrp);
+#endif
+
+      give_terminal_to (shell_pgrp, 0);
+    }
+
+  /* If the command did not exit cleanly, or the job is just
+     being stopped, then reset the tty state back to what it
+     was before this command.  Reset the tty state and notify
+     the user of the job termination only if the shell is
+     interactive.  Clean up any dead jobs in either case. */
+  if (job != NO_JOB)
+    {
+      if (interactive_shell && subshell_environment == 0)
+	{
+	  /* This used to use `child->status'.  That's wrong, however, for
+	     pipelines.  `child' is the first process in the pipeline.  It's
+	     likely that the process we want to check for abnormal termination
+	     or stopping is the last process in the pipeline, especially if
+	     it's long-lived and the first process is short-lived.  Since we
+	     know we have a job here, we can check all the processes in this
+	     job's pipeline and see if one of them stopped or terminated due
+	     to a signal.  We might want to change this later to just check
+	     the last process in the pipeline.  If no process exits due to a
+	     signal, S is left as the status of the last job in the pipeline. */
+	  p = jobs[job]->pipe;
+	  do
+	    {
+	      s = p->status;
+	      if (WIFSIGNALED(s) || WIFSTOPPED(s))
+		break;
+	      p = p->next;
+	    }
+	  while (p != jobs[job]->pipe);
+
+	  if (WIFSIGNALED (s) || WIFSTOPPED (s))
+	    {
+	      set_tty_state ();
+
+	      /* If the current job was stopped or killed by a signal, and
+		 the user has requested it, get a possibly new window size */
+	      if (check_window_size && (job == current_job || IS_FOREGROUND (job)))
+		get_new_window_size (0);
+	    }
+	  else
+	    get_tty_state ();
+
+	  /* If job control is enabled, the job was started with job
+	     control, the job was the foreground job, and it was killed
+	     by SIGINT, then print a newline to compensate for the kernel
+	     printing the ^C without a trailing newline. */
+	  if (job_control && IS_JOBCONTROL (job) && IS_FOREGROUND (job) &&
+		WIFSIGNALED (s) && WTERMSIG (s) == SIGINT)
+	    {
+	      /* If SIGINT is not trapped and the shell is in a for, while,
+		 or until loop, act as if the shell received SIGINT as
+		 well, so the loop can be broken.  This doesn't call the
+		 SIGINT signal handler; maybe it should. */
+	      if (signal_is_trapped (SIGINT) == 0 && loop_level)
+		ADDINTERRUPT;
+	      else
+		{
+		  putchar ('\n');
+		  fflush (stdout);
+		}
+	    }
+	}
+
+      /* Moved here from set_job_status_and_cleanup, which is in the SIGCHLD
+         signal handler path */
+      if (DEADJOB (job) && IS_FOREGROUND (job) /*&& subshell_environment == 0*/)
+	setjstatus (job);
+
+      /* If this job is dead, notify the user of the status.  If the shell
+	 is interactive, this will display a message on the terminal.  If
+	 the shell is not interactive, make sure we turn on the notify bit
+	 so we don't get an unwanted message about the job's termination,
+	 and so delete_job really clears the slot in the jobs table. */
+      notify_and_cleanup ();
+    }
+
+wait_for_return:
+
+  UNBLOCK_CHILD (oset);
+
+  /* Restore the original SIGINT signal handler before we return. */
+  restore_sigint_handler ();
+
+  return (termination_state);
+}
+
+/* Wait for the last process in the pipeline for JOB.  Returns whatever
+   wait_for returns: the last process's termination state or -1 if there
+   are no unwaited-for child processes or an error occurs. */
+int
+wait_for_job (job)
+     int job;
+{
+  pid_t pid;
+  int r;
+  sigset_t set, oset;
+
+  BLOCK_CHILD(set, oset);
+  if (JOBSTATE (job) == JSTOPPED)
+    internal_warning (_("wait_for_job: job %d is stopped"), job+1);
+
+  pid = find_last_pid (job, 0);
+  UNBLOCK_CHILD(oset);
+  r = wait_for (pid);
+
+  /* POSIX.2: we can remove the job from the jobs table if we just waited
+     for it. */
+  BLOCK_CHILD (set, oset);
+  if (job != NO_JOB && jobs[job] && DEADJOB (job))
+    jobs[job]->flags |= J_NOTIFIED;
+  UNBLOCK_CHILD (oset);
+
+  return r;
+}
+
+/* Print info about dead jobs, and then delete them from the list
+   of known jobs.  This does not actually delete jobs when the
+   shell is not interactive, because the dead jobs are not marked
+   as notified. */
+void
+notify_and_cleanup ()
+{
+  if (jobs_list_frozen)
+    return;
+
+  if (interactive || interactive_shell == 0 || sourcelevel)
+    notify_of_job_status ();
+
+  cleanup_dead_jobs ();
+}
+
+/* Make dead jobs disappear from the jobs array without notification.
+   This is used when the shell is not interactive. */
+void
+reap_dead_jobs ()
+{
+  mark_dead_jobs_as_notified (0);
+  cleanup_dead_jobs ();
+}
+
+/* Return the next closest (chronologically) job to JOB which is in
+   STATE.  STATE can be JSTOPPED, JRUNNING.  NO_JOB is returned if
+   there is no next recent job. */
+static int
+most_recent_job_in_state (job, state)
+     int job;
+     JOB_STATE state;
+{
+  register int i, result;
+  sigset_t set, oset;
+
+  BLOCK_CHILD (set, oset);
+
+  for (result = NO_JOB, i = job - 1; i >= 0; i--)
+    {
+      if (jobs[i] && (JOBSTATE (i) == state))
+	{
+	  result = i;
+	  break;
+	}
+    }
+
+  UNBLOCK_CHILD (oset);
+
+  return (result);
+}
+
+/* Return the newest *stopped* job older than JOB, or NO_JOB if not
+   found. */
+static int
+job_last_stopped (job)
+     int job;
+{
+  return (most_recent_job_in_state (job, JSTOPPED));
+}
+
+/* Return the newest *running* job older than JOB, or NO_JOB if not
+   found. */
+static int
+job_last_running (job)
+     int job;
+{
+  return (most_recent_job_in_state (job, JRUNNING));
+}
+
+/* Make JOB be the current job, and make previous be useful.  Must be
+   called with SIGCHLD blocked. */
+static void
+set_current_job (job)
+     int job;
+{
+  int candidate;
+
+  if (current_job != job)
+    {
+      previous_job = current_job;
+      current_job = job;
+    }
+
+  /* First choice for previous_job is the old current_job. */
+  if (previous_job != current_job &&
+      previous_job != NO_JOB &&
+      jobs[previous_job] &&
+      STOPPED (previous_job))
+    return;
+
+  /* Second choice:  Newest stopped job that is older than
+     the current job. */
+  candidate = NO_JOB;
+  if (STOPPED (current_job))
+    {
+      candidate = job_last_stopped (current_job);
+
+      if (candidate != NO_JOB)
+	{
+	  previous_job = candidate;
+	  return;
+	}
+    }
+
+  /* If we get here, there is either only one stopped job, in which case it is
+     the current job and the previous job should be set to the newest running
+     job, or there are only running jobs and the previous job should be set to
+     the newest running job older than the current job.  We decide on which
+     alternative to use based on whether or not JOBSTATE(current_job) is
+     JSTOPPED. */
+
+  candidate = RUNNING (current_job) ? job_last_running (current_job)
+				    : job_last_running (job_slots);
+
+  if (candidate != NO_JOB)
+    {
+      previous_job = candidate;
+      return;
+    }
+
+  /* There is only a single job, and it is both `+' and `-'. */
+  previous_job = current_job;
+}
+
+/* Make current_job be something useful, if it isn't already. */
+
+/* Here's the deal:  The newest non-running job should be `+', and the
+   next-newest non-running job should be `-'.  If there is only a single
+   stopped job, the previous_job is the newest non-running job.  If there
+   are only running jobs, the newest running job is `+' and the
+   next-newest running job is `-'.  Must be called with SIGCHLD blocked. */
+
+static void
+reset_current ()
+{
+  int candidate;
+
+  if (job_slots && current_job != NO_JOB && jobs[current_job] && STOPPED (current_job))
+    candidate = current_job;
+  else
+    {
+      candidate = NO_JOB;
+
+      /* First choice: the previous job. */
+      if (previous_job != NO_JOB && jobs[previous_job] && STOPPED (previous_job))
+	candidate = previous_job;
+
+      /* Second choice: the most recently stopped job. */
+      if (candidate == NO_JOB)
+	candidate = job_last_stopped (job_slots);
+
+      /* Third choice: the newest running job. */
+      if (candidate == NO_JOB)
+	candidate = job_last_running (job_slots);
+    }
+
+  /* If we found a job to use, then use it.  Otherwise, there
+     are no jobs period. */
+  if (candidate != NO_JOB)
+    set_current_job (candidate);
+  else
+    current_job = previous_job = NO_JOB;
+}
+
+/* Set up the job structures so we know the job and its processes are
+   all running. */
+static void
+set_job_running (job)
+     int job;
+{
+  register PROCESS *p;
+
+  /* Each member of the pipeline is now running. */
+  p = jobs[job]->pipe;
+
+  do
+    {
+      if (WIFSTOPPED (p->status))
+	p->running = PS_RUNNING;	/* XXX - could be PS_STOPPED */
+      p = p->next;
+    }
+  while (p != jobs[job]->pipe);
+
+  /* This means that the job is running. */
+  JOBSTATE (job) = JRUNNING;
+}
+
+/* Start a job.  FOREGROUND if non-zero says to do that.  Otherwise,
+   start the job in the background.  JOB is a zero-based index into
+   JOBS.  Returns -1 if it is unable to start a job, and the return
+   status of the job otherwise. */
+int
+start_job (job, foreground)
+     int job, foreground;
+{
+  register PROCESS *p;
+  int already_running;
+  sigset_t set, oset;
+  char *wd;
+  static TTYSTRUCT save_stty;
+
+  BLOCK_CHILD (set, oset);
+
+  if (DEADJOB (job))
+    {
+      internal_error (_("%s: job has terminated"), this_command_name);
+      UNBLOCK_CHILD (oset);
+      return (-1);
+    }
+
+  already_running = RUNNING (job);
+
+  if (foreground == 0 && already_running)
+    {
+      internal_error (_("%s: job %d already in background"), this_command_name, job + 1);
+      UNBLOCK_CHILD (oset);
+      return (-1);
+    }
+
+  wd = current_working_directory ();
+
+  /* You don't know about the state of this job.  Do you? */
+  jobs[job]->flags &= ~J_NOTIFIED;
+
+  if (foreground)
+    {
+      set_current_job (job);
+      jobs[job]->flags |= J_FOREGROUND;
+    }
+
+  /* Tell the outside world what we're doing. */
+  p = jobs[job]->pipe;
+
+  if (foreground == 0)
+    fprintf (stderr, "[%d]%c ", job + 1,
+	   (job == current_job) ? '+': ((job == previous_job) ? '-' : ' '));
+
+  do
+    {
+      fprintf (stderr, "%s%s",
+	       p->command ? p->command : "",
+	       p->next != jobs[job]->pipe? " | " : "");
+      p = p->next;
+    }
+  while (p != jobs[job]->pipe);
+
+  if (foreground == 0)
+    fprintf (stderr, " &");
+
+  if (strcmp (wd, jobs[job]->wd) != 0)
+    fprintf (stderr, "	(wd: %s)", polite_directory_format (jobs[job]->wd));
+
+  fprintf (stderr, "\n");
+
+  /* Run the job. */
+  if (already_running == 0)
+    set_job_running (job);
+
+  /* Save the tty settings before we start the job in the foreground. */
+  if (foreground)
+    {
+      get_tty_state ();
+      save_stty = shell_tty_info;
+      /* Give the terminal to this job. */
+      if (IS_JOBCONTROL (job))
+	give_terminal_to (jobs[job]->pgrp, 0);
+    }
+  else
+    jobs[job]->flags &= ~J_FOREGROUND;
+
+  /* If the job is already running, then don't bother jump-starting it. */
+  if (already_running == 0)
+    {
+      jobs[job]->flags |= J_NOTIFIED;
+      killpg (jobs[job]->pgrp, SIGCONT);
+    }
+
+  if (foreground)
+    {
+      pid_t pid;
+      int s;
+
+      pid = find_last_pid (job, 0);
+      UNBLOCK_CHILD (oset);
+      s = wait_for (pid);
+      shell_tty_info = save_stty;
+      set_tty_state ();
+      return (s);
+    }
+  else
+    {
+      reset_current ();
+      UNBLOCK_CHILD (oset);
+      return (0);
+    }
+}
+
+/* Give PID SIGNAL.  This determines what job the pid belongs to (if any).
+   If PID does belong to a job, and the job is stopped, then CONTinue the
+   job after giving it SIGNAL.  Returns -1 on failure.  If GROUP is non-null,
+   then kill the process group associated with PID. */
+int
+kill_pid (pid, sig, group)
+     pid_t pid;
+     int sig, group;
+{
+  register PROCESS *p;
+  int job, result;
+  sigset_t set, oset;
+
+  result = EXECUTION_SUCCESS;
+  if (group)
+    {
+      BLOCK_CHILD (set, oset);
+      p = find_pipeline (pid, 0, &job);
+
+      if (job != NO_JOB)
+	{
+	  jobs[job]->flags &= ~J_NOTIFIED;
+
+	  /* Kill process in backquotes or one started without job control? */
+	  if (jobs[job]->pgrp == shell_pgrp)
+	    {
+	      p = jobs[job]->pipe;
+
+	      do
+		{
+		  kill (p->pid, sig);
+		  if (p->running == PS_DONE && (sig == SIGTERM || sig == SIGHUP))
+		    kill (p->pid, SIGCONT);
+		  p = p->next;
+		}
+	      while (p != jobs[job]->pipe);
+	    }
+	  else
+	    {
+	      result = killpg (jobs[job]->pgrp, sig);
+	      if (p && STOPPED (job) && (sig == SIGTERM || sig == SIGHUP))
+		killpg (jobs[job]->pgrp, SIGCONT);
+	      /* If we're continuing a stopped job via kill rather than bg or
+		 fg, emulate the `bg' behavior. */
+	      if (p && STOPPED (job) && (sig == SIGCONT))
+		{
+		  set_job_running (job);
+		  jobs[job]->flags &= ~J_FOREGROUND;
+		  jobs[job]->flags |= J_NOTIFIED;
+		}
+	    }
+	}
+      else
+	result = killpg (pid, sig);
+
+      UNBLOCK_CHILD (oset);
+    }
+  else
+    result = kill (pid, sig);
+
+  return (result);
+}
+
+/* sigchld_handler () flushes at least one of the children that we are
+   waiting for.  It gets run when we have gotten a SIGCHLD signal. */
+static sighandler
+sigchld_handler (sig)
+     int sig;
+{
+  int n, oerrno;
+
+  oerrno = errno;
+  REINSTALL_SIGCHLD_HANDLER;
+  sigchld++;
+  n = 0;
+  if (queue_sigchld == 0)
+    n = waitchld (-1, 0);
+  errno = oerrno;
+  SIGRETURN (n);
+}
+
+/* waitchld() reaps dead or stopped children.  It's called by wait_for and
+   sigchld_handler, and runs until there aren't any children terminating any
+   more.
+   If BLOCK is 1, this is to be a blocking wait for a single child, although
+   an arriving SIGCHLD could cause the wait to be non-blocking.  It returns
+   the number of children reaped, or -1 if there are no unwaited-for child
+   processes. */
+static int
+waitchld (wpid, block)
+     pid_t wpid;
+     int block;
+{
+  WAIT status;
+  PROCESS *child;
+  pid_t pid;
+  int call_set_current, last_stopped_job, job, children_exited, waitpid_flags;
+
+  call_set_current = children_exited = 0;
+  last_stopped_job = NO_JOB;
+
+  do
+    {
+      /* We don't want to be notified about jobs stopping if job control
+	 is not active.  XXX - was interactive_shell instead of job_control */
+      waitpid_flags = (job_control && subshell_environment == 0)
+			? (WUNTRACED|WCONTINUED)
+			: 0;
+      if (sigchld || block == 0)
+	waitpid_flags |= WNOHANG;
+      pid = WAITPID (-1, &status, waitpid_flags);
+
+      /* The check for WNOHANG is to make sure we decrement sigchld only
+	 if it was non-zero before we called waitpid. */
+      if (sigchld > 0 && (waitpid_flags & WNOHANG))
+	sigchld--;
+  
+      /* If waitpid returns -1 with errno == ECHILD, there are no more
+	 unwaited-for child processes of this shell. */
+      if (pid < 0 && errno == ECHILD)
+	{
+	  if (children_exited == 0)
+	    return -1;
+	  else
+	    break;
+	}
+
+      /* If waitpid returns 0, there are running children.  If it returns -1,
+	 the only other error POSIX says it can return is EINTR. */
+      if (pid <= 0)
+	continue;	/* jumps right to the test */
+
+      /* children_exited is used to run traps on SIGCHLD.  We don't want to
+         run the trap if a process is just being continued. */
+      if (WIFCONTINUED(status) == 0)
+	children_exited++;
+
+      /* Locate our PROCESS for this pid. */
+      child = find_pipeline (pid, 1, &job);	/* want running procs only */
+
+      /* It is not an error to have a child terminate that we did
+	 not have a record of.  This child could have been part of
+	 a pipeline in backquote substitution.  Even so, I'm not
+	 sure child is ever non-zero. */
+      if (child == 0)
+	continue;
+
+      while (child->pid != pid)
+	child = child->next;
+
+      /* Remember status, and whether or not the process is running. */
+      child->status = status;
+      child->running = WIFCONTINUED(status) ? PS_RUNNING : PS_DONE;
+
+      if (job == NO_JOB)
+	continue;
+
+      call_set_current += set_job_status_and_cleanup (job);
+
+      if (STOPPED (job))
+	last_stopped_job = job;
+      else if (DEADJOB (job) && last_stopped_job == job)
+	last_stopped_job = NO_JOB;
+    }
+  while ((sigchld || block == 0) && pid > (pid_t)0);
+
+  /* If a job was running and became stopped, then set the current
+     job.  Otherwise, don't change a thing. */
+  if (call_set_current)
+    {
+      if (last_stopped_job != NO_JOB)
+	set_current_job (last_stopped_job);
+      else
+	reset_current ();
+    }
+
+  /* Call a SIGCHLD trap handler for each child that exits, if one is set. */
+  if (job_control && signal_is_trapped (SIGCHLD) && children_exited &&
+      trap_list[SIGCHLD] != (char *)IGNORE_SIG)
+    run_sigchld_trap (children_exited);
+
+  /* We have successfully recorded the useful information about this process
+     that has just changed state.  If we notify asynchronously, and the job
+     that this process belongs to is no longer running, then notify the user
+     of that fact now. */
+  if (asynchronous_notification && interactive)
+    notify_of_job_status ();
+
+  return (children_exited);
+}
+
+/* Set the status of JOB and perform any necessary cleanup if the job is
+   marked as JDEAD.
+
+   Currently, the cleanup activity is restricted to handling any SIGINT
+   received while waiting for a foreground job to finish. */
+static int
+set_job_status_and_cleanup (job)
+     int job;
+{
+  PROCESS *child;
+  int tstatus, job_state, any_stopped, any_tstped, call_set_current;
+  SigHandler *temp_handler;
+
+  child = jobs[job]->pipe;
+  jobs[job]->flags &= ~J_NOTIFIED;
+
+  call_set_current = 0;
+
+  /*
+   * COMPUTE JOB STATUS
+   */
+
+  /* If all children are not running, but any of them is  stopped, then
+     the job is stopped, not dead. */
+  job_state = any_stopped = any_tstped = 0;
+  do
+    {
+      job_state |= child->running;
+      if (child->running == PS_DONE && (WIFSTOPPED (child->status)))
+	{
+	  any_stopped = 1;
+	  any_tstped |= interactive && job_control &&
+			    (WSTOPSIG (child->status) == SIGTSTP);
+	}
+      child = child->next;
+    }
+  while (child != jobs[job]->pipe);
+
+  /* If job_state != 0, the job is still running, so don't bother with
+     setting the process exit status and job state unless we're
+     transitioning from stopped to running. */
+  if (job_state != 0 && JOBSTATE(job) != JSTOPPED)
+    return 0;
+
+  /*
+   * SET JOB STATUS
+   */
+
+  /* The job is either stopped or dead.  Set the state of the job accordingly. */
+  if (any_stopped)
+    {
+      jobs[job]->state = JSTOPPED;
+      jobs[job]->flags &= ~J_FOREGROUND;
+      call_set_current++;
+      /* Suspending a job with SIGTSTP breaks all active loops. */
+      if (any_tstped && loop_level)
+	breaking = loop_level;
+    }
+  else if (job_state != 0)	/* was stopped, now running */
+    {
+      jobs[job]->state = JRUNNING;
+      call_set_current++;
+    }
+  else
+    {
+      jobs[job]->state = JDEAD;
+
+#if 0
+      if (IS_FOREGROUND (job))
+	setjstatus (job);
+#endif
+
+      /* If this job has a cleanup function associated with it, call it
+	 with `cleanarg' as the single argument, then set the function
+	 pointer to NULL so it is not inadvertently called twice.  The
+	 cleanup function is responsible for deallocating cleanarg. */
+      if (jobs[job]->j_cleanup)
+	{
+	  (*jobs[job]->j_cleanup) (jobs[job]->cleanarg);
+	  jobs[job]->j_cleanup = (sh_vptrfunc_t *)NULL;
+	}
+    }
+
+  /*
+   * CLEANUP
+   *
+   * Currently, we just do special things if we got a SIGINT while waiting
+   * for a foreground job to complete
+   */
+
+  if (jobs[job]->state == JDEAD)
+    {
+      /* If we're running a shell script and we get a SIGINT with a
+	 SIGINT trap handler, but the foreground job handles it and
+	 does not exit due to SIGINT, run the trap handler but do not
+	 otherwise act as if we got the interrupt. */
+      if (wait_sigint_received && interactive_shell == 0 &&
+	  WIFSIGNALED (child->status) == 0 && IS_FOREGROUND (job) &&
+	  signal_is_trapped (SIGINT))
+	{
+	  int old_frozen;
+	  wait_sigint_received = 0;
+	  last_command_exit_value = process_exit_status (child->status);
+
+	  old_frozen = jobs_list_frozen;
+	  jobs_list_frozen = 1;
+	  tstatus = maybe_call_trap_handler (SIGINT);
+	  jobs_list_frozen = old_frozen;
+	}
+
+      /* If the foreground job is killed by SIGINT when job control is not
+	 active, we need to perform some special handling.
+
+	 The check of wait_sigint_received is a way to determine if the
+	 SIGINT came from the keyboard (in which case the shell has already
+	 seen it, and wait_sigint_received is non-zero, because keyboard
+	 signals are sent to process groups) or via kill(2) to the foreground
+	 process by another process (or itself).  If the shell did receive the
+	 SIGINT, it needs to perform normal SIGINT processing. */
+      else if (wait_sigint_received && (WTERMSIG (child->status) == SIGINT) &&
+	      IS_FOREGROUND (job) && IS_JOBCONTROL (job) == 0)
+	{
+	  int old_frozen;
+
+	  wait_sigint_received = 0;
+
+	  /* If SIGINT is trapped, set the exit status so that the trap
+	     handler can see it. */
+	  if (signal_is_trapped (SIGINT))
+	    last_command_exit_value = process_exit_status (child->status);
+
+	  /* If the signal is trapped, let the trap handler get it no matter
+	     what and simply return if the trap handler returns.
+	    maybe_call_trap_handler() may cause dead jobs to be removed from
+	    the job table because of a call to execute_command.  We work
+	    around this by setting JOBS_LIST_FROZEN. */
+	  old_frozen = jobs_list_frozen;
+	  jobs_list_frozen = 1;
+	  tstatus = maybe_call_trap_handler (SIGINT);
+	  jobs_list_frozen = old_frozen;
+	  if (tstatus == 0 && old_sigint_handler != INVALID_SIGNAL_HANDLER)
+	    {
+	      /* wait_sigint_handler () has already seen SIGINT and
+		 allowed the wait builtin to jump out.  We need to
+		 call the original SIGINT handler, if necessary.  If
+		 the original handler is SIG_DFL, we need to resend
+		 the signal to ourselves. */
+
+	      temp_handler = old_sigint_handler;
+
+	      /* Bogus.  If we've reset the signal handler as the result
+		 of a trap caught on SIGINT, then old_sigint_handler
+		 will point to trap_handler, which now knows nothing about
+		 SIGINT (if we reset the sighandler to the default).
+		 In this case, we have to fix things up.  What a crock. */
+	      if (temp_handler == trap_handler && signal_is_trapped (SIGINT) == 0)
+		  temp_handler = trap_to_sighandler (SIGINT);
+		restore_sigint_handler ();
+		if (temp_handler == SIG_DFL)
+		  termination_unwind_protect (SIGINT);
+		else if (temp_handler != SIG_IGN)
+		  (*temp_handler) (SIGINT);
+	    }
+	}
+    }
+
+  return call_set_current;
+}
+
+/* Build the array of values for the $PIPESTATUS variable from the set of
+   exit statuses of all processes in the job J. */
+static void
+setjstatus (j)
+     int j;
+{
+#if defined (ARRAY_VARS)
+  register int i;
+  register PROCESS *p;
+
+  for (i = 1, p = jobs[j]->pipe; p->next != jobs[j]->pipe; p = p->next, i++)
+    ;
+  i++;
+  if (statsize < i)
+    {
+      pstatuses = (int *)xrealloc (pstatuses, i * sizeof (int));
+      statsize = i;
+    }
+  i = 0;
+  p = jobs[j]->pipe;
+  do
+    {
+      pstatuses[i++] = process_exit_status (p->status);
+      p = p->next;
+    }
+  while (p != jobs[j]->pipe);
+
+  pstatuses[i] = -1;	/* sentinel */
+  set_pipestatus_array (pstatuses, i);
+#endif
+}
+
+static void
+run_sigchld_trap (nchild)
+     int nchild;
+{
+  char *trap_command;
+  int i;
+
+  /* Turn off the trap list during the call to parse_and_execute ()
+     to avoid potentially infinite recursive calls.  Preserve the
+     values of last_command_exit_value, last_made_pid, and the_pipeline
+     around the execution of the trap commands. */
+  trap_command = savestring (trap_list[SIGCHLD]);
+
+  begin_unwind_frame ("SIGCHLD trap");
+  unwind_protect_int (last_command_exit_value);
+  unwind_protect_int (last_command_exit_signal);
+  unwind_protect_var (last_made_pid);
+  unwind_protect_int (interrupt_immediately);
+  unwind_protect_int (jobs_list_frozen);
+  unwind_protect_pointer (the_pipeline);
+  unwind_protect_pointer (subst_assign_varlist);
+
+  /* We have to add the commands this way because they will be run
+     in reverse order of adding.  We don't want maybe_set_sigchld_trap ()
+     to reference freed memory. */
+  add_unwind_protect (xfree, trap_command);
+  add_unwind_protect (maybe_set_sigchld_trap, trap_command);
+
+  subst_assign_varlist = (WORD_LIST *)NULL;
+  the_pipeline = (PROCESS *)NULL;
+
+  restore_default_signal (SIGCHLD);
+  jobs_list_frozen = 1;
+  for (i = 0; i < nchild; i++)
+    {
+      interrupt_immediately = 1;
+      parse_and_execute (savestring (trap_command), "trap", SEVAL_NOHIST|SEVAL_RESETLINE);
+    }
+
+  run_unwind_frame ("SIGCHLD trap");
+}
+
+/* Function to call when you want to notify people of changes
+   in job status.  This prints out all jobs which are pending
+   notification to stderr, and marks those printed as already
+   notified, thus making them candidates for cleanup. */
+static void
+notify_of_job_status ()
+{
+  register int job, termsig;
+  char *dir;
+  sigset_t set, oset;
+  WAIT s;
+
+  if (jobs == 0 || job_slots == 0)
+    return;
+
+  if (old_ttou != 0)
+    {
+      sigemptyset (&set);
+      sigaddset (&set, SIGCHLD);
+      sigaddset (&set, SIGTTOU);
+      sigemptyset (&oset);
+      sigprocmask (SIG_BLOCK, &set, &oset);
+    }
+  else
+    queue_sigchld++;
+
+  for (job = 0, dir = (char *)NULL; job < job_slots; job++)
+    {
+      if (jobs[job] && IS_NOTIFIED (job) == 0)
+	{
+	  s = raw_job_exit_status (job);
+	  termsig = WTERMSIG (s);
+
+	  /* POSIX.2 says we have to hang onto the statuses of at most the
+	     last CHILD_MAX background processes if the shell is running a
+	     script.  If the shell is not interactive, don't print anything
+	     unless the job was killed by a signal. */
+	  if (startup_state == 0 && WIFSIGNALED (s) == 0 &&
+		((DEADJOB (job) && IS_FOREGROUND (job) == 0) || STOPPED (job)))
+	    continue;
+	  
+#if 0
+	  /* If job control is disabled, don't print the status messages.
+	     Mark dead jobs as notified so that they get cleaned up.  If
+	     startup_state == 2, we were started to run `-c command', so
+	     don't print anything. */
+	  if ((job_control == 0 && interactive_shell) || startup_state == 2)
+#else
+	  /* If job control is disabled, don't print the status messages.
+	     Mark dead jobs as notified so that they get cleaned up.  If
+	     startup_state == 2 and subshell_environment has the
+	     SUBSHELL_COMSUB bit turned on, we were started to run a command
+	     substitution, so don't print anything. */
+	  if ((job_control == 0 && interactive_shell) ||
+	      (startup_state == 2 && (subshell_environment & SUBSHELL_COMSUB)))
+#endif
+	    {
+	      /* POSIX.2 compatibility:  if the shell is not interactive,
+		 hang onto the job corresponding to the last asynchronous
+		 pid until the user has been notified of its status or does
+		 a `wait'. */
+	      if (DEADJOB (job) && (interactive_shell || (find_last_pid (job, 0) != last_asynchronous_pid)))
+		jobs[job]->flags |= J_NOTIFIED;
+	      continue;
+	    }
+
+	  /* Print info on jobs that are running in the background,
+	     and on foreground jobs that were killed by anything
+	     except SIGINT (and possibly SIGPIPE). */
+	  switch (JOBSTATE (job))
+	    {
+	    case JDEAD:
+	      if (interactive_shell == 0 && termsig && WIFSIGNALED (s) &&
+		  termsig != SIGINT &&
+#if defined (DONT_REPORT_SIGPIPE)
+		  termsig != SIGPIPE &&
+#endif
+		  signal_is_trapped (termsig) == 0)
+		{
+		  /* Don't print `0' for a line number. */
+		  fprintf (stderr, "%s: line %d: ", get_name_for_error (), (line_number == 0) ? 1 : line_number);
+		  pretty_print_job (job, JLIST_NONINTERACTIVE, stderr);
+		}
+	      else if (IS_FOREGROUND (job))
+		{
+#if !defined (DONT_REPORT_SIGPIPE)
+		  if (termsig && WIFSIGNALED (s) && termsig != SIGINT)
+#else
+		  if (termsig && WIFSIGNALED (s) && termsig != SIGINT && termsig != SIGPIPE)
+#endif
+		    {
+		      fprintf (stderr, "%s", j_strsignal (termsig));
+
+		      if (WIFCORED (s))
+			fprintf (stderr, " (core dumped)");
+
+		      fprintf (stderr, "\n");
+		    }
+		}
+	      else
+		{
+		  if (dir == 0)
+		    dir = current_working_directory ();
+		  pretty_print_job (job, JLIST_STANDARD, stderr);
+		  if (dir && strcmp (dir, jobs[job]->wd) != 0)
+		    fprintf (stderr,
+			     "(wd now: %s)\n", polite_directory_format (dir));
+		}
+
+	      jobs[job]->flags |= J_NOTIFIED;
+	      break;
+
+	    case JSTOPPED:
+	      fprintf (stderr, "\n");
+	      if (dir == 0)
+		dir = current_working_directory ();
+	      pretty_print_job (job, JLIST_STANDARD, stderr);
+	      if (dir && (strcmp (dir, jobs[job]->wd) != 0))
+		fprintf (stderr,
+			 "(wd now: %s)\n", polite_directory_format (dir));
+	      jobs[job]->flags |= J_NOTIFIED;
+	      break;
+
+	    case JRUNNING:
+	    case JMIXED:
+	      break;
+
+	    default:
+	      programming_error ("notify_of_job_status");
+	    }
+	}
+    }
+  if (old_ttou != 0)
+    sigprocmask (SIG_SETMASK, &oset, (sigset_t *)NULL);
+  else
+    queue_sigchld--;
+}
+
+/* Initialize the job control mechanism, and set up the tty stuff. */
+int
+initialize_job_control (force)
+     int force;
+{
+  shell_pgrp = getpgid (0);
+
+  if (shell_pgrp == -1)
+    {
+      sys_error ("initialize_job_control: getpgrp failed");
+      exit (1);
+    }
+
+  /* We can only have job control if we are interactive. */
+  if (interactive == 0)
+    {
+      job_control = 0;
+      original_pgrp = NO_PID;
+      shell_tty = fileno (stderr);
+    }
+  else
+    {
+      /* Get our controlling terminal.  If job_control is set, or
+	 interactive is set, then this is an interactive shell no
+	 matter where fd 2 is directed. */
+      shell_tty = dup (fileno (stderr));	/* fd 2 */
+
+      shell_tty = move_to_high_fd (shell_tty, 1, -1);
+
+      /* Compensate for a bug in systems that compiled the BSD
+	 rlogind with DEBUG defined, like NeXT and Alliant. */
+      if (shell_pgrp == 0)
+	{
+	  shell_pgrp = getpid ();
+	  setpgid (0, shell_pgrp);
+	  tcsetpgrp (shell_tty, shell_pgrp);
+	}
+
+      while ((terminal_pgrp = tcgetpgrp (shell_tty)) != -1)
+	{
+	  if (shell_pgrp != terminal_pgrp)
+	    {
+	      SigHandler *ottin;
+
+	      ottin = set_signal_handler(SIGTTIN, SIG_DFL);
+	      kill (0, SIGTTIN);
+	      set_signal_handler (SIGTTIN, ottin);
+	      continue;
+	    }
+	  break;
+	}
+
+      /* Make sure that we are using the new line discipline. */
+      if (set_new_line_discipline (shell_tty) < 0)
+	{
+	  sys_error ("initialize_job_control: line discipline");
+	  job_control = 0;
+	}
+      else
+	{
+	  original_pgrp = shell_pgrp;
+	  shell_pgrp = getpid ();
+
+	  if ((original_pgrp != shell_pgrp) && (setpgid (0, shell_pgrp) < 0))
+	    {
+	      sys_error ("initialize_job_control: setpgid");
+	      shell_pgrp = original_pgrp;
+	    }
+
+	  job_control = 1;
+
+	  /* If (and only if) we just set our process group to our pid,
+	     thereby becoming a process group leader, and the terminal
+	     is not in the same process group as our (new) process group,
+	     then set the terminal's process group to our (new) process
+	     group.  If that fails, set our process group back to what it
+	     was originally (so we can still read from the terminal) and
+	     turn off job control.  */
+	  if (shell_pgrp != original_pgrp && shell_pgrp != terminal_pgrp)
+	    {
+	      if (give_terminal_to (shell_pgrp, 0) < 0)
+		{
+		  setpgid (0, original_pgrp);
+		  shell_pgrp = original_pgrp;
+		  job_control = 0;
+		}
+	    }
+	}
+      if (job_control == 0)
+	internal_error (_("no job control in this shell"));
+    }
+
+  if (shell_tty != fileno (stderr))
+    SET_CLOSE_ON_EXEC (shell_tty);
+
+  set_signal_handler (SIGCHLD, sigchld_handler);
+
+  change_flag ('m', job_control ? '-' : '+');
+
+  if (interactive)
+    get_tty_state ();
+
+  return job_control;
+}
+
+#ifdef DEBUG
+void
+debug_print_pgrps ()
+{
+  itrace("original_pgrp = %ld shell_pgrp = %ld terminal_pgrp = %ld",
+	 (long)original_pgrp, (long)shell_pgrp, (long)terminal_pgrp);
+  itrace("tcgetpgrp(%d) -> %ld, getpgid(0) -> %ld",
+	 shell_tty, (long)tcgetpgrp (shell_tty), (long)getpgid(0));
+}
+#endif
+
+/* Set the line discipline to the best this system has to offer.
+   Return -1 if this is not possible. */
+static int
+set_new_line_discipline (tty)
+     int tty;
+{
+#if defined (NEW_TTY_DRIVER)
+  int ldisc;
+
+  if (ioctl (tty, TIOCGETD, &ldisc) < 0)
+    return (-1);
+
+  if (ldisc != NTTYDISC)
+    {
+      ldisc = NTTYDISC;
+
+      if (ioctl (tty, TIOCSETD, &ldisc) < 0)
+	return (-1);
+    }
+  return (0);
+#endif /* NEW_TTY_DRIVER */
+
+#if defined (TERMIO_TTY_DRIVER)
+#  if defined (TERMIO_LDISC) && (NTTYDISC)
+  if (ioctl (tty, TCGETA, &shell_tty_info) < 0)
+    return (-1);
+
+  if (shell_tty_info.c_line != NTTYDISC)
+    {
+      shell_tty_info.c_line = NTTYDISC;
+      if (ioctl (tty, TCSETAW, &shell_tty_info) < 0)
+	return (-1);
+    }
+#  endif /* TERMIO_LDISC && NTTYDISC */
+  return (0);
+#endif /* TERMIO_TTY_DRIVER */
+
+#if defined (TERMIOS_TTY_DRIVER)
+#  if defined (TERMIOS_LDISC) && defined (NTTYDISC)
+  if (tcgetattr (tty, &shell_tty_info) < 0)
+    return (-1);
+
+  if (shell_tty_info.c_line != NTTYDISC)
+    {
+      shell_tty_info.c_line = NTTYDISC;
+      if (tcsetattr (tty, TCSADRAIN, &shell_tty_info) < 0)
+	return (-1);
+    }
+#  endif /* TERMIOS_LDISC && NTTYDISC */
+  return (0);
+#endif /* TERMIOS_TTY_DRIVER */
+
+#if !defined (NEW_TTY_DRIVER) && !defined (TERMIO_TTY_DRIVER) && !defined (TERMIOS_TTY_DRIVER)
+  return (-1);
+#endif
+}
+
+#if defined (TIOCGWINSZ) && defined (SIGWINCH)
+static void
+get_new_window_size (from_sig)
+     int from_sig;
+{
+  struct winsize win;
+
+  if ((ioctl (shell_tty, TIOCGWINSZ, &win) == 0) &&
+      win.ws_row > 0 && win.ws_col > 0)
+    {
+#if defined (aixpc)
+      shell_tty_info.c_winsize = win;	/* structure copying */
+#endif
+      sh_set_lines_and_columns (win.ws_row, win.ws_col);
+#if defined (READLINE)
+      rl_set_screen_size (win.ws_row, win.ws_col);
+#endif
+    }
+}
+
+static sighandler
+sigwinch_sighandler (sig)
+     int sig;
+{
+#if defined (MUST_REINSTALL_SIGHANDLERS)
+  set_signal_handler (SIGWINCH, sigwinch_sighandler);
+#endif /* MUST_REINSTALL_SIGHANDLERS */
+  get_new_window_size (1);
+  SIGRETURN (0);
+}
+#else
+static void
+get_new_window_size (from_sig)
+     int from_sig;
+{
+}
+#endif /* TIOCGWINSZ && SIGWINCH */
+
+void
+set_sigwinch_handler ()
+{
+#if defined (TIOCGWINSZ) && defined (SIGWINCH)
+ old_winch = set_signal_handler (SIGWINCH, sigwinch_sighandler);
+#endif
+}
+
+void
+unset_sigwinch_handler ()
+{
+#if defined (TIOCGWINSZ) && defined (SIGWINCH)
+  set_signal_handler (SIGWINCH, old_winch);
+#endif
+}
+
+/* Setup this shell to handle C-C, etc. */
+void
+initialize_job_signals ()
+{
+  if (interactive)
+    {
+      set_signal_handler (SIGINT, sigint_sighandler);
+      set_signal_handler (SIGTSTP, SIG_IGN);
+      set_signal_handler (SIGTTOU, SIG_IGN);
+      set_signal_handler (SIGTTIN, SIG_IGN);
+      set_sigwinch_handler ();
+    }
+  else if (job_control)
+    {
+      old_tstp = set_signal_handler (SIGTSTP, sigstop_sighandler);
+      old_ttin = set_signal_handler (SIGTTIN, sigstop_sighandler);
+      old_ttou = set_signal_handler (SIGTTOU, sigstop_sighandler);
+    }
+  /* Leave these things alone for non-interactive shells without job
+     control. */
+}
+
+/* Here we handle CONT signals. */
+static sighandler
+sigcont_sighandler (sig)
+     int sig;
+{
+  initialize_job_signals ();
+  set_signal_handler (SIGCONT, old_cont);
+  kill (getpid (), SIGCONT);
+
+  SIGRETURN (0);
+}
+
+/* Here we handle stop signals while we are running not as a login shell. */
+static sighandler
+sigstop_sighandler (sig)
+     int sig;
+{
+  set_signal_handler (SIGTSTP, old_tstp);
+  set_signal_handler (SIGTTOU, old_ttou);
+  set_signal_handler (SIGTTIN, old_ttin);
+
+  old_cont = set_signal_handler (SIGCONT, sigcont_sighandler);
+
+  give_terminal_to (shell_pgrp, 0);
+
+  kill (getpid (), sig);
+
+  SIGRETURN (0);
+}
+
+/* Give the terminal to PGRP.  */
+int
+give_terminal_to (pgrp, force)
+     pid_t pgrp;
+     int force;
+{
+  sigset_t set, oset;
+  int r;
+
+  r = 0;
+  if (job_control || force)
+    {
+      sigemptyset (&set);
+      sigaddset (&set, SIGTTOU);
+      sigaddset (&set, SIGTTIN);
+      sigaddset (&set, SIGTSTP);
+      sigaddset (&set, SIGCHLD);
+      sigemptyset (&oset);
+      sigprocmask (SIG_BLOCK, &set, &oset);
+
+      if (tcsetpgrp (shell_tty, pgrp) < 0)
+	{
+	  /* Maybe we should print an error message? */
+#if 0
+	  sys_error ("tcsetpgrp(%d) failed: pid %ld to pgrp %ld",
+	    shell_tty, (long)getpid(), (long)pgrp);
+#endif
+	  r = -1;
+	}
+      else
+	terminal_pgrp = pgrp;
+      sigprocmask (SIG_SETMASK, &oset, (sigset_t *)NULL);
+    }
+
+  return r;
+}
+
+/* Clear out any jobs in the job array.  This is intended to be used by
+   children of the shell, who should not have any job structures as baggage
+   when they start executing (forking subshells for parenthesized execution
+   and functions with pipes are the two that spring to mind).  If RUNNING_ONLY
+   is nonzero, only running jobs are removed from the table. */
+void
+delete_all_jobs (running_only)
+     int running_only;
+{
+  register int i;
+  sigset_t set, oset;
+
+  BLOCK_CHILD (set, oset);
+
+  if (job_slots)
+    {
+      current_job = previous_job = NO_JOB;
+
+      for (i = 0; i < job_slots; i++)
+	if (jobs[i] && (running_only == 0 || (running_only && RUNNING(i))))
+	  delete_job (i, 1);
+
+      if (running_only == 0)
+	{
+	  free ((char *)jobs);
+	  job_slots = 0;
+	}
+    }
+
+  UNBLOCK_CHILD (oset);
+}
+
+/* Mark all jobs in the job array so that they don't get a SIGHUP when the
+   shell gets one.  If RUNNING_ONLY is nonzero, mark only running jobs. */
+void
+nohup_all_jobs (running_only)
+     int running_only;
+{
+  register int i;
+  sigset_t set, oset;
+
+  BLOCK_CHILD (set, oset);
+
+  if (job_slots)
+    {
+      for (i = 0; i < job_slots; i++)
+	if (jobs[i] && (running_only == 0 || (running_only && RUNNING(i))))
+	  nohup_job (i);
+    }
+
+  UNBLOCK_CHILD (oset);
+}
+
+int
+count_all_jobs ()
+{
+  int i, n;
+  sigset_t set, oset;
+
+  BLOCK_CHILD (set, oset);
+  for (i = n = 0; i < job_slots; i++)
+    if (jobs[i] && DEADJOB(i) == 0)
+      n++;
+  UNBLOCK_CHILD (oset);
+  return n;
+}
+
+static void
+mark_all_jobs_as_dead ()
+{
+  register int i;
+  sigset_t set, oset;
+
+  if (job_slots == 0)
+    return;
+
+  BLOCK_CHILD (set, oset);
+
+  for (i = 0; i < job_slots; i++)
+    if (jobs[i])
+      jobs[i]->state = JDEAD;
+
+  UNBLOCK_CHILD (oset);
+}
+
+/* Mark all dead jobs as notified, so delete_job () cleans them out
+   of the job table properly.  POSIX.2 says we need to save the
+   status of the last CHILD_MAX jobs, so we count the number of dead
+   jobs and mark only enough as notified to save CHILD_MAX statuses. */
+static void
+mark_dead_jobs_as_notified (force)
+     int force;
+{
+  register int i, ndead;
+  sigset_t set, oset;
+
+  if (job_slots == 0)
+    return;
+
+  BLOCK_CHILD (set, oset);
+
+  /* If FORCE is non-zero, we don't have to keep CHILD_MAX statuses
+     around; just run through the array. */
+  if (force)
+    {
+      for (i = 0; i < job_slots; i++)
+	{
+	  if (jobs[i] && DEADJOB (i) && (interactive_shell || (find_last_pid (i, 0) != last_asynchronous_pid)))
+	    jobs[i]->flags |= J_NOTIFIED;
+	}
+      UNBLOCK_CHILD (oset);
+      return;
+    }
+
+  /* Mark enough dead jobs as notified to keep CHILD_MAX jobs left in the
+     array not marked as notified. */
+          
+  /* Count the number of dead jobs */
+  for (i = ndead = 0; i < job_slots; i++)
+    {
+      if (jobs[i] && DEADJOB (i))
+	ndead++;
+    }
+
+  if (child_max < 0)
+    child_max = getmaxchild ();
+  if (child_max < 0)
+    child_max = DEFAULT_CHILD_MAX;
+
+  /* Don't do anything if the number of dead jobs is less than CHILD_MAX and
+     we're not forcing a cleanup. */
+  if (ndead <= child_max)
+    {
+      UNBLOCK_CHILD (oset);
+      return;
+    }
+
+  /* Mark enough dead jobs as notified that we keep CHILD_MAX jobs in
+     the list.  This isn't exactly right yet; changes need to be made
+     to stop_pipeline so we don't mark the newer jobs after we've
+     created CHILD_MAX slots in the jobs array. */
+  for (i = 0; i < job_slots; i++)
+    {
+      if (jobs[i] && DEADJOB (i) && (interactive_shell || (find_last_pid (i, 0) != last_asynchronous_pid)))
+	{
+	  jobs[i]->flags |= J_NOTIFIED;
+	  if (--ndead <= child_max)
+	    break;
+	}
+    }
+
+  UNBLOCK_CHILD (oset);
+}
+
+/* Here to allow other parts of the shell (like the trap stuff) to
+   unfreeze the jobs list. */
+void
+unfreeze_jobs_list ()
+{
+  jobs_list_frozen = 0;
+}
+
+/* Allow or disallow job control to take place.  Returns the old value
+   of job_control. */
+int
+set_job_control (arg)
+     int arg;
+{
+  int old;
+
+  old = job_control;
+  job_control = arg;
+
+  /* If we're turning on job control, reset pipeline_pgrp so make_child will
+     put new child processes into the right pgrp */
+  if (job_control != old && job_control)
+    pipeline_pgrp = 0;
+
+  return (old);
+}
+
+/* Turn off all traces of job control.  This is run by children of the shell
+   which are going to do shellsy things, like wait (), etc. */
+void
+without_job_control ()
+{
+  stop_making_children ();
+  start_pipeline ();
+  delete_all_jobs (0);
+  set_job_control (0);
+}
+
+/* If this shell is interactive, terminate all stopped jobs and
+   restore the original terminal process group.  This is done
+   before the `exec' builtin calls shell_execve. */
+void
+end_job_control ()
+{
+  if (interactive_shell)		/* XXX - should it be interactive? */
+    {
+      terminate_stopped_jobs ();
+
+      if (original_pgrp >= 0)
+	give_terminal_to (original_pgrp, 1);
+    }
+
+  if (original_pgrp >= 0)
+    setpgid (0, original_pgrp);
+}
+
+/* Restart job control by closing shell tty and reinitializing.  This is
+   called after an exec fails in an interactive shell and we do not exit. */
+void
+restart_job_control ()
+{
+  if (shell_tty != -1)
+    close (shell_tty);
+  initialize_job_control (0);
+}
+
+/* Set the handler to run when the shell receives a SIGCHLD signal. */
+void
+set_sigchld_handler ()
+{
+  set_signal_handler (SIGCHLD, sigchld_handler);
+}
+
+#if defined (PGRP_PIPE)
+/* Read from the read end of a pipe.  This is how the process group leader
+   blocks until all of the processes in a pipeline have been made. */
+static void
+pipe_read (pp)
+     int *pp;
+{
+  char ch;
+
+  if (pp[1] >= 0)
+    {
+      close (pp[1]);
+      pp[1] = -1;
+    }
+
+  if (pp[0] >= 0)
+    {
+      while (read (pp[0], &ch, 1) == -1 && errno == EINTR)
+	;
+    }
+}
+
+/* Close the read and write ends of PP, an array of file descriptors. */
+static void
+pipe_close (pp)
+     int *pp;
+{
+  if (pp[0] >= 0)
+    close (pp[0]);
+
+  if (pp[1] >= 0)
+    close (pp[1]);
+
+  pp[0] = pp[1] = -1;
+}
+
+/* Functional interface closes our local-to-job-control pipes. */
+void
+close_pgrp_pipe ()
+{
+  pipe_close (pgrp_pipe);
+}
+
+#endif /* PGRP_PIPE */
diff -urN bash-3.0/lib/intl/Makefile.in bash-3.0-STEP/lib/intl/Makefile.in
--- bash-3.0/lib/intl/Makefile.in	2003-12-10 10:01:24.000000000 +1300
+++ bash-3.0-STEP/lib/intl/Makefile.in	2005-08-25 00:34:10.935434944 +1200
@@ -19,7 +19,7 @@
 PACKAGE = @PACKAGE_NAME@
 VERSION = @PACKAGE_VERSION@
 
-SHELL = /bin/sh
+SHELL = /System/Tools/sh
 
 srcdir = @srcdir@
 top_srcdir = @top_srcdir@
@@ -357,7 +357,7 @@
 	    temp=$(DESTDIR)$(prefix)/libdata/t-charset.alias; \
 	    dest=$(DESTDIR)$(prefix)/libdata/charset.alias; \
 	    sed -f ref-del.sed $$dest > $$temp; \
-	    if grep '^# Packages using this file: $$' $$temp > /dev/null; then \
+	    if grep '^# Packages using this file: $$' $$temp > /System/Devices/null; then \
 	      rm -f $$dest; \
 	    else \
 	      $(INSTALL_DATA) $$temp $$dest; \
@@ -368,7 +368,7 @@
 	    temp=$(DESTDIR)$(localedir)/t-locale.alias; \
 	    dest=$(DESTDIR)$(localedir)/locale.alias; \
 	    sed -f ref-del.sed $$dest > $$temp; \
-	    if grep '^# Packages using this file: $$' $$temp > /dev/null; then \
+	    if grep '^# Packages using this file: $$' $$temp > /System/Devices/null; then \
 	      rm -f $$dest; \
 	    else \
 	      $(INSTALL_DATA) $$temp $$dest; \
diff -urN bash-3.0/lib/intl/config.charset bash-3.0-STEP/lib/intl/config.charset
--- bash-3.0/lib/intl/config.charset	2003-12-10 06:39:11.000000000 +1300
+++ bash-3.0-STEP/lib/intl/config.charset	2005-08-25 00:33:17.078622424 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 # Output a system dependent table of character encoding aliases.
 #
 #   Copyright (C) 2000-2003 Free Software Foundation, Inc.
diff -urN bash-3.0/lib/intl/relocatable.c bash-3.0-STEP/lib/intl/relocatable.c
--- bash-3.0/lib/intl/relocatable.c	2003-12-10 06:39:11.000000000 +1300
+++ bash-3.0-STEP/lib/intl/relocatable.c	2005-08-25 00:47:04.556826616 +1200
@@ -308,7 +308,7 @@
   FILE *fp;
 
   /* Open the current process' maps file.  It describes one VMA per line.  */
-  fp = fopen ("/proc/self/maps", "r");
+  fp = fopen ("/System/Processes/self/maps", "r");
   if (fp)
     {
       unsigned long address = (unsigned long) &find_shared_library_fullname;
diff -urN bash-3.0/lib/malloc/Makefile.in bash-3.0-STEP/lib/malloc/Makefile.in
--- bash-3.0/lib/malloc/Makefile.in	2004-01-22 08:33:07.000000000 +1300
+++ bash-3.0-STEP/lib/malloc/Makefile.in	2005-08-25 00:34:10.938434488 +1200
@@ -101,7 +101,7 @@
 alloca.o:	$(srcdir)/$(ALLOCA_SOURCE)
 	$(CC) $(CCFLAGS) -c $(srcdir)/$(ALLOCA_SOURCE)
 	@- if test "$(ALLOCA_OBJECT)" != alloca.o ; then \
-		mv $(ALLOCA_OBJECT) alloca.o >/dev/null 2>&1 ; \
+		mv $(ALLOCA_OBJECT) alloca.o >/System/Devices/null 2>&1 ; \
 	fi
 
 mostlyclean clean:
diff -urN bash-3.0/lib/malloc/stats.c bash-3.0-STEP/lib/malloc/stats.c
--- bash-3.0/lib/malloc/stats.c	2003-11-30 10:01:44.000000000 +1300
+++ bash-3.0-STEP/lib/malloc/stats.c	2005-08-25 00:47:14.969243688 +1200
@@ -131,7 +131,7 @@
   _print_malloc_stats (s, fp);
 }
 
-#define TRACEROOT "/var/tmp/maltrace/stats."
+#define TRACEROOT "/System/ApplicationData/TemporaryFiles/maltrace/stats."
 
 void
 trace_malloc_stats (s, fn)
diff -urN bash-3.0/lib/malloc/trace.c bash-3.0-STEP/lib/malloc/trace.c
--- bash-3.0/lib/malloc/trace.c	2003-11-30 10:02:26.000000000 +1300
+++ bash-3.0-STEP/lib/malloc/trace.c	2005-08-25 00:47:14.972243232 +1200
@@ -104,7 +104,7 @@
 #endif
 }
 
-#define TRACEROOT "/var/tmp/maltrace/trace."
+#define TRACEROOT "/System/ApplicationData/TemporaryFiles/maltrace/trace."
 
 void
 malloc_set_tracefn (s, fn)
diff -urN bash-3.0/lib/malloc/xleaktrace bash-3.0-STEP/lib/malloc/xleaktrace
--- bash-3.0/lib/malloc/xleaktrace	2001-09-28 06:13:05.000000000 +1200
+++ bash-3.0-STEP/lib/malloc/xleaktrace	2005-08-25 00:33:12.114377104 +1200
@@ -1,4 +1,4 @@
-#! /usr/bin/awk -f
+#! /System/Tools/awk -f
 #
 # xleaktrace - print unfreed memory using input generated by compact malloc
 #	       tracing (malloc_set_trace(1))
diff -urN bash-3.0/lib/readline/doc/Makefile bash-3.0-STEP/lib/readline/doc/Makefile
--- bash-3.0/lib/readline/doc/Makefile	2003-02-21 11:37:49.000000000 +1300
+++ bash-3.0-STEP/lib/readline/doc/Makefile	2005-08-25 00:33:17.081621968 +1200
@@ -33,10 +33,10 @@
 man3ext = 3
 man3dir = $(mandir)/$(manpfx)$(man3ext)
 
-SHELL = /bin/sh
+SHELL = /System/Tools/sh
 RM = rm -f
 
-INSTALL = /usr/bin/install -c
+INSTALL = /System/Tools/install -c
 INSTALL_DATA = ${INSTALL} -m 644
 
 BUILD_DIR = .
diff -urN bash-3.0/lib/readline/doc/rluser.texi bash-3.0-STEP/lib/readline/doc/rluser.texi
--- bash-3.0/lib/readline/doc/rluser.texi	2004-04-25 06:46:33.000000000 +1200
+++ bash-3.0-STEP/lib/readline/doc/rluser.texi	2005-08-25 00:46:57.571888488 +1200
@@ -766,9 +766,9 @@
 @item $include
 This directive takes a single filename as an argument and reads commands
 and bindings from that file.
-For example, the following directive reads from @file{/etc/inputrc}:
+For example, the following directive reads from @file{/System/Settings/inputrc}:
 @example
-$include /etc/inputrc
+$include /System/Settings/inputrc
 @end example
 @end table
 
@@ -788,8 +788,8 @@
 # Lines beginning with '#' are comments.
 #
 # First, include any systemwide bindings and variable
-# assignments from /etc/Inputrc
-$include /etc/Inputrc
+# assignments from /System/Settings/Inputrc
+$include /System/Settings/Inputrc
 
 #
 # Set various bindings for emacs mode.
diff -urN bash-3.0/lib/readline/rlstdc.h bash-3.0-STEP/lib/readline/rlstdc.h
--- bash-3.0/lib/readline/rlstdc.h	2003-05-31 07:08:02.000000000 +1200
+++ bash-3.0-STEP/lib/readline/rlstdc.h	2005-08-25 00:47:11.967699992 +1200
@@ -22,7 +22,7 @@
 #if !defined (_RL_STDC_H_)
 #define _RL_STDC_H_
 
-/* Adapted from BSD /usr/include/sys/cdefs.h. */
+/* Adapted from BSD /usr/include/System/SystemFS/cdefs.h. */
 
 /* A function can be defined using prototypes and compile on both ANSI C
    and traditional C compilers with something like this:
diff -urN bash-3.0/lib/sh/mailstat.c bash-3.0-STEP/lib/sh/mailstat.c
--- bash-3.0/lib/sh/mailstat.c	2003-03-23 12:20:21.000000000 +1200
+++ bash-3.0-STEP/lib/sh/mailstat.c	2005-08-25 00:47:18.095768384 +1200
@@ -98,7 +98,7 @@
   st_ret.st_atime = st_tmp.st_atime;
 
   /* See if tmp/ is present */
-  sprintf(dir, "%s/tmp", path);
+  sprintf(dir, "%s/System/TemporaryFiles", path);
   if (stat(dir, &st_tmp) || S_ISDIR(st_tmp.st_mode) == 0)
     return 0;
   st_ret.st_mtime = st_tmp.st_mtime;
diff -urN bash-3.0/lib/sh/netopen.c bash-3.0-STEP/lib/sh/netopen.c
--- bash-3.0/lib/sh/netopen.c	2003-12-20 13:10:24.000000000 +1300
+++ bash-3.0-STEP/lib/sh/netopen.c	2005-08-25 00:34:10.942433880 +1200
@@ -276,7 +276,7 @@
 }
 
 /*
- * Open a TCP or UDP connection given a path like `/dev/tcp/host/port' to
+ * Open a TCP or UDP connection given a path like `/System/Devices/tcp/host/port' to
  * host `host' on port `port' and return the connected socket.
  */
 int
diff -urN bash-3.0/lib/sh/oslib.c bash-3.0-STEP/lib/sh/oslib.c
--- bash-3.0/lib/sh/oslib.c	2001-12-07 07:26:21.000000000 +1300
+++ bash-3.0-STEP/lib/sh/oslib.c	2005-08-25 00:47:11.971699384 +1200
@@ -127,7 +127,7 @@
  * On System V.3, this can be obtained via a call to ulimit:
  *	return (ulimit(4, 0L));
  *
- * On other System V systems, NOFILE is defined in /usr/include/sys/param.h
+ * On other System V systems, NOFILE is defined in /usr/include/System/SystemFS/param.h
  * (this is what we assume below), so we can simply use it:
  *	return (NOFILE);
  *
diff -urN bash-3.0/lib/sh/tmpfile.c bash-3.0-STEP/lib/sh/tmpfile.c
--- bash-3.0/lib/sh/tmpfile.c	2004-02-13 05:33:36.000000000 +1300
+++ bash-3.0-STEP/lib/sh/tmpfile.c	2005-08-25 00:47:18.106766712 +1200
@@ -66,15 +66,15 @@
     return sys_tmpdir;
 #endif
 
-  sys_tmpdir = "/tmp";
+  sys_tmpdir = "/System/TemporaryFiles";
   if (file_iswdir (sys_tmpdir))
     return sys_tmpdir;
 
-  sys_tmpdir = "/var/tmp";
+  sys_tmpdir = "/System/ApplicationData/TemporaryFiles";
   if (file_iswdir (sys_tmpdir))
     return sys_tmpdir;
 
-  sys_tmpdir = "/usr/tmp";
+  sys_tmpdir = "/usr/System/TemporaryFiles";
   if (file_iswdir (sys_tmpdir))
     return sys_tmpdir;
 
diff -urN bash-3.0/lib/termcap/grot/ChangeLog bash-3.0-STEP/lib/termcap/grot/ChangeLog
--- bash-3.0/lib/termcap/grot/ChangeLog	1995-08-17 12:51:52.000000000 +1200
+++ bash-3.0-STEP/lib/termcap/grot/ChangeLog	2005-08-25 00:46:57.602883776 +1200
@@ -99,7 +99,7 @@
 	* termcap.c (tgetent): If EOF is reached on termcap file,
 	free allocated resources before returning.
 
-	* termcap.c (tgetent): Use /etc/termcap if TERMCAP is an entry
+	* termcap.c (tgetent): Use /System/Settings/termcap if TERMCAP is an entry
 	for a term type other than TERM.
 	From pjr@jet.UK (Paul J Rippin).
 
diff -urN bash-3.0/lib/termcap/grot/INSTALL bash-3.0-STEP/lib/termcap/grot/INSTALL
--- bash-3.0/lib/termcap/grot/INSTALL	1995-06-23 14:58:03.000000000 +1200
+++ bash-3.0-STEP/lib/termcap/grot/INSTALL	2005-08-25 00:46:57.599884232 +1200
@@ -141,7 +141,7 @@
 you can create a site shell script called `config.site' that gives
 default values for variables like `CC', `cache_file', and `prefix'.
 `configure' looks for `PREFIX/share/config.site' if it exists, then
-`PREFIX/etc/config.site' if it exists.  Or, you can set the
+`PREFIX/System/Settings/config.site' if it exists.  Or, you can set the
 `CONFIG_SITE' environment variable to the location of the site script.
 A warning: not all `configure' scripts look for a site script.
 
@@ -153,7 +153,7 @@
 
 `--cache-file=FILE'
      Use and save the results of the tests in FILE instead of
-     `./config.cache'.  Set FILE to `/dev/null' to disable caching, for
+     `./config.cache'.  Set FILE to `/System/Devices/null' to disable caching, for
      debugging `configure'.
 
 `--help'
diff -urN bash-3.0/lib/termcap/grot/Makefile.in bash-3.0-STEP/lib/termcap/grot/Makefile.in
--- bash-3.0/lib/termcap/grot/Makefile.in	1999-08-06 00:28:48.000000000 +1200
+++ bash-3.0-STEP/lib/termcap/grot/Makefile.in	2005-08-25 00:33:17.085621360 +1200
@@ -57,7 +57,7 @@
 
 #### End of system configuration section. ####
 
-SHELL = /bin/sh
+SHELL = /System/Tools/sh
 
 SRCS = termcap.c tparam.c version.c
 OBJS = termcap.o tparam.o version.o
diff -urN bash-3.0/lib/termcap/grot/README bash-3.0-STEP/lib/termcap/grot/README
--- bash-3.0/lib/termcap/grot/README	1995-08-17 13:02:21.000000000 +1200
+++ bash-3.0-STEP/lib/termcap/grot/README	2005-08-25 00:46:57.726864928 +1200
@@ -27,7 +27,7 @@
 
 You can give configure two special options:
   --enable-install-termcap install the termcap data file
-  --with-termcap=FILE     use data file FILE instead of /etc/termcap
+  --with-termcap=FILE     use data file FILE instead of /System/Settings/termcap
 
 Please report any bugs in this library to bug-gnu-emacs@prep.ai.mit.edu.
 You can check which version of the library you have by using the RCS
diff -urN bash-3.0/lib/termcap/grot/configure bash-3.0-STEP/lib/termcap/grot/configure
--- bash-3.0/lib/termcap/grot/configure	1995-07-27 07:52:38.000000000 +1200
+++ bash-3.0-STEP/lib/termcap/grot/configure	2005-08-25 00:47:07.886320456 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 
 # Guess values for system-dependent variables and create Makefiles.
 # Generated automatically using autoconf version 2.4 
@@ -14,7 +14,7 @@
 ac_help="$ac_help
   --enable-install-termcap install the termcap data file"
 ac_help="$ac_help
-  --with-termcap=FILE     use data file FILE instead of /etc/termcap"
+  --with-termcap=FILE     use data file FILE instead of /System/Settings/termcap"
 
 # Initialize some variables set by options.
 # The variables have the same names as the options, with
@@ -289,12 +289,12 @@
 # 0 standard input
 # 1 file creation
 # 2 errors and warnings
-# 3 some systems may open it to /dev/tty
+# 3 some systems may open it to /System/Devices/tty
 # 4 used on the Kubota Titan
 # 6 checking for... messages and results
 # 5 compiler messages saved in config.log
 if test "$silent" = yes; then
-  exec 6>/dev/null
+  exec 6>/System/Devices/null
 else
   exec 6>&1
 fi
@@ -363,9 +363,9 @@
 # Prefer explicitly selected file to automatically selected ones.
 if test -z "$CONFIG_SITE"; then
   if test "x$prefix" != xNONE; then
-    CONFIG_SITE="$prefix/share/config.site $prefix/etc/config.site"
+    CONFIG_SITE="$prefix/share/config.site $prefix/System/Settings/config.site"
   else
-    CONFIG_SITE="$ac_default_prefix/share/config.site $ac_default_prefix/etc/config.site"
+    CONFIG_SITE="$ac_default_prefix/share/config.site $ac_default_prefix/System/Settings/config.site"
   fi
 fi
 for ac_site_file in $CONFIG_SITE; do
@@ -389,9 +389,9 @@
 ac_compile='${CC-cc} -c $CFLAGS $CPPFLAGS conftest.$ac_ext 1>&5 2>&5'
 ac_link='${CC-cc} -o conftest $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS 1>&5 2>&5'
 
-if (echo "testing\c"; echo 1,2,3) | grep c >/dev/null; then
+if (echo "testing\c"; echo 1,2,3) | grep c >/System/Devices/null; then
   # Stardent Vistra SVR4 grep lacks -e, says ghazi@caip.rutgers.edu.
-  if (echo -n testing; echo 1,2,3) | sed s/-n/xn/ | grep xn >/dev/null; then
+  if (echo -n testing; echo 1,2,3) | sed s/-n/xn/ | grep xn >/System/Devices/null; then
     ac_n= ac_c='
 ' ac_t='	'
   else
@@ -417,7 +417,7 @@
 if test -n "$withval"; then
   termcapfile=$withval
 else
-  termcapfile=/etc/termcap
+  termcapfile=/System/Settings/termcap
 fi
 
 
@@ -459,7 +459,7 @@
   yes;
 #endif
 EOF
-if ${CC-cc} -E conftest.c 2>&5 | egrep yes >/dev/null 2>&1; then
+if ${CC-cc} -E conftest.c 2>&5 | egrep yes >/System/Devices/null 2>&1; then
   ac_cv_prog_gcc=yes
 else
   ac_cv_prog_gcc=no
@@ -544,11 +544,11 @@
 # Find a good install program.  We prefer a C program (faster),
 # so one script is as good as another.  But avoid the broken or
 # incompatible versions:
-# SysV /etc/install, /usr/sbin/install
-# SunOS /usr/etc/install
-# IRIX /sbin/install
-# AIX /bin/install
-# AFS /usr/afsws/bin/install, which mishandles nonexistent args
+# SysV /System/Settings/install, /System/AdminTools/install
+# SunOS /usr/System/Settings/install
+# IRIX /System/AdminTools/install
+# AIX /System/Tools/install
+# AFS /usr/afsws/System/Tools/install, which mishandles nonexistent args
 # SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
 # ./install, which can be erroneously created by make from ./install.sh.
 echo $ac_n "checking for a BSD compatible install""... $ac_c" 1>&6
@@ -560,13 +560,13 @@
   for ac_dir in $PATH; do
     # Account for people who put trailing slashes in PATH elements.
     case "$ac_dir/" in
-    /|./|.//|/etc/*|/usr/sbin/*|/usr/etc/*|/sbin/*|/usr/afsws/bin/*|/usr/ucb/*) ;;
+    /|./|.//|/System/Settings/*|/System/AdminTools/*|/usr/System/Settings/*|/System/AdminTools/*|/usr/afsws/System/Tools/*|/usr/ucb/*) ;;
     *)
       # OSF1 and SCO ODT 3.0 have their own names for install.
       for ac_prog in ginstall installbsd scoinst install; do
         if test -f $ac_dir/$ac_prog; then
 	  if test $ac_prog = install &&
-            grep dspmsg $ac_dir/$ac_prog >/dev/null 2>&1; then
+            grep dspmsg $ac_dir/$ac_prog >/System/Devices/null 2>&1; then
 	    # AIX install.  It has an incompatible calling convention.
 	    # OSF/1 installbsd also uses dspmsg, but is usable.
 	    :
@@ -613,7 +613,7 @@
 #include <assert.h>
 Syntax Error
 EOF
-eval "$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+eval "$ac_cpp conftest.$ac_ext >/System/Devices/null 2>conftest.out"
 ac_err=`grep -v '^ *+' conftest.out`
 if test -z "$ac_err"; then
   :
@@ -627,7 +627,7 @@
 #include <assert.h>
 Syntax Error
 EOF
-eval "$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+eval "$ac_cpp conftest.$ac_ext >/System/Devices/null 2>conftest.out"
 ac_err=`grep -v '^ *+' conftest.out`
 if test -z "$ac_err"; then
   :
@@ -659,7 +659,7 @@
 #include "confdefs.h"
 #include <$ac_hdr>
 EOF
-eval "$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+eval "$ac_cpp conftest.$ac_ext >/System/Devices/null 2>conftest.out"
 ac_err=`grep -v '^ *+' conftest.out`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -697,7 +697,7 @@
 main(){return(0);}
 EOF
 eval $ac_link
-if test -s conftest && (./conftest; exit) 2>/dev/null; then
+if test -s conftest && (./conftest; exit) 2>/System/Devices/null; then
   ac_cv_c_cross=no
 else
   ac_cv_c_cross=yes
@@ -720,7 +720,7 @@
 #include <string.h>
 #include <float.h>
 EOF
-eval "$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+eval "$ac_cpp conftest.$ac_ext >/System/Devices/null 2>conftest.out"
 ac_err=`grep -v '^ *+' conftest.out`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -740,7 +740,7 @@
 #include <string.h>
 EOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  egrep "memchr" >/dev/null 2>&1; then
+  egrep "memchr" >/System/Devices/null 2>&1; then
   :
 else
   rm -rf conftest*
@@ -758,7 +758,7 @@
 #include <stdlib.h>
 EOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  egrep "free" >/dev/null 2>&1; then
+  egrep "free" >/System/Devices/null 2>&1; then
   :
 else
   rm -rf conftest*
@@ -769,7 +769,7 @@
 fi
 
 if test $ac_cv_header_stdc = yes; then
-  # /bin/cc in Irix-4.0.5 gets non-ANSI ctype macros unless using -ansi.
+  # /System/Tools/cc in Irix-4.0.5 gets non-ANSI ctype macros unless using -ansi.
 if test "$cross_compiling" = yes; then
   ac_cv_header_stdc=no
 else
@@ -786,7 +786,7 @@
 
 EOF
 eval $ac_link
-if test -s conftest && (./conftest; exit) 2>/dev/null; then
+if test -s conftest && (./conftest; exit) 2>/System/Devices/null; then
   :
 else
   ac_cv_header_stdc=no
@@ -816,7 +816,7 @@
 # the --cache-file=FILE option to use a different cache file; that is
 # what configure does when it calls configure scripts in
 # subdirectories, so they share the cache.
-# Giving --cache-file=/dev/null disables caching, for debugging configure.
+# Giving --cache-file=/System/Devices/null disables caching, for debugging configure.
 # config.status only pays attention to the cache file if you give it the
 # --recheck option to rerun configure.
 #
@@ -873,11 +873,11 @@
 echo creating $CONFIG_STATUS
 rm -f $CONFIG_STATUS
 cat > $CONFIG_STATUS <<EOF
-#! /bin/sh
+#! /System/Tools/sh
 # Generated automatically by configure.
 # Run this file to recreate the current configuration.
 # This directory was configured as follows,
-# on host `(hostname || uname -n) 2>/dev/null | sed 1q`:
+# on host `(hostname || uname -n) 2>/System/Devices/null | sed 1q`:
 #
 # $0 $ac_configure_args
 #
@@ -889,8 +889,8 @@
 do
   case "\$ac_option" in
   -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
-    echo "running \${CONFIG_SHELL-/bin/sh} $0 $ac_configure_args --no-create --no-recursion"
-    exec \${CONFIG_SHELL-/bin/sh} $0 $ac_configure_args --no-create --no-recursion ;;
+    echo "running \${CONFIG_SHELL-/System/Tools/sh} $0 $ac_configure_args --no-create --no-recursion"
+    exec \${CONFIG_SHELL-/System/Tools/sh} $0 $ac_configure_args --no-create --no-recursion ;;
   -version | --version | --versio | --versi | --vers | --ver | --ve | --v)
     echo "$CONFIG_STATUS generated by autoconf version 2.4"
     exit 0 ;;
@@ -994,5 +994,5 @@
 EOF
 chmod +x $CONFIG_STATUS
 rm -fr confdefs* $ac_clean_files
-test "$no_create" = yes || ${CONFIG_SHELL-/bin/sh} $CONFIG_STATUS || exit 1
+test "$no_create" = yes || ${CONFIG_SHELL-/System/Tools/sh} $CONFIG_STATUS || exit 1
 
diff -urN bash-3.0/lib/termcap/grot/configure.in bash-3.0-STEP/lib/termcap/grot/configure.in
--- bash-3.0/lib/termcap/grot/configure.in	1995-07-27 07:46:34.000000000 +1200
+++ bash-3.0-STEP/lib/termcap/grot/configure.in	2005-08-25 00:46:57.723865384 +1200
@@ -10,8 +10,8 @@
 AC_SUBST(uninstalldata)dnl
 
 AC_ARG_WITH(termcap,
-[  --with-termcap=FILE     use data file FILE instead of /etc/termcap],
-termcapfile=$withval, termcapfile=/etc/termcap)
+[  --with-termcap=FILE     use data file FILE instead of /System/Settings/termcap],
+termcapfile=$withval, termcapfile=/System/Settings/termcap)
 AC_SUBST(termcapfile)dnl
 
 AC_PROG_CC
diff -urN bash-3.0/lib/termcap/grot/termcap.info-1 bash-3.0-STEP/lib/termcap/grot/termcap.info-1
--- bash-3.0/lib/termcap/grot/termcap.info-1	1995-07-27 03:44:12.000000000 +1200
+++ bash-3.0-STEP/lib/termcap/grot/termcap.info-1	2005-08-25 00:46:57.595884840 +1200
@@ -26,7 +26,7 @@
 
 * Introduction::  What is termcap?  Why this manual?
 * Library::     The termcap library functions.
-* Data Base::   What terminal descriptions in `/etc/termcap' look like.
+* Data Base::   What terminal descriptions in `/System/Settings/termcap' look like.
 * Capabilities::  Definitions of the individual terminal capabilities:
                  how to write them in descriptions, and how to use
                  their values to do display updating.
@@ -272,7 +272,7 @@
 to override the terminal type data base.  The function `tgetent' checks
 the value of `TERMCAP' automatically.  If the value starts with `/'
 then it is taken as a file name to use as the data base file, instead
-of `/etc/termcap' which is the standard data base.  If the value does
+of `/System/Settings/termcap' which is the standard data base.  If the value does
 not start with `/' then it is itself used as the terminal description,
 provided that the terminal type TERMTYPE is among the types it claims
 to apply to.  *Note Data Base::, for information on the format of a
@@ -986,7 +986,7 @@
 ***************************
 
    The termcap data base of terminal descriptions is stored in the file
-`/etc/termcap'.  It contains terminal descriptions, blank lines, and
+`/System/Settings/termcap'.  It contains terminal descriptions, blank lines, and
 comments.
 
    A terminal description starts with one or more names for the
diff -urN bash-3.0/lib/termcap/grot/termcap.texi bash-3.0-STEP/lib/termcap/grot/termcap.texi
--- bash-3.0/lib/termcap/grot/termcap.texi	1999-08-06 00:29:35.000000000 +1200
+++ bash-3.0-STEP/lib/termcap/grot/termcap.texi	2005-08-25 00:46:57.665874200 +1200
@@ -89,7 +89,7 @@
 @menu
 * Introduction::  What is termcap?  Why this manual?
 * Library::     The termcap library functions.
-* Data Base::   What terminal descriptions in @file{/etc/termcap} look like.
+* Data Base::   What terminal descriptions in @file{/System/Settings/termcap} look like.
 * Capabilities::  Definitions of the individual terminal capabilities:
                  how to write them in descriptions, and how to use
                  their values to do display updating.
@@ -342,7 +342,7 @@
 override the terminal type data base.  The function @code{tgetent} checks
 the value of @code{TERMCAP} automatically.  If the value starts with
 @samp{/} then it is taken as a file name to use as the data base file,
-instead of @file{/etc/termcap} which is the standard data base.  If the
+instead of @file{/System/Settings/termcap} which is the standard data base.  If the
 value does not start with @samp{/} then it is itself used as the terminal
 description, provided that the terminal type @var{termtype} is among the
 types it claims to apply to.  @xref{Data Base}, for information on the
@@ -1070,7 +1070,7 @@
 @chapter The Format of the Data Base
 
 The termcap data base of terminal descriptions is stored in the file
-@file{/etc/termcap}.  It contains terminal descriptions, blank lines, and
+@file{/System/Settings/termcap}.  It contains terminal descriptions, blank lines, and
 comments.
 
 A terminal description starts with one or more names for the terminal type.
diff -urN bash-3.0/lib/termcap/termcap.c bash-3.0-STEP/lib/termcap/termcap.c
--- bash-3.0/lib/termcap/termcap.c	2002-10-13 07:48:53.000000000 +1300
+++ bash-3.0-STEP/lib/termcap/termcap.c	2005-08-25 00:46:57.748861584 +1200
@@ -88,7 +88,7 @@
 #include "ltcap.h"
 
 #ifndef TERMCAP_FILE
-#define TERMCAP_FILE "/etc/termcap"
+#define TERMCAP_FILE "/System/Settings/termcap"
 #endif
 
 #ifndef emacs
@@ -482,7 +482,7 @@
   filep = termcap_name && valid_filename_p (termcap_name);
 
   /* If termcap_name is non-null and starts with / (in the un*x case, that is),
-     it is a file name to use instead of /etc/termcap.
+     it is a file name to use instead of /System/Settings/termcap.
      If it is non-null and does not start with /,
      it is the entry itself, but only if
      the name the caller requested matches the TERM variable.  */
@@ -499,7 +499,7 @@
 	  goto ret;
 	}
       else
-	{			/* It has tc=.  Need to read /etc/termcap.  */
+	{			/* It has tc=.  Need to read /System/Settings/termcap.  */
 	  tcenv = termcap_name;
  	  termcap_name = NULL;
 	}
diff -urN bash-3.0/make_cmd.c bash-3.0-STEP/make_cmd.c
--- bash-3.0/make_cmd.c	2003-12-20 09:46:56.000000000 +1300
+++ bash-3.0-STEP/make_cmd.c	2005-08-25 00:34:11.079413056 +1200
@@ -803,7 +803,7 @@
    list followed by an ampersand (`&') and do a simple command connection,
    making the entire list effectively asynchronous, instead of just
    the last command.  This means that when the list is executed, all
-   the commands have stdin set to /dev/null when job control is not
+   the commands have stdin set to /System/Devices/null when job control is not
    active, instead of just the last.  This is wrong, and needs fixing
    up.  This function takes the `&' and applies it to the last command
    in the list.  This is done only for lists connected by `;'; it makes
diff -urN bash-3.0/nojobs.c bash-3.0-STEP/nojobs.c
--- bash-3.0/nojobs.c	2003-12-20 09:42:28.000000000 +1300
+++ bash-3.0-STEP/nojobs.c	2005-08-25 00:34:11.087411840 +1200
@@ -550,7 +550,7 @@
 
 #if defined (BUFFERED_INPUT)
   /* If default_buffered_input is active, we are reading a script.  If
-     the command is asynchronous, we have already duplicated /dev/null
+     the command is asynchronous, we have already duplicated /System/Devices/null
      as fd 0, but have not changed the buffered stream corresponding to
      the old fd 0.  We don't want to sync the stream in this case. */
   if (default_buffered_input != -1 && (!async_p || default_buffered_input > 0))
diff -urN bash-3.0/pathnames.h.in bash-3.0-STEP/pathnames.h.in
--- bash-3.0/pathnames.h.in	2003-02-26 05:31:46.000000000 +1300
+++ bash-3.0-STEP/pathnames.h.in	2005-08-25 00:46:57.753860824 +1200
@@ -22,10 +22,10 @@
 #define _PATHNAMES_H_
 
 /* The default file for hostname completion. */
-#define DEFAULT_HOSTS_FILE "/etc/hosts"
+#define DEFAULT_HOSTS_FILE "/System/Settings/hosts"
 
 /* The default login shell startup file. */
-#define SYS_PROFILE "/etc/profile"
+#define SYS_PROFILE "/System/Settings/profile"
 
 /* The default location of the bash debugger initialization/startup file. */
 #define DEBUGGER_START_FILE	"@DEBUGGER_START_FILE@"
diff -urN bash-3.0/po/Makefile.in.in bash-3.0-STEP/po/Makefile.in.in
--- bash-3.0/po/Makefile.in.in	2003-12-23 09:34:31.000000000 +1300
+++ bash-3.0-STEP/po/Makefile.in.in	2005-08-25 00:34:11.112408040 +1200
@@ -11,7 +11,7 @@
 PACKAGE = @PACKAGE_NAME@
 VERSION = @PACKAGE_VERSION@
 
-SHELL = /bin/sh
+SHELL = /System/Tools/sh
 @SET_MAKE@
 
 srcdir = @srcdir@
@@ -111,7 +111,7 @@
 	  if test -f $(srcdir)/$(DOMAIN).pot; then \
 	    sed -f remove-potcdate.sed < $(srcdir)/$(DOMAIN).pot > $(DOMAIN).1po && \
 	    sed -f remove-potcdate.sed < $(DOMAIN).po > $(DOMAIN).2po && \
-	    if cmp $(DOMAIN).1po $(DOMAIN).2po >/dev/null 2>&1; then \
+	    if cmp $(DOMAIN).1po $(DOMAIN).2po >/System/Devices/null 2>&1; then \
 	      rm -f $(DOMAIN).1po $(DOMAIN).2po $(DOMAIN).po; \
 	    else \
 	      rm -f $(DOMAIN).1po $(DOMAIN).2po $(srcdir)/$(DOMAIN).pot && \
@@ -166,7 +166,7 @@
 	  echo "installing $$realcat as $(DESTDIR)$$dir/$(DOMAIN).mo"; \
 	  for lc in '' $(EXTRA_LOCALE_CATEGORIES); do \
 	    if test -n "$$lc"; then \
-	      if (cd $(DESTDIR)$(localedir)/$$lang && LC_ALL=C ls -l -d $$lc 2>/dev/null) | grep ' -> ' >/dev/null; then \
+	      if (cd $(DESTDIR)$(localedir)/$$lang && LC_ALL=C ls -l -d $$lc 2>/System/Devices/null) | grep ' -> ' >/System/Devices/null; then \
 	        link=`cd $(DESTDIR)$(localedir)/$$lang && LC_ALL=C ls -l -d $$lc | sed -e 's/^.* -> //'`; \
 	        mv $(DESTDIR)$(localedir)/$$lang/$$lc $(DESTDIR)$(localedir)/$$lang/$$lc.old; \
 	        mkdir $(DESTDIR)$(localedir)/$$lang/$$lc; \
@@ -186,8 +186,8 @@
 	        fi; \
 	      fi; \
 	      rm -f $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo; \
-	      ln -s ../LC_MESSAGES/$(DOMAIN).mo $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo 2>/dev/null || \
-	      ln $(DESTDIR)$(localedir)/$$lang/LC_MESSAGES/$(DOMAIN).mo $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo 2>/dev/null || \
+	      ln -s ../LC_MESSAGES/$(DOMAIN).mo $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo 2>/System/Devices/null || \
+	      ln $(DESTDIR)$(localedir)/$$lang/LC_MESSAGES/$(DOMAIN).mo $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo 2>/System/Devices/null || \
 	      cp -p $(DESTDIR)$(localedir)/$$lang/LC_MESSAGES/$(DOMAIN).mo $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo; \
 	      echo "installing $$realcat link as $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo"; \
 	    fi; \
@@ -215,7 +215,7 @@
 	  $(mkinstalldirs) $(DESTDIR)$$dir; \
 	  for lc in '' $(EXTRA_LOCALE_CATEGORIES); do \
 	    if test -n "$$lc"; then \
-	      if (cd $(DESTDIR)$(localedir)/$$lang && LC_ALL=C ls -l -d $$lc 2>/dev/null) | grep ' -> ' >/dev/null; then \
+	      if (cd $(DESTDIR)$(localedir)/$$lang && LC_ALL=C ls -l -d $$lc 2>/System/Devices/null) | grep ' -> ' >/System/Devices/null; then \
 	        link=`cd $(DESTDIR)$(localedir)/$$lang && LC_ALL=C ls -l -d $$lc | sed -e 's/^.* -> //'`; \
 	        mv $(DESTDIR)$(localedir)/$$lang/$$lc $(DESTDIR)$(localedir)/$$lang/$$lc.old; \
 	        mkdir $(DESTDIR)$(localedir)/$$lang/$$lc; \
@@ -325,7 +325,7 @@
 	echo "$${cdcmd}$(MSGMERGE) $$lang.po $(DOMAIN).pot -o $$lang.new.po"; \
 	cd $(srcdir); \
 	if $(MSGMERGE) $$lang.po $(DOMAIN).pot -o $$tmpdir/$$lang.new.po; then \
-	  if cmp $$lang.po $$tmpdir/$$lang.new.po >/dev/null 2>&1; then \
+	  if cmp $$lang.po $$tmpdir/$$lang.new.po >/System/Devices/null 2>&1; then \
 	    rm -f $$tmpdir/$$lang.new.po; \
 	  else \
 	    if mv -f $$tmpdir/$$lang.new.po $$lang.po; then \
diff -urN bash-3.0/po/Rules-quot bash-3.0-STEP/po/Rules-quot
--- bash-3.0/po/Rules-quot	2003-12-10 06:39:11.000000000 +1300
+++ bash-3.0-STEP/po/Rules-quot	2005-08-25 00:34:11.118407128 +1200
@@ -15,8 +15,8 @@
 	ll=`echo $$lang | sed -e 's/@.*//'`; \
 	LC_ALL=C; export LC_ALL; \
 	cd $(srcdir); \
-	if $(MSGINIT) -i $(DOMAIN).pot --no-translator -l $$ll -o - 2>/dev/null | sed -f $$tmpdir/$$lang.insert-header | $(MSGCONV) -t UTF-8 | $(MSGFILTER) sed -f `echo $$lang | sed -e 's/.*@//'`.sed 2>/dev/null > $$tmpdir/$$lang.new.po; then \
-	  if cmp $$lang.po $$tmpdir/$$lang.new.po >/dev/null 2>&1; then \
+	if $(MSGINIT) -i $(DOMAIN).pot --no-translator -l $$ll -o - 2>/System/Devices/null | sed -f $$tmpdir/$$lang.insert-header | $(MSGCONV) -t UTF-8 | $(MSGFILTER) sed -f `echo $$lang | sed -e 's/.*@//'`.sed 2>/System/Devices/null > $$tmpdir/$$lang.new.po; then \
+	  if cmp $$lang.po $$tmpdir/$$lang.new.po >/System/Devices/null 2>&1; then \
 	    rm -f $$tmpdir/$$lang.new.po; \
 	  else \
 	    if mv -f $$tmpdir/$$lang.new.po $$lang.po; then \
diff -urN bash-3.0/po/bash.pot bash-3.0-STEP/po/bash.pot
--- bash-3.0/po/bash.pot	2004-05-01 14:40:24.000000000 +1200
+++ bash-3.0-STEP/po/bash.pot	2005-08-25 00:47:18.149760176 +1200
@@ -789,7 +789,7 @@
 
 #: execute_cmd.c:466
 #, c-format
-msgid "cannot redirect standard input from /dev/null: %s"
+msgid "cannot redirect standard input from /System/Devices/null: %s"
 msgstr ""
 
 #: execute_cmd.c:1036
@@ -1214,7 +1214,7 @@
 msgstr ""
 
 #: redir.c:509
-msgid "/dev/(tcp|udp)/host/port not supported without networking"
+msgid "/System/Devices/(tcp|udp)/host/port not supported without networking"
 msgstr ""
 
 #: redir.c:949
@@ -1222,11 +1222,11 @@
 msgstr ""
 
 #: shell.c:302
-msgid "could not find /tmp, please create!"
+msgid "could not find /System/TemporaryFiles, please create!"
 msgstr ""
 
 #: shell.c:306
-msgid "/tmp must be a valid directory name"
+msgid "/System/TemporaryFiles must be a valid directory name"
 msgstr ""
 
 #: shell.c:839
Binary files bash-3.0/po/en@boldquot.gmo and bash-3.0-STEP/po/en@boldquot.gmo differ
diff -urN bash-3.0/po/en@boldquot.po bash-3.0-STEP/po/en@boldquot.po
--- bash-3.0/po/en@boldquot.po	2004-06-30 02:47:39.000000000 +1200
+++ bash-3.0-STEP/po/en@boldquot.po	2005-08-25 00:47:18.342730840 +1200
@@ -835,8 +835,8 @@
 
 #: execute_cmd.c:466
 #, c-format
-msgid "cannot redirect standard input from /dev/null: %s"
-msgstr "cannot redirect standard input from /dev/null: %s"
+msgid "cannot redirect standard input from /System/Devices/null: %s"
+msgstr "cannot redirect standard input from /System/Devices/null: %s"
 
 #: execute_cmd.c:1036
 #, c-format
@@ -1262,20 +1262,20 @@
 msgstr "cannot create temp file for here document: %s"
 
 #: redir.c:509
-msgid "/dev/(tcp|udp)/host/port not supported without networking"
-msgstr "/dev/(tcp|udp)/host/port not supported without networking"
+msgid "/System/Devices/(tcp|udp)/host/port not supported without networking"
+msgstr "/System/Devices/(tcp|udp)/host/port not supported without networking"
 
 #: redir.c:949
 msgid "redirection error: cannot duplicate fd"
 msgstr "redirection error: cannot duplicate fd"
 
 #: shell.c:302
-msgid "could not find /tmp, please create!"
-msgstr "could not find /tmp, please create!"
+msgid "could not find /System/TemporaryFiles, please create!"
+msgstr "could not find /System/TemporaryFiles, please create!"
 
 #: shell.c:306
-msgid "/tmp must be a valid directory name"
-msgstr "/tmp must be a valid directory name"
+msgid "/System/TemporaryFiles must be a valid directory name"
+msgstr "/System/TemporaryFiles must be a valid directory name"
 
 #: shell.c:839
 #, c-format
Binary files bash-3.0/po/en@quot.gmo and bash-3.0-STEP/po/en@quot.gmo differ
diff -urN bash-3.0/po/en@quot.po bash-3.0-STEP/po/en@quot.po
--- bash-3.0/po/en@quot.po	2004-06-30 02:47:34.000000000 +1200
+++ bash-3.0-STEP/po/en@quot.po	2005-08-25 00:47:18.249744976 +1200
@@ -822,8 +822,8 @@
 
 #: execute_cmd.c:466
 #, c-format
-msgid "cannot redirect standard input from /dev/null: %s"
-msgstr "cannot redirect standard input from /dev/null: %s"
+msgid "cannot redirect standard input from /System/Devices/null: %s"
+msgstr "cannot redirect standard input from /System/Devices/null: %s"
 
 #: execute_cmd.c:1036
 #, c-format
@@ -1249,20 +1249,20 @@
 msgstr "cannot create temp file for here document: %s"
 
 #: redir.c:509
-msgid "/dev/(tcp|udp)/host/port not supported without networking"
-msgstr "/dev/(tcp|udp)/host/port not supported without networking"
+msgid "/System/Devices/(tcp|udp)/host/port not supported without networking"
+msgstr "/System/Devices/(tcp|udp)/host/port not supported without networking"
 
 #: redir.c:949
 msgid "redirection error: cannot duplicate fd"
 msgstr "redirection error: cannot duplicate fd"
 
 #: shell.c:302
-msgid "could not find /tmp, please create!"
-msgstr "could not find /tmp, please create!"
+msgid "could not find /System/TemporaryFiles, please create!"
+msgstr "could not find /System/TemporaryFiles, please create!"
 
 #: shell.c:306
-msgid "/tmp must be a valid directory name"
-msgstr "/tmp must be a valid directory name"
+msgid "/System/TemporaryFiles must be a valid directory name"
+msgstr "/System/TemporaryFiles must be a valid directory name"
 
 #: shell.c:839
 #, c-format
diff -urN bash-3.0/redir.c bash-3.0-STEP/redir.c
--- bash-3.0/redir.c	2003-12-20 10:01:29.000000000 +1300
+++ bash-3.0-STEP/redir.c	2005-08-25 00:34:11.436358792 +1200
@@ -447,16 +447,16 @@
    code handles specially. */
 static STRING_INT_ALIST _redir_special_filenames[] = {
 #if !defined (HAVE_DEV_FD)
-  { "/dev/fd/[0-9]*", RF_DEVFD },
+  { "/System/Devices/fd/[0-9]*", RF_DEVFD },
 #endif
 #if !defined (HAVE_DEV_STDIN)
-  { "/dev/stderr", RF_DEVSTDERR },
-  { "/dev/stdin", RF_DEVSTDIN },
-  { "/dev/stdout", RF_DEVSTDOUT },
+  { "/System/Devices/stderr", RF_DEVSTDERR },
+  { "/System/Devices/stdin", RF_DEVSTDIN },
+  { "/System/Devices/stdout", RF_DEVSTDOUT },
 #endif
 #if defined (NETWORK_REDIRECTIONS)
-  { "/dev/tcp/*/*", RF_DEVTCP },
-  { "/dev/udp/*/*", RF_DEVUDP },
+  { "/System/Devices/tcp/*/*", RF_DEVTCP },
+  { "/System/Devices/udp/*/*", RF_DEVUDP },
 #endif
   { (char *)NULL, -1 }
 };
@@ -506,7 +506,7 @@
 #if defined (HAVE_NETWORK)
       fd = netopen (filename);
 #else
-      internal_warning (_("/dev/(tcp|udp)/host/port not supported without networking"));
+      internal_warning (_("/System/Devices/(tcp|udp)/host/port not supported without networking"));
       fd = open (filename, flags, mode);
 #endif
       break;
@@ -765,7 +765,7 @@
 
 #if defined (BUFFERED_INPUT)
 	  /* Do not change the buffered stream for an implicit redirection
-	     of /dev/null to fd 0 for asynchronous commands without job
+	     of /System/Devices/null to fd 0 for asynchronous commands without job
 	     control (r_inputa_direction). */
 	  if (ri == r_input_direction || ri == r_input_output)
 	    duplicate_buffered_stream (fd, redirector);
diff -urN bash-3.0/shell.c bash-3.0-STEP/shell.c
--- bash-3.0/shell.c	2004-06-27 06:27:07.000000000 +1200
+++ bash-3.0-STEP/shell.c	2005-08-25 00:47:18.403721568 +1200
@@ -298,12 +298,12 @@
 {
   struct stat sb;
 
-  if (stat ("/tmp", &sb) < 0)
-    internal_warning (_("could not find /tmp, please create!"));
+  if (stat ("/System/TemporaryFiles", &sb) < 0)
+    internal_warning (_("could not find /System/TemporaryFiles, please create!"));
   else
     {
       if (S_ISDIR (sb.st_mode) == 0)
-	internal_warning (_("/tmp must be a valid directory name"));
+	internal_warning (_("/System/TemporaryFiles must be a valid directory name"));
     }
 }
 #endif /* __CYGWIN__ */
@@ -911,7 +911,7 @@
 
    If the executable file "/usr/gnu/src/bash/foo" contains:
 
-   #!/usr/gnu/bin/bash
+   #!/usr/gnu/System/Tools/bash
    echo hello
 
    then:
@@ -998,7 +998,7 @@
       /* We don't execute .bashrc for login shells. */
       no_rc++;
 
-      /* Execute /etc/profile and one of the personal login shell
+      /* Execute /System/Settings/profile and one of the personal login shell
 	 initialization files. */
       if (no_profile == 0)
 	{
@@ -1034,7 +1034,7 @@
 	  /* We don't execute .bashrc for login shells. */
 	  no_rc++;
 
-	  /* Execute /etc/profile and one of the personal login shell
+	  /* Execute /System/Settings/profile and one of the personal login shell
 	     initialization files. */
 	  if (no_profile == 0)
 	    {
@@ -1437,7 +1437,7 @@
 #endif /* !BUFFERED_INPUT */
 
   /* Just about the only way for this code to be executed is if something
-     like `bash -i /dev/stdin' is executed. */
+     like `bash -i /System/Devices/stdin' is executed. */
   if (interactive_shell && fd_is_tty)
     {
       dup2 (fd, 0);
@@ -1523,7 +1523,7 @@
      char *argv0;
 {
   /* Here's a hack.  If the name of this shell is "sh", then don't do
-     any startup files; just try to be more like /bin/sh. */
+     any startup files; just try to be more like /System/Tools/sh. */
   shell_name = base_pathname (argv0);
 
   if (*shell_name == '-')
@@ -1542,7 +1542,7 @@
   dollar_vars[0] = savestring (shell_name);
 
   /* A program may start an interactive shell with
-	  "execl ("/bin/bash", "-", NULL)".
+	  "execl ("/System/Tools/bash", "-", NULL)".
      If so, default the name of this shell to our name. */
   if (!shell_name || !*shell_name || (shell_name[0] == '-' && !shell_name[1]))
     shell_name = PROGRAM;
@@ -1583,14 +1583,14 @@
 	  current_user.user_name = savestring (entry->pw_name);
 	  current_user.shell = (entry->pw_shell && entry->pw_shell[0])
 				? savestring (entry->pw_shell)
-				: savestring ("/bin/sh");
+				: savestring ("/System/Tools/sh");
 	  current_user.home_dir = savestring (entry->pw_dir);
 	}
       else
 	{
 	  current_user.user_name = _("I have no name!");
 	  current_user.user_name = savestring (current_user.user_name);
-	  current_user.shell = savestring ("/bin/sh");
+	  current_user.shell = savestring ("/System/Tools/sh");
 	  current_user.home_dir = savestring ("/");
 	}
       endpwent ();
diff -urN bash-3.0/subst.c bash-3.0-STEP/subst.c
--- bash-3.0/subst.c	2004-07-05 05:56:13.000000000 +1200
+++ bash-3.0-STEP/subst.c	2005-08-25 00:34:11.523345568 +1200
@@ -3843,9 +3843,9 @@
 
 /* Return a filename that will open a connection to the process defined by
    executing STRING.  HAVE_DEV_FD, if defined, means open a pipe and return
-   a filename in /dev/fd corresponding to a descriptor that is one of the
+   a filename in /System/Devices/fd corresponding to a descriptor that is one of the
    ends of the pipe.  If not defined, we use named pipes on systems that have
-   them.  Systems without /dev/fd and named pipes are out of luck.
+   them.  Systems without /System/Devices/fd and named pipes are out of luck.
 
    OPEN_FOR_READ_IN_CHILD, if 1, means open the named pipe for reading or
    use the read end of the pipe and dup that file descriptor to fd 0 in
diff -urN bash-3.0/support/bashbug.sh bash-3.0-STEP/support/bashbug.sh
--- bash-3.0/support/bashbug.sh	2004-04-29 01:46:45.000000000 +1200
+++ bash-3.0-STEP/support/bashbug.sh	2005-08-25 00:47:18.423718528 +1200
@@ -1,4 +1,4 @@
-#!/bin/sh -
+#!/System/Tools/sh -
 #
 # bashbug - create a bug report and mail it to the bug address
 #
@@ -36,11 +36,11 @@
 RELSTATUS="!RELSTATUS!"
 MACHTYPE="!MACHTYPE!"
 
-PATH=/bin:/usr/bin:/usr/local/bin:$PATH
+PATH=/bin:/System/Tools:/usr/local/bin:$PATH
 export PATH
 
-# Check if TMPDIR is set, default to /tmp
-: ${TMPDIR:=/tmp}
+# Check if TMPDIR is set, default to /System/TemporaryFiles
+: ${TMPDIR:=/System/TemporaryFiles}
 
 #Securely create a temporary directory for the temporary files
 TEMPDIR=$TMPDIR/bbug.$$
@@ -121,23 +121,23 @@
 BUGADDR="${1-$BUGBASH}"
 
 if [ -z "$DEFEDITOR" ] && [ -z "$EDITOR" ]; then
-	if [ -x /usr/bin/editor ]; then
+	if [ -x /System/Tools/editor ]; then
 		DEFEDITOR=editor
-	elif [ -x /usr/local/bin/ce ]; then
+	elif [ -x /usr/local/System/Tools/ce ]; then
 		DEFEDITOR=ce
-	elif [ -x /usr/local/bin/emacs ]; then
+	elif [ -x /usr/local/System/Tools/emacs ]; then
 		DEFEDITOR=emacs
-	elif [ -x /usr/contrib/bin/emacs ]; then
+	elif [ -x /usr/contrib/System/Tools/emacs ]; then
 		DEFEDITOR=emacs
-	elif [ -x /usr/bin/emacs ]; then
+	elif [ -x /System/Tools/emacs ]; then
 		DEFEDITOR=emacs
-	elif [ -x /usr/bin/xemacs ]; then
+	elif [ -x /System/Tools/xemacs ]; then
 		DEFEDITOR=xemacs
-	elif [ -x /usr/contrib/bin/jove ]; then
+	elif [ -x /usr/contrib/System/Tools/jove ]; then
 		DEFEDITOR=jove
-	elif [ -x /usr/local/bin/jove ]; then
+	elif [ -x /usr/local/System/Tools/jove ]; then
 		DEFEDITOR=jove
-	elif [ -x /usr/bin/vi ]; then
+	elif [ -x /System/Tools/vi ]; then
 		DEFEDITOR=vi
 	else
 		echo "$0: No default editor found: attempting to use vi" >&2
@@ -154,15 +154,15 @@
 trap 'rm -rf "$TEMPDIR"' 0
 
 UN=
-if (uname) >/dev/null 2>&1; then
+if (uname) >/System/Devices/null 2>&1; then
 	UN=`uname -a`
 fi
 
 if [ -f /usr/lib/sendmail ] ; then
 	RMAIL="/usr/lib/sendmail"
 	SMARGS="-i -t"
-elif [ -f /usr/sbin/sendmail ] ; then
-	RMAIL="/usr/sbin/sendmail"
+elif [ -f /System/AdminTools/sendmail ] ; then
+	RMAIL="/System/AdminTools/sendmail"
 	SMARGS="-i -t"
 else
 	RMAIL=rmail
diff -urN bash-3.0/support/config.guess bash-3.0-STEP/support/config.guess
--- bash-3.0/support/config.guess	2003-09-11 01:16:43.000000000 +1200
+++ bash-3.0-STEP/support/config.guess	2005-08-25 00:47:18.412720200 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 # Attempt to guess a canonical system name.
 #   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
 #   2000, 2001, 2002 Free Software Foundation, Inc.
@@ -100,7 +100,7 @@
 
 # This shell variable is my proudest work .. or something. --bje
 
-set_cc_for_build='tmpdir=${TMPDIR-/tmp}/config-guess-$$ ;
+set_cc_for_build='tmpdir=${TMPDIR-/System/TemporaryFiles}/config-guess-$$ ;
 (old=`umask` && umask 077 && mkdir $tmpdir && umask $old && unset old)
    || (echo "$me: cannot create $tmpdir" >&2 && exit 1) ;
 dummy=$tmpdir/dummy ;
@@ -109,7 +109,7 @@
 case $CC_FOR_BUILD,$HOST_CC,$CC in
  ,,)    echo "int x;" > $dummy.c ;
 	for c in cc gcc c89 c99 ; do
-	  if ($c -c -o $dummy.o $dummy.c) >/dev/null 2>&1 ; then
+	  if ($c -c -o $dummy.o $dummy.c) >/System/Devices/null 2>&1 ; then
 	     CC_FOR_BUILD="$c"; break ;
 	  fi ;
 	done ;
@@ -125,14 +125,14 @@
 
 # This is needed to find uname on a Pyramid OSx when run in the BSD universe.
 # (ghazi@noc.rutgers.edu 1994-08-24)
-if (test -f /.attbin/uname) >/dev/null 2>&1 ; then
+if (test -f /.attbin/uname) >/System/Devices/null 2>&1 ; then
 	PATH=$PATH:/.attbin ; export PATH
 fi
 
-UNAME_MACHINE=`(uname -m) 2>/dev/null` || UNAME_MACHINE=unknown
-UNAME_RELEASE=`(uname -r) 2>/dev/null` || UNAME_RELEASE=unknown
-UNAME_SYSTEM=`(uname -s) 2>/dev/null`  || UNAME_SYSTEM=unknown
-UNAME_VERSION=`(uname -v) 2>/dev/null` || UNAME_VERSION=unknown
+UNAME_MACHINE=`(uname -m) 2>/System/Devices/null` || UNAME_MACHINE=unknown
+UNAME_RELEASE=`(uname -r) 2>/System/Devices/null` || UNAME_RELEASE=unknown
+UNAME_SYSTEM=`(uname -s) 2>/System/Devices/null`  || UNAME_SYSTEM=unknown
+UNAME_VERSION=`(uname -v) 2>/System/Devices/null` || UNAME_VERSION=unknown
 
 # Note: order is significant - the case branches are not exclusive.
 
@@ -149,8 +149,8 @@
 	# Note: NetBSD doesn't particularly care about the vendor
 	# portion of the name.  We always set it to "unknown".
 	sysctl="sysctl -n hw.machine_arch"
-	UNAME_MACHINE_ARCH=`(/sbin/$sysctl 2>/dev/null || \
-	    /usr/sbin/$sysctl 2>/dev/null || echo unknown)`
+	UNAME_MACHINE_ARCH=`(/System/AdminTools/$sysctl 2>/System/Devices/null || \
+	    /System/AdminTools/$sysctl 2>/System/Devices/null || echo unknown)`
 	case "${UNAME_MACHINE_ARCH}" in
 	    armeb) machine=armeb-unknown ;;
 	    arm*) machine=arm-unknown ;;
@@ -163,8 +163,8 @@
 	case "${UNAME_MACHINE_ARCH}" in
 	    arm*|i386|m68k|ns32k|sh3*|sparc|vax)
 		eval $set_cc_for_build
-		if echo __ELF__ | $CC_FOR_BUILD -E - 2>/dev/null \
-			| grep __ELF__ >/dev/null
+		if echo __ELF__ | $CC_FOR_BUILD -E - 2>/System/Devices/null \
+			| grep __ELF__ >/System/Devices/null
 		then
 		    # Once all utilities can be ECOFF (netbsdecoff) or a.out (netbsdaout).
 		    # Return netbsd for either.  FIX?
@@ -236,7 +236,7 @@
 	exit 0 ;;
     alpha:OSF1:*:*)
 	if test $UNAME_RELEASE = "V4.0"; then
-		UNAME_RELEASE=`/usr/sbin/sizer -v | awk '{print $3}'`
+		UNAME_RELEASE=`/System/AdminTools/sizer -v | awk '{print $3}'`
 	fi
 	# A Vn.n version is a released version.
 	# A Tn.n version is a released field test version.
@@ -268,7 +268,7 @@
 	jsr \$26,exit
 	.end main
 EOF
-	$CC_FOR_BUILD -o $dummy $dummy.s 2>/dev/null
+	$CC_FOR_BUILD -o $dummy $dummy.s 2>/System/Devices/null
 	if test "$?" = 0 ; then
 		case `$dummy` in
 			0-0)
@@ -329,7 +329,7 @@
 	exit 0;;
     Pyramid*:OSx*:*:* | MIS*:OSx*:*:* | MIS*:SMP_DC-OSx*:*:*)
 	# akee@wpdis03.wpafb.af.mil (Earle F. Ake) contributed MIS and NILE.
-	if test "`(/bin/universe) 2>/dev/null`" = att ; then
+	if test "`(/System/Tools/universe) 2>/System/Devices/null`" = att ; then
 		echo pyramid-pyramid-sysv3
 	else
 		echo pyramid-pyramid-bsd
@@ -339,7 +339,7 @@
 	echo pyramid-pyramid-svr4
 	exit 0 ;;
     DRS?6000:UNIX_SV:4.2*:7*)
-	case `/usr/bin/uname -p` in
+	case `/System/Tools/uname -p` in
 	    sparc) echo sparc-icl-nx7 && exit 0 ;;
 	esac ;;
     sun4H:SunOS:5.*:*)
@@ -358,7 +358,7 @@
 	echo sparc-sun-solaris3`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
 	exit 0 ;;
     sun4*:SunOS:*:*)
-	case "`/usr/bin/arch -k`" in
+	case "`/System/Tools/arch -k`" in
 	    Series*|S4*)
 		UNAME_RELEASE=`uname -v`
 		;;
@@ -370,9 +370,9 @@
 	echo m68k-sun-sunos${UNAME_RELEASE}
 	exit 0 ;;
     sun*:*:4.2BSD:*)
-	UNAME_RELEASE=`(sed 1q /etc/motd | awk '{print substr($5,1,3)}') 2>/dev/null`
+	UNAME_RELEASE=`(sed 1q /System/Settings/motd | awk '{print substr($5,1,3)}') 2>/System/Devices/null`
 	test "x${UNAME_RELEASE}" = "x" && UNAME_RELEASE=3
-	case "`/bin/arch`" in
+	case "`/System/Tools/arch`" in
 	    sun3)
 		echo m68k-sun-sunos${UNAME_RELEASE}
 		;;
@@ -477,7 +477,7 @@
 	exit 0 ;;
     AViiON:dgux:*:*)
         # DG/UX returns AViiON for all architectures
-        UNAME_PROCESSOR=`/usr/bin/uname -p`
+        UNAME_PROCESSOR=`/System/Tools/uname -p`
 	if [ $UNAME_PROCESSOR = mc88100 ] || [ $UNAME_PROCESSOR = mc88110 ]
 	then
 	    if [ ${TARGET_BINARY_INTERFACE}x = m88kdguxelfx ] || \
@@ -514,15 +514,15 @@
 	echo i386-ibm-aix
 	exit 0 ;;
     ia64:AIX:*:*)
-	if [ -x /usr/bin/oslevel ] ; then
-		IBM_REV=`/usr/bin/oslevel`
+	if [ -x /System/Tools/oslevel ] ; then
+		IBM_REV=`/System/Tools/oslevel`
 	else
 		IBM_REV=${UNAME_VERSION}.${UNAME_RELEASE}
 	fi
 	echo ${UNAME_MACHINE}-ibm-aix${IBM_REV}
 	exit 0 ;;
     *:AIX:2:3)
-	if grep bos325 /usr/include/stdio.h >/dev/null 2>&1; then
+	if grep bos325 /usr/include/stdio.h >/System/Devices/null 2>&1; then
 		eval $set_cc_for_build
 		sed 's/^		//' << EOF >$dummy.c
 		#include <sys/systemcfg.h>
@@ -538,21 +538,21 @@
 		$CC_FOR_BUILD -o $dummy $dummy.c && $dummy && rm -f $dummy.c $dummy && rmdir $tmpdir && exit 0
 		rm -f $dummy.c $dummy && rmdir $tmpdir
 		echo rs6000-ibm-aix3.2.5
-	elif grep bos324 /usr/include/stdio.h >/dev/null 2>&1; then
+	elif grep bos324 /usr/include/stdio.h >/System/Devices/null 2>&1; then
 		echo rs6000-ibm-aix3.2.4
 	else
 		echo rs6000-ibm-aix3.2
 	fi
 	exit 0 ;;
     *:AIX:*:[45])
-	IBM_CPU_ID=`/usr/sbin/lsdev -C -c processor -S available | sed 1q | awk '{ print $1 }'`
-	if /usr/sbin/lsattr -El ${IBM_CPU_ID} | grep ' POWER' >/dev/null 2>&1; then
+	IBM_CPU_ID=`/System/AdminTools/lsdev -C -c processor -S available | sed 1q | awk '{ print $1 }'`
+	if /System/AdminTools/lsattr -El ${IBM_CPU_ID} | grep ' POWER' >/System/Devices/null 2>&1; then
 		IBM_ARCH=rs6000
 	else
 		IBM_ARCH=powerpc
 	fi
-	if [ -x /usr/bin/oslevel ] ; then
-		IBM_REV=`/usr/bin/oslevel`
+	if [ -x /System/Tools/oslevel ] ; then
+		IBM_REV=`/System/Tools/oslevel`
 	else
 		IBM_REV=${UNAME_VERSION}.${UNAME_RELEASE}
 	fi
@@ -585,9 +585,9 @@
 	    9000/31? )            HP_ARCH=m68000 ;;
 	    9000/[34]?? )         HP_ARCH=m68k ;;
 	    9000/[678][0-9][0-9])
-		if [ -x /usr/bin/getconf ]; then
-		    sc_cpu_version=`/usr/bin/getconf SC_CPU_VERSION 2>/dev/null`
-                    sc_kernel_bits=`/usr/bin/getconf SC_KERNEL_BITS 2>/dev/null`
+		if [ -x /System/Tools/getconf ]; then
+		    sc_cpu_version=`/System/Tools/getconf SC_CPU_VERSION 2>/System/Devices/null`
+                    sc_kernel_bits=`/System/Tools/getconf SC_KERNEL_BITS 2>/System/Devices/null`
                     case "${sc_cpu_version}" in
                       523) HP_ARCH="hppa1.0" ;; # CPU_PA_RISC1_0
                       528) HP_ARCH="hppa1.1" ;; # CPU_PA_RISC1_1
@@ -634,7 +634,7 @@
                   exit (0);
               }
 EOF
-		    (CCOPTS= $CC_FOR_BUILD -o $dummy $dummy.c 2>/dev/null) && HP_ARCH=`$dummy`
+		    (CCOPTS= $CC_FOR_BUILD -o $dummy $dummy.c 2>/System/Devices/null) && HP_ARCH=`$dummy`
 		    if test -z "$HP_ARCH"; then HP_ARCH=hppa; fi
 		    rm -f $dummy.c $dummy && rmdir $tmpdir
 		fi ;;
@@ -692,7 +692,7 @@
 	echo hppa1.0-hp-osf
 	exit 0 ;;
     i*86:OSF1:*:*)
-	if [ -x /usr/sbin/sysversion ] ; then
+	if [ -x /System/AdminTools/sysversion ] ; then
 	    echo ${UNAME_MACHINE}-unknown-osf1mk
 	else
 	    echo ${UNAME_MACHINE}-unknown-osf1
@@ -769,7 +769,7 @@
 	LIBC=
 	#endif
 EOF
-	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^LIBC=`
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/System/Devices/null | grep ^LIBC=`
 	rm -f $dummy.c && rmdir $tmpdir
 	echo ${UNAME_MACHINE}-unknown-freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`${LIBC:+-$LIBC}
 	exit 0 ;;
@@ -834,7 +834,7 @@
 	#endif
 	#endif
 EOF
-	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^CPU=`
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/System/Devices/null | grep ^CPU=`
 	rm -f $dummy.c && rmdir $tmpdir
 	test x"${CPU}" != x && echo "${CPU}-unknown-linux-gnu" && exit 0
 	;;
@@ -854,7 +854,7 @@
 	#endif
 	#endif
 EOF
-	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^CPU=`
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/System/Devices/null | grep ^CPU=`
 	rm -f $dummy.c && rmdir $tmpdir
 	test x"${CPU}" != x && echo "${CPU}-unknown-linux-gnu" && exit 0
 	;;
@@ -865,7 +865,7 @@
 	echo powerpc64-unknown-linux-gnu
 	exit 0 ;;
     alpha:Linux:*:*)
-	case `sed -n '/^cpu model/s/^.*: \(.*\)/\1/p' < /proc/cpuinfo` in
+	case `sed -n '/^cpu model/s/^.*: \(.*\)/\1/p' < /System/Processes/cpuinfo` in
 	  EV5)   UNAME_MACHINE=alphaev5 ;;
 	  EV56)  UNAME_MACHINE=alphaev56 ;;
 	  PCA56) UNAME_MACHINE=alphapca56 ;;
@@ -874,13 +874,13 @@
 	  EV67)  UNAME_MACHINE=alphaev67 ;;
 	  EV68*) UNAME_MACHINE=alphaev68 ;;
         esac
-	objdump --private-headers /bin/sh | grep ld.so.1 >/dev/null
+	objdump --private-headers /System/Tools/sh | grep ld.so.1 >/System/Devices/null
 	if test "$?" = 0 ; then LIBC="libc1" ; else LIBC="" ; fi
 	echo ${UNAME_MACHINE}-unknown-linux-gnu${LIBC}
 	exit 0 ;;
     parisc:Linux:*:* | hppa:Linux:*:*)
 	# Look for CPU level
-	case `grep '^cpu[^a-z]*:' /proc/cpuinfo 2>/dev/null | cut -d' ' -f2` in
+	case `grep '^cpu[^a-z]*:' /System/Processes/cpuinfo 2>/System/Devices/null | cut -d' ' -f2` in
 	  PA7*) echo hppa1.1-unknown-linux-gnu ;;
 	  PA8*) echo hppa2.0-unknown-linux-gnu ;;
 	  *)    echo hppa-unknown-linux-gnu ;;
@@ -950,7 +950,7 @@
 	#endif
 	#endif
 EOF
-	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^LIBC=`
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/System/Devices/null | grep ^LIBC=`
 	rm -f $dummy.c && rmdir $tmpdir
 	test x"${LIBC}" != x && echo "${UNAME_MACHINE}-pc-linux-${LIBC}" && exit 0
 	test x"${TENTATIVE}" != x && echo "${TENTATIVE}" && exit 0
@@ -988,14 +988,14 @@
 	exit 0 ;;
     i*86:*:4.*:* | i*86:SYSTEM_V:4.*:*)
 	UNAME_REL=`echo ${UNAME_RELEASE} | sed 's/\/MP$//'`
-	if grep Novell /usr/include/link.h >/dev/null 2>/dev/null; then
+	if grep Novell /usr/include/link.h >/System/Devices/null 2>/System/Devices/null; then
 		echo ${UNAME_MACHINE}-univel-sysv${UNAME_REL}
 	else
 		echo ${UNAME_MACHINE}-pc-sysv${UNAME_REL}
 	fi
 	exit 0 ;;
     i*86:*:5:[78]*)
-	case `/bin/uname -X | grep "^Machine"` in
+	case `/System/Tools/uname -X | grep "^Machine"` in
 	    *486*)	     UNAME_MACHINE=i486 ;;
 	    *Pentium)	     UNAME_MACHINE=i586 ;;
 	    *Pent*|*Celeron) UNAME_MACHINE=i686 ;;
@@ -1006,14 +1006,14 @@
 	if test -f /usr/options/cb.name; then
 		UNAME_REL=`sed -n 's/.*Version //p' </usr/options/cb.name`
 		echo ${UNAME_MACHINE}-pc-isc$UNAME_REL
-	elif /bin/uname -X 2>/dev/null >/dev/null ; then
-		UNAME_REL=`(/bin/uname -X|grep Release|sed -e 's/.*= //')`
-		(/bin/uname -X|grep i80486 >/dev/null) && UNAME_MACHINE=i486
-		(/bin/uname -X|grep '^Machine.*Pentium' >/dev/null) \
+	elif /System/Tools/uname -X 2>/System/Devices/null >/System/Devices/null ; then
+		UNAME_REL=`(/System/Tools/uname -X|grep Release|sed -e 's/.*= //')`
+		(/System/Tools/uname -X|grep i80486 >/System/Devices/null) && UNAME_MACHINE=i486
+		(/System/Tools/uname -X|grep '^Machine.*Pentium' >/System/Devices/null) \
 			&& UNAME_MACHINE=i586
-		(/bin/uname -X|grep '^Machine.*Pent *II' >/dev/null) \
+		(/System/Tools/uname -X|grep '^Machine.*Pent *II' >/System/Devices/null) \
 			&& UNAME_MACHINE=i686
-		(/bin/uname -X|grep '^Machine.*Pentium Pro' >/dev/null) \
+		(/System/Tools/uname -X|grep '^Machine.*Pentium Pro' >/System/Devices/null) \
 			&& UNAME_MACHINE=i686
 		echo ${UNAME_MACHINE}-pc-sco$UNAME_REL
 	else
@@ -1033,7 +1033,7 @@
 	echo i860-intel-osf1
 	exit 0 ;;
     i860:*:4.*:*) # i860-SVR4
-	if grep Stardent /usr/include/sys/uadmin.h >/dev/null 2>&1 ; then
+	if grep Stardent /usr/include/System/SystemFS/uadmin.h >/System/Devices/null 2>&1 ; then
 	  echo i860-stardent-sysv${UNAME_RELEASE} # Stardent Vistra i860-SVR4
 	else # Add other i860-SVR4 vendors below as they are discovered.
 	  echo i860-unknown-sysv${UNAME_RELEASE}  # Unknown i860-SVR4
@@ -1053,14 +1053,14 @@
 	test -r /sysV68 && echo 'm68k-motorola-sysv' && exit 0 ;;
     3[34]??:*:4.0:3.0 | 3[34]??A:*:4.0:3.0 | 3[34]??,*:*:4.0:3.0 | 3[34]??/*:*:4.0:3.0 | 4400:*:4.0:3.0 | 4850:*:4.0:3.0 | SKA40:*:4.0:3.0 | SDS2:*:4.0:3.0)
 	OS_REL=''
-	test -r /etc/.relid \
-	&& OS_REL=.`sed -n 's/[^ ]* [^ ]* \([0-9][0-9]\).*/\1/p' < /etc/.relid`
-	/bin/uname -p 2>/dev/null | grep 86 >/dev/null \
+	test -r /System/Settings/.relid \
+	&& OS_REL=.`sed -n 's/[^ ]* [^ ]* \([0-9][0-9]\).*/\1/p' < /System/Settings/.relid`
+	/System/Tools/uname -p 2>/System/Devices/null | grep 86 >/System/Devices/null \
 	  && echo i486-ncr-sysv4.3${OS_REL} && exit 0
-	/bin/uname -p 2>/dev/null | /bin/grep entium >/dev/null \
+	/System/Tools/uname -p 2>/System/Devices/null | /System/Tools/grep entium >/System/Devices/null \
 	  && echo i586-ncr-sysv4.3${OS_REL} && exit 0 ;;
     3[34]??:*:4.0:* | 3[34]??,*:*:4.0:*)
-        /bin/uname -p 2>/dev/null | grep 86 >/dev/null \
+        /System/Tools/uname -p 2>/System/Devices/null | grep 86 >/System/Devices/null \
           && echo i486-ncr-sysv4 && exit 0 ;;
     m68*:LynxOS:2.*:* | m68*:LynxOS:3.0*:*)
 	echo m68k-unknown-lynxos${UNAME_RELEASE}
@@ -1087,8 +1087,8 @@
 	echo mips-sni-sysv4
 	exit 0 ;;
     *:SINIX-*:*:*)
-	if uname -p 2>/dev/null >/dev/null ; then
-		UNAME_MACHINE=`(uname -p) 2>/dev/null`
+	if uname -p 2>/System/Devices/null >/System/Devices/null ; then
+		UNAME_MACHINE=`(uname -p) 2>/System/Devices/null`
 		echo ${UNAME_MACHINE}-sni-sysv4
 	else
 		echo ns32k-sni-sysv
@@ -1246,7 +1246,7 @@
 #define __ARCHITECTURE__ "m68k"
 #endif
   int version;
-  version=`(hostinfo | sed -n 's/.*NeXT Mach \([0-9]*\).*/\1/p') 2>/dev/null`;
+  version=`(hostinfo | sed -n 's/.*NeXT Mach \([0-9]*\).*/\1/p') 2>/System/Devices/null`;
   if (version < 4)
     printf ("%s-next-nextstep%d\n", __ARCHITECTURE__, version);
   else
@@ -1323,7 +1323,7 @@
 }
 EOF
 
-$CC_FOR_BUILD -o $dummy $dummy.c 2>/dev/null && $dummy && rm -f $dummy.c $dummy && rmdir $tmpdir && exit 0
+$CC_FOR_BUILD -o $dummy $dummy.c 2>/System/Devices/null && $dummy && rm -f $dummy.c $dummy && rmdir $tmpdir && exit 0
 rm -f $dummy.c $dummy && rmdir $tmpdir
 
 # Apollos put the system type in the environment.
@@ -1372,20 +1372,20 @@
 
 config.guess timestamp = $timestamp
 
-uname -m = `(uname -m) 2>/dev/null || echo unknown`
-uname -r = `(uname -r) 2>/dev/null || echo unknown`
-uname -s = `(uname -s) 2>/dev/null || echo unknown`
-uname -v = `(uname -v) 2>/dev/null || echo unknown`
-
-/usr/bin/uname -p = `(/usr/bin/uname -p) 2>/dev/null`
-/bin/uname -X     = `(/bin/uname -X) 2>/dev/null`
-
-hostinfo               = `(hostinfo) 2>/dev/null`
-/bin/universe          = `(/bin/universe) 2>/dev/null`
-/usr/bin/arch -k       = `(/usr/bin/arch -k) 2>/dev/null`
-/bin/arch              = `(/bin/arch) 2>/dev/null`
-/usr/bin/oslevel       = `(/usr/bin/oslevel) 2>/dev/null`
-/usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/dev/null`
+uname -m = `(uname -m) 2>/System/Devices/null || echo unknown`
+uname -r = `(uname -r) 2>/System/Devices/null || echo unknown`
+uname -s = `(uname -s) 2>/System/Devices/null || echo unknown`
+uname -v = `(uname -v) 2>/System/Devices/null || echo unknown`
+
+/System/Tools/uname -p = `(/System/Tools/uname -p) 2>/System/Devices/null`
+/System/Tools/uname -X     = `(/System/Tools/uname -X) 2>/System/Devices/null`
+
+hostinfo               = `(hostinfo) 2>/System/Devices/null`
+/System/Tools/universe          = `(/System/Tools/universe) 2>/System/Devices/null`
+/System/Tools/arch -k       = `(/System/Tools/arch -k) 2>/System/Devices/null`
+/System/Tools/arch              = `(/System/Tools/arch) 2>/System/Devices/null`
+/System/Tools/oslevel       = `(/System/Tools/oslevel) 2>/System/Devices/null`
+/usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/System/Devices/null`
 
 UNAME_MACHINE = ${UNAME_MACHINE}
 UNAME_RELEASE = ${UNAME_RELEASE}
diff -urN bash-3.0/support/config.rpath bash-3.0-STEP/support/config.rpath
--- bash-3.0/support/config.rpath	2003-12-10 06:39:10.000000000 +1300
+++ bash-3.0-STEP/support/config.rpath	2005-08-25 00:34:12.050265464 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 # Output a system dependent set of variables, describing how to set the
 # run time search path of shared libraries in an executable.
 #
@@ -143,7 +143,7 @@
       ld_shlibs=no
       ;;
     beos*)
-      if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /System/Devices/null; then
         :
       else
         ld_shlibs=no
@@ -153,7 +153,7 @@
       # hardcode_libdir_flag_spec is actually meaningless, as there is
       # no search path for DLLs.
       hardcode_libdir_flag_spec='-L$libdir'
-      if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | grep 'auto-import' > /System/Devices/null; then
         :
       else
         ld_shlibs=no
@@ -162,9 +162,9 @@
     netbsd*)
       ;;
     solaris* | sysv5*)
-      if $LD -v 2>&1 | egrep 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | egrep 'BFD 2\.8' > /System/Devices/null; then
         ld_shlibs=no
-      elif $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | egrep ': supported targets:.* elf' > /System/Devices/null; then
         :
       else
         ld_shlibs=no
@@ -174,7 +174,7 @@
       hardcode_direct=yes
       ;;
     *)
-      if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /System/Devices/null; then
         :
       else
         ld_shlibs=no
@@ -223,7 +223,7 @@
         case $host_os in aix4.[012]|aix4.[012].*)
           collect2name=`${CC} -print-prog-name=collect2`
           if test -f "$collect2name" && \
-            strings "$collect2name" | grep resolve_lib_name >/dev/null
+            strings "$collect2name" | grep resolve_lib_name >/System/Devices/null
           then
             # We have reworked collect2
             hardcode_direct=yes
@@ -239,10 +239,10 @@
       # Begin _LT_AC_SYS_LIBPATH_AIX.
       echo 'int main () { return 0; }' > conftest.c
       ${CC} ${LDFLAGS} conftest.c -o conftest
-      aix_libpath=`dump -H conftest 2>/dev/null | sed -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+      aix_libpath=`dump -H conftest 2>/System/Devices/null | sed -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
 }'`
       if test -z "$aix_libpath"; then
-        aix_libpath=`dump -HX64 conftest 2>/dev/null | sed -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+        aix_libpath=`dump -HX64 conftest 2>/System/Devices/null | sed -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
 }'`
       fi
       if test -z "$aix_libpath"; then
@@ -277,7 +277,7 @@
       libext=lib
       ;;
     darwin* | rhapsody*)
-      if $CC -v 2>&1 | grep 'Apple' >/dev/null ; then
+      if $CC -v 2>&1 | grep 'Apple' >/System/Devices/null ; then
         hardcode_direct=no
       fi
       ;;
diff -urN bash-3.0/support/config.sub bash-3.0-STEP/support/config.sub
--- bash-3.0/support/config.sub	2003-09-11 01:16:12.000000000 +1200
+++ bash-3.0-STEP/support/config.sub	2005-08-25 00:33:17.396574088 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 # Configuration validation subroutine script.
 #   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
 #   2000, 2001, 2002 Free Software Foundation, Inc.
diff -urN bash-3.0/support/fixlinks bash-3.0-STEP/support/fixlinks
--- bash-3.0/support/fixlinks	2002-04-18 05:23:15.000000000 +1200
+++ bash-3.0-STEP/support/fixlinks	2005-08-25 00:47:18.447714880 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 #
 # fixlinks - make symlinks in the bash source tree so that there is
 #	     exactly one version of any given source file.
@@ -50,9 +50,9 @@
 fi
 
 rm_ltmp=false
-LINKTEMP=`mktemp -t linktmp.XXXXXXXX 2>/dev/null`
+LINKTEMP=`mktemp -t linktmp.XXXXXXXX 2>/System/Devices/null`
 if [ -z "$LINKTEMP" ]; then
-	: ${TMPDIR:=/tmp}
+	: ${TMPDIR:=/System/TemporaryFiles}
 	LINKTEMP=${TMPDIR}/linktmp.$$
 	rm_ltmp=true
 fi
@@ -62,7 +62,7 @@
 # symlinks if they're present
 if [ -n "$hardlinks" ]; then
 	LN=ln
-elif (ln -s /dev/null ${LINKTEMP}) >/dev/null 2>&1; then
+elif (ln -s /System/Devices/null ${LINKTEMP}) >/System/Devices/null 2>&1; then
 	LN="ln -s"
 else
 	LN=ln
diff -urN bash-3.0/support/install.sh bash-3.0-STEP/support/install.sh
--- bash-3.0/support/install.sh	2002-04-17 08:49:24.000000000 +1200
+++ bash-3.0-STEP/support/install.sh	2005-08-25 00:33:17.461564208 +1200
@@ -1,4 +1,4 @@
-#!/bin/sh
+#!/System/Tools/sh
 #
 # install - install a program, script, or datafile
 # This comes from X11R5.
@@ -92,7 +92,7 @@
 	    then
 		src=$1
 	    else
-		# this colon is to work around a 386BSD /bin/sh bug
+		# this colon is to work around a 386BSD /System/Tools/sh bug
 		:
 		dst=$1
 	    fi
diff -urN bash-3.0/support/man2html.c bash-3.0-STEP/support/man2html.c
--- bash-3.0/support/man2html.c	2002-04-05 08:33:11.000000000 +1200
+++ bash-3.0-STEP/support/man2html.c	2005-08-25 00:47:18.444715336 +1200
@@ -35,7 +35,7 @@
  * might point to incorrect places.
  *
  * The program will not allow users to get system specific files, such as
- * /etc/passwd. It will check that "man" is part of the specified file and
+ * /System/Settings/passwd. It will check that "man" is part of the specified file and
  * that  "/../" isn't. Even if someone manages to get such file, man2html will
  * handle it like a manpage and will usually not produce any output (or crash).
  *
@@ -275,7 +275,7 @@
 static char NEWLINE[2] = "\n";
 static char idxlabel[6] = "ixAAA";
 
-#define INDEXFILE "/tmp/manindex.list"
+#define INDEXFILE "/System/TemporaryFiles/manindex.list"
 
 static char *fname;
 static FILE *idxfile;
diff -urN bash-3.0/support/missing bash-3.0-STEP/support/missing
--- bash-3.0/support/missing	1998-12-17 04:47:23.000000000 +1300
+++ bash-3.0-STEP/support/missing	2005-08-25 00:33:17.407572416 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 # Common stub for a few missing GNU programs while installing.
 # Copyright (C) 1996, 1997 Free Software Foundation, Inc.
 # Franc,ois Pinard <pinard@iro.umontreal.ca>, 1996.
diff -urN bash-3.0/support/mkclone bash-3.0-STEP/support/mkclone
--- bash-3.0/support/mkclone	2002-04-18 05:23:54.000000000 +1200
+++ bash-3.0-STEP/support/mkclone	2005-08-25 00:47:18.415719744 +1200
@@ -1,4 +1,4 @@
-#! /bin/bash
+#! /System/Tools/bash
 #
 # mkclone - symlink every file appearing in $src/MANIFEST to a corresponding
 #	    file in the target directory ($1).  Directories specified in
@@ -56,9 +56,9 @@
 fi
 
 rm_ltmp=false
-LINKTEMP=`mktemp -t linktmp.XXXXXXXX 2>/dev/null`
+LINKTEMP=`mktemp -t linktmp.XXXXXXXX 2>/System/Devices/null`
 if [ -z "$LINKTEMP" ]; then
-	: ${TMPDIR:=/tmp}
+	: ${TMPDIR:=/System/TemporaryFiles}
 	LINKTEMP=${TMPDIR}/linktmp.$$
 	rm_ltmp=true
 fi
@@ -68,7 +68,7 @@
 # symlinks if they're present
 if [ -n "$hardlinks" ]; then
 	LN=ln
-elif (ln -s /dev/null ${LINKTEMP}) >/dev/null 2>&1; then
+elif (ln -s /System/Devices/null ${LINKTEMP}) >/System/Devices/null 2>&1; then
 	LN="ln -s"
 else
 	LN=ln
diff -urN bash-3.0/support/mkconffiles bash-3.0-STEP/support/mkconffiles
--- bash-3.0/support/mkconffiles	2002-04-18 05:24:16.000000000 +1200
+++ bash-3.0-STEP/support/mkconffiles	2005-08-25 00:33:17.413571504 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 #
 # mkconffiles - create _distribution and _patchlevel files in preparation
 #		for recreating `configure' from `configure.in'
diff -urN bash-3.0/support/mkdirs bash-3.0-STEP/support/mkdirs
--- bash-3.0/support/mkdirs	2002-04-18 05:24:30.000000000 +1200
+++ bash-3.0-STEP/support/mkdirs	2005-08-25 00:33:17.415571200 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 #
 # mkdirs - a work-alike for `mkdir -p'
 #
diff -urN bash-3.0/support/mkinstalldirs bash-3.0-STEP/support/mkinstalldirs
--- bash-3.0/support/mkinstalldirs	2003-12-10 06:39:10.000000000 +1300
+++ bash-3.0-STEP/support/mkinstalldirs	2005-08-25 00:34:12.062263640 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 # mkinstalldirs --- make directory hierarchy
 # Author: Noah Friedman <friedman@prep.ai.mit.edu>
 # Created: 1993-05-16
@@ -52,13 +52,13 @@
 
 case $dirmode in
   '')
-    if mkdir -p -- . 2>/dev/null; then
+    if mkdir -p -- . 2>/System/Devices/null; then
       echo "mkdir -p -- $*"
       exec mkdir -p -- "$@"
     fi
     ;;
   *)
-    if mkdir -m "$dirmode" -p -- . 2>/dev/null; then
+    if mkdir -m "$dirmode" -p -- . 2>/System/Devices/null; then
       echo "mkdir -m $dirmode -p -- $*"
       exec mkdir -m "$dirmode" -p -- "$@"
     fi
diff -urN bash-3.0/support/mksignames.c bash-3.0-STEP/support/mksignames.c
--- bash-3.0/support/mksignames.c	2003-03-25 10:11:38.000000000 +1200
+++ bash-3.0-STEP/support/mksignames.c	2005-08-25 00:33:17.426569528 +1200
@@ -89,7 +89,7 @@
   /* The generated signal names are SIGRTMIN, SIGRTMIN+1, ...,
      SIGRTMIN+x, SIGRTMAX-x, ..., SIGRTMAX-1, SIGRTMAX. If the number
      of RT signals is odd, there is an extra SIGRTMIN+(x+1).
-     These names are the ones used by ksh and /usr/xpg4/bin/sh on SunOS5. */
+     These names are the ones used by ksh and /usr/xpg4/System/Tools/sh on SunOS5. */
 
 #if defined (SIGRTMIN)
   rtmin = SIGRTMIN;
diff -urN bash-3.0/support/mkversion.sh bash-3.0-STEP/support/mkversion.sh
--- bash-3.0/support/mkversion.sh	2003-04-26 08:43:55.000000000 +1200
+++ bash-3.0-STEP/support/mkversion.sh	2005-08-25 00:33:17.422570136 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 
 # Simple program to make new version numbers for the shell.
 # Big deal, but it was getting out of hand to do everything
diff -urN bash-3.0/support/printenv.sh bash-3.0-STEP/support/printenv.sh
--- bash-3.0/support/printenv.sh	2002-04-18 05:25:40.000000000 +1200
+++ bash-3.0-STEP/support/printenv.sh	2005-08-25 00:33:17.403573024 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh -
+#! /System/Tools/sh -
 
 # Copyright (C) 1996-2002 Free Software Foundation, Inc.
 #
diff -urN bash-3.0/support/rlvers.sh bash-3.0-STEP/support/rlvers.sh
--- bash-3.0/support/rlvers.sh	2002-04-18 05:27:27.000000000 +1200
+++ bash-3.0-STEP/support/rlvers.sh	2005-08-25 00:47:18.545699984 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 #
 # rlvers.sh -- run a program that prints out the readline version number
 #	       using locally-installed readline libraries
@@ -22,7 +22,7 @@
 
 PROGNAME=`basename $0`
 
-: ${TMPDIR:=/tmp}
+: ${TMPDIR:=/System/TemporaryFiles}
 TDIR=$TMPDIR/rlvers
 
 # defaults
@@ -51,7 +51,7 @@
 	if [ -n "$verbose" ]; then
 		echo "${PROGNAME}: using installed rlversion from ${RL_LIBDIR}/rlversion"
 	fi
-	v=`${RL_LIBDIR}/rlversion 2>/dev/null`
+	v=`${RL_LIBDIR}/rlversion 2>/System/Devices/null`
 	case "$v" in
 	unknown | "")	echo 0 ;;
 	*)		echo "$v" ;;
diff -urN bash-3.0/support/shobj-conf bash-3.0-STEP/support/shobj-conf
--- bash-3.0/support/shobj-conf	2003-11-14 03:36:19.000000000 +1300
+++ bash-3.0-STEP/support/shobj-conf	2005-08-25 00:33:17.486560408 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 #
 # shobj-conf -- output a series of variable assignments to be substituted
 #		into a Makefile by configure which specify system-dependent
@@ -61,7 +61,7 @@
 case "${host_os}-${SHOBJ_CC}" in
 sunos4*-*gcc*)
 	SHOBJ_CFLAGS=-fpic
-	SHOBJ_LD=/usr/bin/ld
+	SHOBJ_LD=/System/Tools/ld
 	SHOBJ_LDFLAGS='-assert pure-text'
 
 	SHLIB_LIBVERSION='$(SHLIB_LIBSUFF).$(SHLIB_MAJOR)$(SHLIB_MINOR)'
@@ -69,7 +69,7 @@
 
 sunos4*)
 	SHOBJ_CFLAGS=-pic
-	SHOBJ_LD=/usr/bin/ld
+	SHOBJ_LD=/System/Tools/ld
 	SHOBJ_LDFLAGS='-assert pure-text'
 
 	SHLIB_LIBVERSION='$(SHLIB_LIBSUFF).$(SHLIB_MAJOR)$(SHLIB_MINOR)'
@@ -78,7 +78,7 @@
 sunos5*-*gcc*|solaris2*-*gcc*)
 	SHOBJ_CFLAGS=-fpic
 	SHOBJ_LD='${CC}'
-	# This line works for the Solaris linker in /usr/ccs/bin/ld
+	# This line works for the Solaris linker in /usr/ccs/System/Tools/ld
 	SHOBJ_LDFLAGS='-shared -Wl,-i -Wl,-h,$@'
 	# This line works for the GNU ld
 #	SHOBJ_LDFLAGS='-shared -Wl,-h,$@'
@@ -89,7 +89,7 @@
 
 sunos5*|solaris2*)
 	SHOBJ_CFLAGS='-K pic'
-	SHOBJ_LD=/usr/ccs/bin/ld
+	SHOBJ_LD=/usr/ccs/System/Tools/ld
 	SHOBJ_LDFLAGS='-G -dy -z text -i -h $@'
 
 #	SHLIB_XLDFLAGS='-R $(libdir)'
@@ -120,7 +120,7 @@
 	SHOBJ_CFLAGS=-fpic
 	SHOBJ_LD='${CC}'
 
-	if [ -x /usr/bin/objformat ] && [ "`/usr/bin/objformat`" = "elf" ]; then
+	if [ -x /System/Tools/objformat ] && [ "`/System/Tools/objformat`" = "elf" ]; then
 		SHOBJ_LDFLAGS='-shared -Wl,-soname,$@'
 
 		SHLIB_XLDFLAGS='-Wl,-rpath,$(libdir)'
@@ -147,10 +147,10 @@
 
 	case "${host_os}" in
 	darwin7*)	SHOBJ_LDFLAGS=''
-			SHLIB_XLDFLAGS='-dynamiclib -arch_only `/usr/bin/arch` -install_name $(libdir)/$@ -current_version $(SHLIB_MAJOR)$(SHLIB_MINOR) -compatibility_version $(SHLIB_MAJOR) -v'
+			SHLIB_XLDFLAGS='-dynamiclib -arch_only `/System/Tools/arch` -install_name $(libdir)/$@ -current_version $(SHLIB_MAJOR)$(SHLIB_MINOR) -compatibility_version $(SHLIB_MAJOR) -v'
 			;;
 	*)		SHOBJ_LDFLAGS='-dynamic'
-			SHLIB_XLDFLAGS='-arch_only `/usr/bin/arch` -install_name $(libdir)/$@ -current_version $(SHLIB_MAJOR)$(SHLIB_MINOR) -compatibility_version $(SHLIB_MAJOR) -v'
+			SHLIB_XLDFLAGS='-arch_only `/System/Tools/arch` -install_name $(libdir)/$@ -current_version $(SHLIB_MAJOR)$(SHLIB_MINOR) -compatibility_version $(SHLIB_MAJOR) -v'
 			;;
 	esac
 
diff -urN bash-3.0/support/texi2dvi bash-3.0-STEP/support/texi2dvi
--- bash-3.0/support/texi2dvi	2003-02-19 05:11:26.000000000 +1300
+++ bash-3.0-STEP/support/texi2dvi	2005-08-25 00:47:18.453713968 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 # texi2dvi --- produce DVI (or PDF) files from Texinfo (or LaTeX) sources.
 # $Id: texi2dvi,v 1.14 2003/02/05 00:42:33 karl Exp $
 #
@@ -90,7 +90,7 @@
 quiet=          # by default let the tools' message be displayed
 set_language=
 textra=
-tmpdir=${TMPDIR:-/tmp}/t2d$$  # avoid collisions on 8.3 filesystems.
+tmpdir=${TMPDIR:-/System/TemporaryFiles}/t2d$$  # avoid collisions on 8.3 filesystems.
 txincludes=     # TEXINPUTS extensions, with trailing colon
 txiprereq=19990129 # minimum texinfo.tex version to have macro expansion
 verbose=false   # echo for verbose mode
@@ -263,7 +263,7 @@
 # files as argument.  The index files must be reported last.
 get_xref_files=$utildir/get_xref.sh
 cat <<\EOF >$get_xref_files
-#! /bin/sh
+#! /System/Tools/sh
 
 # Get list of xref files (indexes, tables and lists).
 # Find all files having root filename with a two-letter extension,
@@ -289,13 +289,13 @@
 # 0 standard input
 # 1 standard output (--verbose messages)
 # 2 standard error
-# 3 some systems may open it to /dev/tty
+# 3 some systems may open it to /System/Devices/tty
 # 4 used on the Kubota Titan
 # 5 tools output (turned off by --quiet)
 
 # Tools' output.  If quiet, discard, else redirect to the message flow.
 if test "$quiet" = t; then
-  exec 5>/dev/null
+  exec 5>/System/Devices/null
 else
   exec 5>&1
 fi
@@ -311,7 +311,7 @@
 
   # If the COMMAND_LINE_FILENAME is not absolute (e.g., --debug.tex),
   # prepend `./' in order to avoid that the tools take it as an option.
-  echo "$command_line_filename" | $EGREP '^(/|[A-z]:/)' >/dev/null \
+  echo "$command_line_filename" | $EGREP '^(/|[A-z]:/)' >/System/Devices/null \
   || command_line_filename="./$command_line_filename"
 
   # See if the file exists.  If it doesn't we're in trouble since, even
@@ -327,7 +327,7 @@
   # because in clean mode we are in tmp, in which case a relative
   # path has no meaning.
   filename_dir=`echo $command_line_filename | sed 's!/[^/]*$!!;s!^$!.!'`
-  filename_dir=`cd "$filename_dir" >/dev/null && pwd`
+  filename_dir=`cd "$filename_dir" >/System/Devices/null && pwd`
 
   # Strip directory part but leave extension.
   filename_ext=`basename "$command_line_filename"`
@@ -412,7 +412,7 @@
   # Otherwise, guess from the file extension.
   if test -n "$set_language"; then
     language=$set_language
-  elif sed 1q "$command_line_filename" | grep 'input texinfo' >/dev/null; then
+  elif sed 1q "$command_line_filename" | grep 'input texinfo' >/System/Devices/null; then
     language=texinfo
   else
     language=
@@ -456,11 +456,11 @@
         txiversion_tex=txiversion.tex
         echo '\input texinfo.tex @bye' >$tmpdir/$txiversion_tex
         # Run in the tmpdir to avoid leaving files.
-        eval `cd $tmpdir >/dev/null &&
-              $tex $txiversion_tex 2>/dev/null |
+        eval `cd $tmpdir >/System/Devices/null &&
+              $tex $txiversion_tex 2>/System/Devices/null |
               sed -n 's/^.*\[\(.*\)version \(....\)-\(..\)-\(..\).*$/txiformat=\1 txiversion="\2\3\4"/p'`
         $verbose "texinfo.tex preloaded as \`$txiformat', version is \`$txiversion' ..."
-        if test "$txiprereq" -le "$txiversion" >/dev/null 2>&1; then
+        if test "$txiprereq" -le "$txiversion" >/System/Devices/null 2>&1; then
           makeinfo=
         else
           makeinfo=${MAKEINFO:-makeinfo}
@@ -481,7 +481,7 @@
     $verbose "Macro-expanding $command_line_filename to $filename_src ..."
     sed -f $comment_iftex_sed "$command_line_filename" \
       | $makeinfo --footnote-style=end -I "$filename_dir" $miincludes \
-        -o /dev/null --macro-expand=- \
+        -o /System/Devices/null --macro-expand=- \
       | sed -f $uncomment_iftex_sed >"$filename_src"
     filename_input=$filename_src
   fi
@@ -539,7 +539,7 @@
            && grep '^\\bibstyle[{]' "$filename_noext.aux" \
            && (grep 'Warning:.*Citation.*undefined' "$filename_noext.log" \
                || grep 'No file .*\.bbl\.' "$filename_noext.log")) \
-          >/dev/null 2>&1; \
+          >/System/Devices/null 2>&1; \
     then
       $verbose "Running $bibtex $filename_noext ..."
       if $bibtex "$filename_noext" >&5; then :; else
@@ -595,7 +595,7 @@
     # subdirs, since texi2dvi does not try to compare xref files in
     # subdirs.  Performing xref files test is still good since LaTeX
     # does not report changes in xref files.
-    if grep "Rerun to get" "$filename_noext.log" >/dev/null 2>&1; then
+    if grep "Rerun to get" "$filename_noext.log" >/System/Devices/null 2>&1; then
       finished=
     fi
 
diff -urN bash-3.0/support/texi2html bash-3.0-STEP/support/texi2html
--- bash-3.0/support/texi2html	2001-10-06 06:30:15.000000000 +1200
+++ bash-3.0-STEP/support/texi2html	2005-08-25 00:47:18.541700592 +1200
@@ -1,4 +1,4 @@
-#! /usr/bin/perl
+#! /System/Tools/perl
 'di ';
 'ig 00 ';
 #+##############################################################################
@@ -2213,7 +2213,7 @@
 # read initialzation from $sysconfdir/texi2htmlrc or $HOME/.texi2htmlrc
 my $home = $ENV{HOME};
 defined($home) or $home = '';
-foreach $i ('/usr/local/etc/texi2htmlrc', "$home/.texi2htmlrc") {
+foreach $i ('/usr/local/System/Settings/texi2htmlrc', "$home/.texi2htmlrc") {
     if (-f $i) {
 	print "# reading initialization file from $i\n" 
 	    if ($T2H_VERBOSE);
@@ -2630,7 +2630,7 @@
   {
     if ($T2H_L2H_TMP =~ /\./)
     {
-      warn "$ERROR Warning l2h: l2h_tmp dir contains a dot. Use /tmp, instead\n";
+      warn "$ERROR Warning l2h: l2h_tmp dir contains a dot. Use /System/TemporaryFiles, instead\n";
       $dotbug = 1;
     }
   }
@@ -2638,12 +2638,12 @@
   {
     if (&getcwd =~ /\./)
     {
-     warn "$ERROR Warning l2h: current dir contains a dot. Use /tmp as l2h_tmp dir \n";
+     warn "$ERROR Warning l2h: current dir contains a dot. Use /System/TemporaryFiles as l2h_tmp dir \n";
      $dotbug = 1;
    }
   }
   # fix it, if necessary and hope that it works 
-  $T2H_L2H_TMP = "/tmp" if ($dotbug);
+  $T2H_L2H_TMP = "/System/TemporaryFiles" if ($dotbug);
     
   $call = $T2H_L2H_L2H;
   # use init file, if specified
diff -urN bash-3.0/test.c bash-3.0-STEP/test.c
--- bash-3.0/test.c	2003-12-20 10:27:28.000000000 +1300
+++ bash-3.0-STEP/test.c	2005-08-25 00:34:12.173246768 +1200
@@ -164,7 +164,7 @@
 }
 
 /* A wrapper for stat () which disallows pathnames that are empty strings
-   and handles /dev/fd emulation on systems that don't have it. */
+   and handles /System/Devices/fd emulation on systems that don't have it. */
 static int
 test_stat (path, finfo)
      char *path;
@@ -175,7 +175,7 @@
       errno = ENOENT;
       return (-1);
     }
-  if (path[0] == '/' && path[1] == 'd' && strncmp (path, "/dev/fd/", 8) == 0)
+  if (path[0] == '/' && path[1] == 'd' && strncmp (path, "/System/Devices/fd/", 8) == 0)
     {
 #if !defined (HAVE_DEV_FD)
       intmax_t fd;
@@ -191,7 +191,7 @@
       return (-1);
 #else
   /* If HAVE_DEV_FD is defined, DEV_FD_PREFIX is defined also, and has a
-     trailing slash.  Make sure /dev/fd/xx really uses DEV_FD_PREFIX/xx.
+     trailing slash.  Make sure /System/Devices/fd/xx really uses DEV_FD_PREFIX/xx.
      On most systems, with the notable exception of linux, this is
      effectively a no-op. */
       char pbuf[32];
@@ -201,7 +201,7 @@
 #endif /* !HAVE_DEV_FD */
     }
 #if !defined (HAVE_DEV_STDIN)
-  else if (STREQN (path, "/dev/std", 8))
+  else if (STREQN (path, "/System/Devices/std", 8))
     {
       if (STREQ (path+8, "in"))
 	return (fstat (0, finfo));
diff -urN bash-3.0/tests/alias.tests bash-3.0-STEP/tests/alias.tests
--- bash-3.0/tests/alias.tests	2003-02-01 15:22:57.000000000 +1300
+++ bash-3.0-STEP/tests/alias.tests	2005-08-25 00:34:12.184245096 +1200
@@ -15,7 +15,7 @@
 
 # bug in all versions through bash-2.05b
 
-unalias qfoo qbar qbaz quux 2>/dev/null
+unalias qfoo qbar qbaz quux 2>/System/Devices/null
 
 alias qfoo=qbar
 alias qbar=qbaz
diff -urN bash-3.0/tests/array.right bash-3.0-STEP/tests/array.right
--- bash-3.0/tests/array.right	2003-10-05 16:25:10.000000000 +1300
+++ bash-3.0-STEP/tests/array.right	2005-08-25 00:47:07.525375328 +1200
@@ -41,7 +41,7 @@
 declare -a DIRSTACK='()'
 declare -a FUNCNAME='([0]="main")'
 declare -ar a='([1]="" [2]="bdef" [5]="hello world" [6]="test expression")'
-declare -a b='([0]="this" [1]="is" [2]="a" [3]="test" [4]="" [5]="/etc/passwd")'
+declare -a b='([0]="this" [1]="is" [2]="a" [3]="test" [4]="" [5]="/System/Settings/passwd")'
 declare -ar c='()'
 declare -a d='([1]="" [2]="bdef" [5]="hello world" [6]="test" [9]="ninth element")'
 declare -a e='([0]="test")'
@@ -64,7 +64,7 @@
 declare -a DIRSTACK='()'
 declare -a FUNCNAME='([0]="main")'
 declare -ar a='([1]="" [2]="bdef" [5]="hello world" [6]="test expression")'
-declare -a b='([0]="this" [1]="is" [2]="a" [3]="test" [4]="" [5]="/etc/passwd")'
+declare -a b='([0]="this" [1]="is" [2]="a" [3]="test" [4]="" [5]="/System/Settings/passwd")'
 declare -ar c='()'
 declare -a d='([1]="test test")'
 declare -a f='([0]="" [1]="bdef" [2]="hello world" [3]="test" [4]="ninth element")'
@@ -81,7 +81,7 @@
 declare -a DIRSTACK='()'
 declare -a FUNCNAME='([0]="main")'
 declare -ar a='([1]="" [2]="bdef" [5]="hello world" [6]="test expression")'
-declare -a b='([0]="this" [1]="is" [2]="a" [3]="test" [4]="" [5]="/etc/passwd")'
+declare -a b='([0]="this" [1]="is" [2]="a" [3]="test" [4]="" [5]="/System/Settings/passwd")'
 declare -ar c='()'
 declare -a d='([1]="test test")'
 declare -a f='([0]="" [1]="bdef" [2]="hello world" [3]="test" [4]="ninth element")'
@@ -104,7 +104,7 @@
 d
 e f g
 h
-/bin /usr/bin /usr/ucb /usr/local/bin . /sbin /usr/sbin
+/bin /System/Tools /usr/ucb /usr/local/bin . /sbin /System/AdminTools
 bin bin ucb bin . sbin sbin
 bin
 / / / / / /
diff -urN bash-3.0/tests/array.tests bash-3.0-STEP/tests/array.tests
--- bash-3.0/tests/array.tests	2003-10-05 16:25:00.000000000 +1300
+++ bash-3.0-STEP/tests/array.tests	2005-08-25 00:47:18.548699528 +1200
@@ -34,7 +34,7 @@
 
 a[1]=
 
-_ENV=/bin/true
+_ENV=/System/Tools/true
 x=${_ENV[(_$-=0)+(_=1)-_${-%%*i*}]}
 
 declare -r c[100]
@@ -87,7 +87,7 @@
 declare -a e[10]=test	# this works in post-bash-2.05 versions
 declare -a e[10]='(test)'
 
-pass=/etc/passwd
+pass=/System/Settings/passwd
 declare -a f='("${d[@]}")'
 b=([0]=this [1]=is [2]=a [3]=test [4]="$PS1" [5]=$pass)
 
@@ -167,7 +167,7 @@
 done
 
 # do various pattern removal and length tests
-XPATH=/bin:/usr/bin:/usr/ucb:/usr/local/bin:.:/sbin:/usr/sbin
+XPATH=/bin:/System/Tools:/usr/ucb:/usr/local/bin:.:/sbin:/System/AdminTools
 
 xpath=( $( IFS=: ; echo $XPATH ) )
 
@@ -238,7 +238,7 @@
 
 # some old bugs and ksh93 compatibility tests
 set +u
-cd /tmp
+cd /System/TemporaryFiles
 
 touch 1=bar
 foo=([10]="bar")
diff -urN bash-3.0/tests/builtins.right bash-3.0-STEP/tests/builtins.right
--- bash-3.0/tests/builtins.right	2003-01-15 05:09:56.000000000 +1300
+++ bash-3.0-STEP/tests/builtins.right	2005-08-25 00:47:18.583694208 +1200
@@ -100,12 +100,12 @@
 m n o p
 a b c
 m n o p
-/tmp/bash-dir-a
-/tmp/bash-dir-a
-/tmp/bash-dir-a
-./source5.sub: line 10: /tmp/source-notthere: No such file or directory
+/System/TemporaryFiles/bash-dir-a
+/System/TemporaryFiles/bash-dir-a
+/System/TemporaryFiles/bash-dir-a
+./source5.sub: line 10: /System/TemporaryFiles/source-notthere: No such file or directory
 after bad source 1
-./source5.sub: line 17: /tmp/source-notthere: No such file or directory
+./source5.sub: line 17: /System/TemporaryFiles/source-notthere: No such file or directory
 AVAR
 foo
 foo
diff -urN bash-3.0/tests/builtins.tests bash-3.0-STEP/tests/builtins.tests
--- bash-3.0/tests/builtins.tests	2003-01-15 05:09:26.000000000 +1300
+++ bash-3.0-STEP/tests/builtins.tests	2005-08-25 00:47:18.567696640 +1200
@@ -2,7 +2,7 @@
 set +p
 set +o posix
 
-ulimit -c 0 2>/dev/null
+ulimit -c 0 2>/System/Devices/null
 
 # check that break breaks loops
 for i in a b c; do echo $i; break; echo bad-$i; done
@@ -77,7 +77,7 @@
 umask 022
 umask
 umask -S
-umask -S u=rwx,g=rwx,o=rx >/dev/null # 002
+umask -S u=rwx,g=rwx,o=rx >/System/Devices/null # 002
 umask
 umask -S
 umask -p
@@ -110,7 +110,7 @@
 # test options to exec
 (exec -a specialname ${THIS_SH} -c 'echo $0' )
 (exec -l -a specialname ${THIS_SH} -c 'echo $0' )
-# test `clean' environment.  if /bin/sh is bash, and the script version of
+# test `clean' environment.  if /System/Tools/sh is bash, and the script version of
 # printenv is run, there will be variables in the environment that bash
 # sets on startup.  Also test code that prefixes argv[0] with a dash.
 (export FOO=BAR ; exec -c -l printenv ) | grep FOO
@@ -130,11 +130,11 @@
 # check out source/.
 
 # sourcing a zero-length-file had better not be an error
-rm -f /tmp/zero-length-file
-cp /dev/null /tmp/zero-length-file
-. /tmp/zero-length-file
+rm -f /System/TemporaryFiles/zero-length-file
+cp /System/Devices/null /System/TemporaryFiles/zero-length-file
+. /System/TemporaryFiles/zero-length-file
 echo $?
-rm /tmp/zero-length-file
+rm /System/TemporaryFiles/zero-length-file
 
 AVAR=AVAR
 
diff -urN bash-3.0/tests/builtins1.sub bash-3.0-STEP/tests/builtins1.sub
--- bash-3.0/tests/builtins1.sub	1997-02-28 05:57:43.000000000 +1300
+++ bash-3.0-STEP/tests/builtins1.sub	2005-08-25 00:47:18.588693448 +1200
@@ -1,11 +1,11 @@
 unset CDPATH
 
 MYDIR=$(pwd -P)
-FULLDIR=/tmp/bash-dir-a
+FULLDIR=/System/TemporaryFiles/bash-dir-a
 DIR=${FULLDIR##*/}
 
 mkdir $FULLDIR
-CDPATH=.:/tmp
+CDPATH=.:/System/TemporaryFiles
 cd $DIR
 pwd
 echo $PWD
diff -urN bash-3.0/tests/cprint.right bash-3.0-STEP/tests/cprint.right
--- bash-3.0/tests/cprint.right	2002-08-09 00:59:15.000000000 +1200
+++ bash-3.0-STEP/tests/cprint.right	2005-08-25 00:34:12.274231416 +1200
@@ -1,37 +1,37 @@
 tf is a function
 tf () 
 { 
-    echo this is ${0##*/} >/dev/null;
-    echo a | cat - >/dev/null;
+    echo this is ${0##*/} >/System/Devices/null;
+    echo a | cat - >/System/Devices/null;
     test -f ${0##*/} && echo ${0##*/} is a regular file;
     test -d ${0##*/} || echo ${0##*/} is not a directory;
     echo a;
     echo b;
     echo c;
-    echo background >/dev/null & ( exit 1 );
+    echo background >/System/Devices/null & ( exit 1 );
     echo $?;
     { 
         echo a
     };
     i=0;
     while (( i < 3 )); do
-        test -r /dev/fd/$i;
+        test -r /System/Devices/fd/$i;
         i=$(( i + 1 ));
     done;
-    [[ -r /dev/fd/0 && -w /dev/fd/1 ]] || echo oops >/dev/null;
+    [[ -r /System/Devices/fd/0 && -w /System/Devices/fd/1 ]] || echo oops >/System/Devices/null;
     for name in $( echo 1 2 3 );
     do
-        test -r /dev/fd/$name;
+        test -r /System/Devices/fd/$name;
     done;
-    if [[ -r /dev/fd/0 && -w /dev/fd/1 ]]; then
-        echo ok >/dev/null;
+    if [[ -r /System/Devices/fd/0 && -w /System/Devices/fd/1 ]]; then
+        echo ok >/System/Devices/null;
     else
         if (( 7 > 40 )); then
             echo oops;
         else
             echo done;
         fi;
-    fi >/dev/null;
+    fi >/System/Devices/null;
     case $PATH in 
         *$PWD*)
             echo \$PWD in \$PATH
@@ -39,13 +39,13 @@
         *)
             echo \$PWD not in \$PATH
         ;;
-    esac >/dev/null;
+    esac >/System/Devices/null;
     while false; do
         echo z;
-    done >/dev/null;
+    done >/System/Devices/null;
     until true; do
         echo z;
-    done >/dev/null;
+    done >/System/Devices/null;
     echo \&\|'()' \{ echo abcde \; \};
     eval fu\%nc'()' \{ echo abcde \; \};
     type fu\%nc
@@ -54,7 +54,7 @@
 tf2 () 
 { 
     ( { 
-        time -p echo a | cat - >/dev/null
+        time -p echo a | cat - >/System/Devices/null
     } ) 2>&1
 }
 cprint.tests is a regular file
diff -urN bash-3.0/tests/cprint.tests bash-3.0-STEP/tests/cprint.tests
--- bash-3.0/tests/cprint.tests	1999-02-19 05:23:01.000000000 +1300
+++ bash-3.0-STEP/tests/cprint.tests	2005-08-25 00:34:12.233237648 +1200
@@ -4,17 +4,17 @@
 tf()
 {
 	# simple command with redir
-	echo this is ${0##*/} > /dev/null
+	echo this is ${0##*/} > /System/Devices/null
 
 	# pipeline
-	echo a | cat - > /dev/null
+	echo a | cat - > /System/Devices/null
 
 	test -f ${0##*/} && echo ${0##*/} is a regular file
 	test -d ${0##*/} || echo ${0##*/} is not a directory
 
 	echo a ; echo b ; echo c
 
-	echo background >/dev/null &
+	echo background >/System/Devices/null &
 
 	( exit 1 )
 	echo $?
@@ -23,32 +23,32 @@
 
 	i=0
 	while (( i < 3 )); do
-		test -r /dev/fd/$i
+		test -r /System/Devices/fd/$i
 		i=$(( i + 1 ))
 	done
 
-	[[ -r /dev/fd/0 && -w /dev/fd/1 ]] || echo oops > /dev/null
+	[[ -r /System/Devices/fd/0 && -w /System/Devices/fd/1 ]] || echo oops > /System/Devices/null
 
 	for name in $( echo 1 2 3 ); do
-		test -r /dev/fd/$name
+		test -r /System/Devices/fd/$name
 	done
 
-	if [[ -r /dev/fd/0 && -w /dev/fd/1 ]] ; then
-		echo ok > /dev/null
+	if [[ -r /System/Devices/fd/0 && -w /System/Devices/fd/1 ]] ; then
+		echo ok > /System/Devices/null
 	elif (( 7 > 40 )) ; then
 		echo oops
 	else
 		echo done
-	fi > /dev/null
+	fi > /System/Devices/null
 
 	case $PATH in
 	*$PWD*)	echo \$PWD in \$PATH ;;
 	*)	echo \$PWD not in \$PATH ;;
-	esac > /dev/null
+	esac > /System/Devices/null
 
-	while false; do echo z; done > /dev/null
+	while false; do echo z; done > /System/Devices/null
 
-	until true; do echo z ; done > /dev/null
+	until true; do echo z ; done > /System/Devices/null
 
 	echo \&\|'()' \{ echo abcde \; \}
 	# when not in POSIX mode, we can have weirdly-named functions
@@ -58,7 +58,7 @@
 
 tf2()
 {
-	( { time -p echo a | cat - > /dev/null ; } ) 2>&1
+	( { time -p echo a | cat - > /System/Devices/null ; } ) 2>&1
 }
 
 type tf
diff -urN bash-3.0/tests/dstack.right bash-3.0-STEP/tests/dstack.right
--- bash-3.0/tests/dstack.right	2002-03-26 02:42:16.000000000 +1200
+++ bash-3.0-STEP/tests/dstack.right	2005-08-25 00:47:18.654683416 +1200
@@ -1,4 +1,4 @@
-./dstack.tests: line 6: pushd: /tmp/xxx-notthere: No such file or directory
+./dstack.tests: line 6: pushd: /System/TemporaryFiles/xxx-notthere: No such file or directory
 ./dstack.tests: line 9: pushd: no other directory
 ./dstack.tests: line 10: popd: directory stack empty
 ./dstack.tests: line 13: pushd: -m: invalid number
@@ -26,9 +26,9 @@
  2  /
 /usr /etc /
 /etc /usr /
-/tmp /etc /usr /
-/tmp
-/tmp
+/System/TemporaryFiles /etc /usr /
+/System/TemporaryFiles
+/System/TemporaryFiles
 /usr
 /usr
 ./dstack.tests: line 58: dirs: 9: directory stack index out of range
@@ -37,19 +37,19 @@
 ./dstack.tests: line 59: pushd: -9: directory stack index out of range
 ./dstack.tests: line 60: popd: +9: directory stack index out of range
 ./dstack.tests: line 60: popd: -9: directory stack index out of range
-/tmp /etc /
-/tmp /etc /
-/tmp /etc /
-/tmp /usr /etc /
-/tmp
-/tmp /usr /etc /
-/tmp /usr /etc /
-/tmp
-/tmp /bin /etc /
-/tmp
-/tmp /bin /
-/tmp
-/bin / /tmp
-/bin / /tmp
+/System/TemporaryFiles /etc /
+/System/TemporaryFiles /etc /
+/System/TemporaryFiles /etc /
+/System/TemporaryFiles /usr /etc /
+/System/TemporaryFiles
+/System/TemporaryFiles /usr /etc /
+/System/TemporaryFiles /usr /etc /
+/System/TemporaryFiles
+/System/TemporaryFiles /bin /etc /
+/System/TemporaryFiles
+/System/TemporaryFiles /bin /
+/System/TemporaryFiles
+/bin / /System/TemporaryFiles
+/bin / /System/TemporaryFiles
 /bin
 /bin
diff -urN bash-3.0/tests/dstack.tests bash-3.0-STEP/tests/dstack.tests
--- bash-3.0/tests/dstack.tests	1997-11-15 06:31:36.000000000 +1300
+++ bash-3.0-STEP/tests/dstack.tests	2005-08-25 00:47:18.603691168 +1200
@@ -3,7 +3,7 @@
 
 dirs -c
 # error -- nonexistant directory
-pushd /tmp/xxx-notthere
+pushd /System/TemporaryFiles/xxx-notthere
 
 # errors -- empty stack
 pushd
@@ -16,7 +16,7 @@
 dirs 7
 
 MYDIR=$PWD
-unalias cd 2>/dev/null
+unalias cd 2>/System/Devices/null
 
 unalias -a
 
@@ -50,7 +50,7 @@
 pushd
 pushd
 
-pushd /tmp
+pushd /System/TemporaryFiles
 echo ${DIRSTACK[0]} ; dirs +0
 echo ${DIRSTACK[2]} ; dirs +2
 
diff -urN bash-3.0/tests/dstack2.right bash-3.0-STEP/tests/dstack2.right
--- bash-3.0/tests/dstack2.right	1997-11-15 06:28:21.000000000 +1300
+++ bash-3.0-STEP/tests/dstack2.right	2005-08-25 00:47:18.677679920 +1200
@@ -1,11 +1,11 @@
 expect ~1
 ~1
 /usr /
-/tmp /usr /
-/tmp /usr /
+/System/TemporaryFiles /usr /
+/System/TemporaryFiles /usr /
 these lines should be the same
-/tmp
-/tmp /tmp
+/System/TemporaryFiles
+/System/TemporaryFiles /System/TemporaryFiles
 these lines should be the same
 /usr
 /usr /usr
@@ -13,8 +13,8 @@
 /
 / /
 these lines should be the same
-/tmp
-/tmp /tmp
+/System/TemporaryFiles
+/System/TemporaryFiles /System/TemporaryFiles
 these lines should be the same
 /usr
 /usr /usr
diff -urN bash-3.0/tests/dstack2.tests bash-3.0-STEP/tests/dstack2.tests
--- bash-3.0/tests/dstack2.tests	1997-11-15 06:27:22.000000000 +1300
+++ bash-3.0-STEP/tests/dstack2.tests	2005-08-25 00:47:18.656683112 +1200
@@ -4,7 +4,7 @@
 echo ~1
 
 pushd /usr
-pushd /tmp
+pushd /System/TemporaryFiles
 dirs
 
 echo these lines should be the same
diff -urN bash-3.0/tests/errors.right bash-3.0-STEP/tests/errors.right
--- bash-3.0/tests/errors.right	2004-05-28 14:26:03.000000000 +1200
+++ bash-3.0-STEP/tests/errors.right	2005-08-25 00:47:18.691677792 +1200
@@ -12,12 +12,12 @@
 ./errors.tests: line 42: unset: func: cannot unset: readonly function
 ./errors.tests: line 45: declare: func: readonly function
 ./errors.tests: line 49: unset: XPATH: cannot unset: readonly variable
-./errors.tests: line 52: unset: `/bin/sh': not a valid identifier
+./errors.tests: line 52: unset: `/System/Tools/sh': not a valid identifier
 ./errors.tests: line 55: unset: cannot simultaneously unset a function and a variable
 ./errors.tests: line 58: declare: -z: invalid option
 declare: usage: declare [-afFirtx] [-p] [name[=value] ...]
 ./errors.tests: line 60: declare: `-z': not a valid identifier
-./errors.tests: line 61: declare: `/bin/sh': not a valid identifier
+./errors.tests: line 61: declare: `/System/Tools/sh': not a valid identifier
 ./errors.tests: line 65: declare: cannot use `-f' to make functions
 ./errors.tests: line 68: exec: -i: invalid option
 exec: usage: exec [-cl] [-a name] file [redirection ...]
@@ -57,10 +57,10 @@
 ./errors.tests: command substitution: line 168: syntax error near unexpected token `done'
 ./errors.tests: command substitution: line 168: ` for z in 1 2 3; done '
 ./errors.tests: line 171: cd: HOME not set
-./errors.tests: line 172: cd: /tmp/xyz.bash: No such file or directory
+./errors.tests: line 172: cd: /System/TemporaryFiles/xyz.bash: No such file or directory
 ./errors.tests: line 174: cd: OLDPWD not set
-./errors.tests: line 175: cd: /bin/sh: Not a directory
-./errors.tests: line 177: cd: /tmp/cd-notthere: No such file or directory
+./errors.tests: line 175: cd: /System/Tools/sh: Not a directory
+./errors.tests: line 177: cd: /System/TemporaryFiles/cd-notthere: No such file or directory
 ./errors.tests: line 180: .: filename argument required
 .: usage: . filename [arguments]
 ./errors.tests: line 181: source: filename argument required
@@ -73,7 +73,7 @@
 ./errors.tests: line 190: enable: bash: not a shell builtin
 ./errors.tests: line 193: shopt: cannot set and unset shell options simultaneously
 ./errors.tests: line 196: read: var: invalid timeout specification
-./errors.tests: line 199: read: `/bin/sh': not a valid identifier
+./errors.tests: line 199: read: `/System/Tools/sh': not a valid identifier
 ./errors.tests: line 202: VAR: readonly variable
 ./errors.tests: line 205: readonly: -x: invalid option
 readonly: usage: readonly [-af] [name[=value] ...] or readonly -p
@@ -81,8 +81,8 @@
 eval: usage: eval [arg ...]
 ./errors.tests: line 209: command: -i: invalid option
 command: usage: command [-pVv] command [arg ...]
-./errors.tests: line 212: /bin/sh + 0: syntax error: operand expected (error token is "/bin/sh + 0")
-./errors.tests: line 213: /bin/sh + 0: syntax error: operand expected (error token is "/bin/sh + 0")
+./errors.tests: line 212: /System/Tools/sh + 0: syntax error: operand expected (error token is "/System/Tools/sh + 0")
+./errors.tests: line 213: /System/Tools/sh + 0: syntax error: operand expected (error token is "/System/Tools/sh + 0")
 ./errors.tests: line 216: trap: NOSIG: invalid signal specification
 ./errors.tests: line 219: trap: -s: invalid option
 trap: usage: trap [-lp] [[arg] signal_spec ...]
diff -urN bash-3.0/tests/errors.tests bash-3.0-STEP/tests/errors.tests
--- bash-3.0/tests/errors.tests	2001-08-10 10:26:49.000000000 +1200
+++ bash-3.0-STEP/tests/errors.tests	2005-08-25 00:47:18.684678856 +1200
@@ -49,7 +49,7 @@
 unset -v XPATH
 
 # cannot unset invalid identifiers
-unset /bin/sh
+unset /System/Tools/sh
 
 # cannot unset function and variable at the same time
 unset -f -v SHELL
@@ -58,14 +58,14 @@
 declare -z
 # cannot declare invalid identifiers
 declare -- -z 
-declare /bin/sh
+declare /System/Tools/sh
 
 # this is the syntax used to export functions in the environment, but
 # it cannot be used with `declare'
 declare -f func='() { echo "this is func"; }'
 
 # bad option to exec -- this should not exit the script
-exec -i /bin/sh
+exec -i /System/Tools/sh
 
 # try to export -f something that is not a function -- this should be
 # an error, not create an `invisible function'
@@ -135,8 +135,8 @@
 
 # non-octal digits for umask and other errors
 umask 09
-umask -S u=rwx:g=rwx:o=rx >/dev/null # 002
-umask -S u:rwx,g:rwx,o:rx >/dev/null # 002
+umask -S u=rwx:g=rwx:o=rx >/System/Devices/null # 002
+umask -S u:rwx,g:rwx,o:rx >/System/Devices/null # 002
 
 # at some point, this may mean `invert', but for now it is an error
 umask -i
@@ -169,11 +169,11 @@
 
 # various `cd' errors
 ( unset HOME ; cd )
-( HOME=/tmp/xyz.bash ; cd )
+( HOME=/System/TemporaryFiles/xyz.bash ; cd )
 # errors from cd
 cd -
-cd /bin/sh	# error - not a directory
-OLDPWD=/tmp/cd-notthere
+cd /System/Tools/sh	# error - not a directory
+OLDPWD=/System/TemporaryFiles/cd-notthere
 cd -
 
 # various `source/.' errors
@@ -181,7 +181,7 @@
 source
 
 # maybe someday this will work like in rc
-. -i /dev/tty
+. -i /System/Devices/tty
 
 # make sure that this gives an error rather than setting $1
 set -q
@@ -193,13 +193,13 @@
 shopt -s -u checkhash
 
 # this is an error -- bad timeout spec
-read -t var < /dev/null
+read -t var < /System/Devices/null
 
 # try to read into an invalid identifier
-read /bin/sh < /dev/null
+read /System/Tools/sh < /System/Devices/null
 
 # try to read into a readonly variable
-read VAR < /dev/null
+read VAR < /System/Devices/null
 
 # bad option to readonly/export
 readonly -x foo
@@ -209,8 +209,8 @@
 command -i "echo $-"
 
 # this caused a core dump in bash-2.01 (fixed in bash-2.01.1)
-eval echo \$[/bin/sh + 0]
-eval echo '$((/bin/sh + 0))'
+eval echo \$[/System/Tools/sh + 0]
+eval echo '$((/System/Tools/sh + 0))'
 
 # error to list trap for an unknown signal
 trap -p NOSIG
diff -urN bash-3.0/tests/exec.right bash-3.0-STEP/tests/exec.right
--- bash-3.0/tests/exec.right	2004-01-26 15:09:52.000000000 +1300
+++ bash-3.0-STEP/tests/exec.right	2005-08-25 00:47:18.724672776 +1200
@@ -6,9 +6,9 @@
 after exec1.sub without args: 0
 ./execscript: line 20: notthere: command not found
 127
-/tmp/bash: notthere: No such file or directory
+/System/TemporaryFiles/bash: notthere: No such file or directory
 127
-/bin/sh: /bin/sh: cannot execute binary file
+/System/Tools/sh: /System/Tools/sh: cannot execute binary file
 126
 ./execscript: line 39: /: is a directory
 126
@@ -19,8 +19,8 @@
 127
 0
 this is bashenv
-./exec3.sub: line 3: /tmp/bash-notthere: No such file or directory
-./exec3.sub: line 3: exec: /tmp/bash-notthere: cannot execute: No such file or directory
+./exec3.sub: line 3: /System/TemporaryFiles/bash-notthere: No such file or directory
+./exec3.sub: line 3: exec: /System/TemporaryFiles/bash-notthere: cannot execute: No such file or directory
 126
 ./execscript: line 68: notthere: No such file or directory
 127
diff -urN bash-3.0/tests/exec3.sub bash-3.0-STEP/tests/exec3.sub
--- bash-3.0/tests/exec3.sub	1997-03-04 06:58:01.000000000 +1300
+++ bash-3.0-STEP/tests/exec3.sub	2005-08-25 00:47:18.727672320 +1200
@@ -1,6 +1,6 @@
 shopt -s execfail
 
-exec /tmp/bash-notthere
+exec /System/TemporaryFiles/bash-notthere
 # make sure we're still around
 echo $?
 
diff -urN bash-3.0/tests/exec6.sub bash-3.0-STEP/tests/exec6.sub
--- bash-3.0/tests/exec6.sub	2000-09-26 03:36:03.000000000 +1200
+++ bash-3.0-STEP/tests/exec6.sub	2005-08-25 00:47:18.753668368 +1200
@@ -19,36 +19,36 @@
 
 # commands requiring an exec with exit status inverted -- broken in bash-2.04
 
-( ls > /dev/null 2>&1 )
+( ls > /System/Devices/null 2>&1 )
 echo $?
-( ! ls > /dev/null 2>&1 )
+( ! ls > /System/Devices/null 2>&1 )
 echo $?
 
-touch /tmp/notwrite
-chmod 400 /tmp/notwrite
+touch /System/TemporaryFiles/notwrite
+chmod 400 /System/TemporaryFiles/notwrite
 
 # make sure redirection failures in commands whose exit status is inverted
 # are handled correctly
 
-( ls > /tmp/notwrite ) 2>/dev/null
+( ls > /System/TemporaryFiles/notwrite ) 2>/System/Devices/null
 echo $?
 
-( ! ls > /tmp/notwrite ) 2>/dev/null
+( ! ls > /System/TemporaryFiles/notwrite ) 2>/System/Devices/null
 echo $?
 
 # now add exit traps, true and false for commands with and without exit
 # status inversion
 
-(trap 'false' 0 ; ! ls > /tmp/notwrite ) 2>/dev/null
+(trap 'false' 0 ; ! ls > /System/TemporaryFiles/notwrite ) 2>/System/Devices/null
 echo $?
 
-(trap 'false' 0 ; ls > /tmp/notwrite ) 2>/dev/null
+(trap 'false' 0 ; ls > /System/TemporaryFiles/notwrite ) 2>/System/Devices/null
 echo $?
 
-(trap 'true' 0 ; ! ls > /tmp/notwrite ) 2>/dev/null
+(trap 'true' 0 ; ! ls > /System/TemporaryFiles/notwrite ) 2>/System/Devices/null
 echo $?
 
-(trap 'true' 0 ; ls > /tmp/notwrite ) 2>/dev/null
+(trap 'true' 0 ; ls > /System/TemporaryFiles/notwrite ) 2>/System/Devices/null
 echo $?
 
-rm -f /tmp/notwrite
+rm -f /System/TemporaryFiles/notwrite
diff -urN bash-3.0/tests/exec7.sub bash-3.0-STEP/tests/exec7.sub
--- bash-3.0/tests/exec7.sub	2003-09-17 07:04:04.000000000 +1200
+++ bash-3.0-STEP/tests/exec7.sub	2005-08-25 00:47:18.755668064 +1200
@@ -3,7 +3,7 @@
 
 [ $UID -eq 0 ] && { echo "exec7.sub: the test suite should not be run as root" >&2 ; }
 
-: ${TMPDIR:=/tmp}
+: ${TMPDIR:=/System/TemporaryFiles}
 
 cd $TMPDIR || { echo "cannot cd to $TMPDIR" >&2 ; exit 2; }
 
diff -urN bash-3.0/tests/execscript bash-3.0-STEP/tests/execscript
--- bash-3.0/tests/execscript	2004-01-26 15:09:29.000000000 +1300
+++ bash-3.0-STEP/tests/execscript	2005-08-25 00:47:18.716673992 +1200
@@ -14,25 +14,25 @@
 echo after exec1.sub without args: $?
 
 # set up a fixed path so we know notthere will not be found
-PATH=/usr/bin:/bin:/usr/local/bin:
+PATH=/System/Tools:/bin:/usr/local/bin:
 export PATH
 
 notthere
 echo $?
 
 # this is iffy, since the error messages may vary from system to system
-# and /tmp might not exist
-ln -s ${THIS_SH} /tmp/bash 2>/dev/null
-if [ -f /tmp/bash ]; then
-	/tmp/bash notthere
+# and /System/TemporaryFiles might not exist
+ln -s ${THIS_SH} /System/TemporaryFiles/bash 2>/System/Devices/null
+if [ -f /System/TemporaryFiles/bash ]; then
+	/System/TemporaryFiles/bash notthere
 else
 	${THIS_SH} notthere
 fi
 echo $?
-rm -f /tmp/bash
+rm -f /System/TemporaryFiles/bash
 
-# /bin/sh should be there on all systems
-${THIS_SH} /bin/sh
+# /System/Tools/sh should be there on all systems
+${THIS_SH} /System/Tools/sh
 echo $?
 
 # try executing a directory
@@ -48,18 +48,18 @@
 
 # try sourcing a binary file -- post-2.04 versions don't do the binary file
 # check, and will probably fail with `command not found', or status 127
-. ${THIS_SH} 2>/dev/null
+. ${THIS_SH} 2>/System/Devices/null
 echo $?
 
 # post-bash-2.05 versions allow sourcing non-regular files
-. /dev/null
+. /System/Devices/null
 echo $?
 
 # kill two birds with one test -- test out the BASH_ENV code
-echo echo this is bashenv > /tmp/bashenv
-export BASH_ENV=/tmp/bashenv
+echo echo this is bashenv > /System/TemporaryFiles/bashenv
+export BASH_ENV=/System/TemporaryFiles/bashenv
 ${THIS_SH} ./exec3.sub
-rm -f /tmp/bashenv
+rm -f /System/TemporaryFiles/bashenv
 unset BASH_ENV
 
 # we're resetting the $PATH to empty, so this should be last
@@ -95,7 +95,7 @@
 ${THIS_SH} ./exec5.sub
 
 # this was a bug in bash versions before bash-2.04
-${THIS_SH} -c 'cat </dev/null | cat >/dev/null' >&-
+${THIS_SH} -c 'cat </System/Devices/null | cat >/System/Devices/null' >&-
 
 # checks for proper return values in subshell commands with inverted return
 # values
diff -urN bash-3.0/tests/extglob.tests bash-3.0-STEP/tests/extglob.tests
--- bash-3.0/tests/extglob.tests	2003-03-25 07:11:44.000000000 +1200
+++ bash-3.0-STEP/tests/extglob.tests	2005-08-25 00:47:18.760667304 +1200
@@ -7,8 +7,8 @@
 	echo expect "$@"
 }
 
-case "/dev/udp/129.22.8.102/45" in
-/dev/@(tcp|udp)/*/*)	echo ok 1;;
+case "/System/Devices/udp/129.22.8.102/45" in
+/System/Devices/@(tcp|udp)/*/*)	echo ok 1;;
 *)		echo bad 1;;
 esac
 
@@ -193,7 +193,7 @@
 
 MYDIR=$PWD      # save where we are
 
-TESTDIR=/tmp/eglob-test
+TESTDIR=/System/TemporaryFiles/eglob-test
 mkdir $TESTDIR
 builtin cd $TESTDIR || { echo $0: cannot cd to $TESTDIR >&2 ; exit 1; }
 rm -rf *
diff -urN bash-3.0/tests/func3.sub bash-3.0-STEP/tests/func3.sub
--- bash-3.0/tests/func3.sub	2001-02-22 05:49:56.000000000 +1300
+++ bash-3.0-STEP/tests/func3.sub	2005-08-25 00:47:18.766666392 +1200
@@ -27,7 +27,7 @@
 var=30 func
 echo $? $var
 
-: ${TMPDIR:=/tmp}
+: ${TMPDIR:=/System/TemporaryFiles}
 TMPFILE=$TMPDIR/func3.sub.$$
 
 rm -f $TMPFILE
diff -urN bash-3.0/tests/getopts5.sub bash-3.0-STEP/tests/getopts5.sub
--- bash-3.0/tests/getopts5.sub	1997-02-25 09:15:20.000000000 +1300
+++ bash-3.0-STEP/tests/getopts5.sub	2005-08-25 00:33:17.569547792 +1200
@@ -1,4 +1,4 @@
-#!/local/bin/bash
+#!/local/System/Tools/bash
 #Time-stamp: <95/06/07 07:40:40 hrue@imf.unit.no>
 
 getop () {
diff -urN bash-3.0/tests/glob-test bash-3.0-STEP/tests/glob-test
--- bash-3.0/tests/glob-test	2003-09-11 01:43:09.000000000 +1200
+++ bash-3.0-STEP/tests/glob-test	2005-08-25 00:47:18.775665024 +1200
@@ -12,7 +12,7 @@
 
 MYDIR=$PWD	# save where we are
 
-TESTDIR=/tmp/glob-test
+TESTDIR=/System/TemporaryFiles/glob-test
 mkdir $TESTDIR
 builtin cd $TESTDIR || { echo $0: cannot cd to $TESTDIR >&2 ; exit 1; }
 rm -rf *
@@ -307,7 +307,7 @@
 esac
 
 # this was a bug in all versions up to bash-2.04-release
-case "/tmp" in
+case "/System/TemporaryFiles" in
 [/\\]*) echo ok 37 ;;
 esac
 
diff -urN bash-3.0/tests/glob1.sub bash-3.0-STEP/tests/glob1.sub
--- bash-3.0/tests/glob1.sub	1997-11-18 09:21:53.000000000 +1300
+++ bash-3.0-STEP/tests/glob1.sub	2005-08-25 00:47:18.778664568 +1200
@@ -1,5 +1,5 @@
 # bash-2.01.1 failed this test
-FN=/tmp/bash-glob.$$
+FN=/System/TemporaryFiles/bash-glob.$$
 mkdir $FN
 cd $FN
 mkdir foo
diff -urN bash-3.0/tests/heredoc.right bash-3.0-STEP/tests/heredoc.right
--- bash-3.0/tests/heredoc.right	1997-02-22 07:53:20.000000000 +1300
+++ bash-3.0-STEP/tests/heredoc.right	2005-08-25 00:47:18.802660920 +1200
@@ -20,7 +20,7 @@
 fff is a function
 fff () 
 { 
-    ed /tmp/foo  >/dev/null <<ENDOFINPUT
+    ed /System/TemporaryFiles/foo  >/System/Devices/null <<ENDOFINPUT
 /^name/d
 w
 q
@@ -31,7 +31,7 @@
 fff is a function
 fff () 
 { 
-    ed /tmp/foo >/dev/null  <<ENDOFINPUT
+    ed /System/TemporaryFiles/foo >/System/Devices/null  <<ENDOFINPUT
 /^name/d
 w
 q
diff -urN bash-3.0/tests/heredoc.tests bash-3.0-STEP/tests/heredoc.tests
--- bash-3.0/tests/heredoc.tests	1997-04-18 04:03:15.000000000 +1200
+++ bash-3.0-STEP/tests/heredoc.tests	2005-08-25 00:47:18.796661832 +1200
@@ -59,22 +59,22 @@
 	EOF
 
 # check appending of text to file from here document
-rm -f /tmp/bash-zzz
-cat > /tmp/bash-zzz << EOF
+rm -f /System/TemporaryFiles/bash-zzz
+cat > /System/TemporaryFiles/bash-zzz << EOF
 abc
 EOF
-cat >> /tmp/bash-zzz << EOF
+cat >> /System/TemporaryFiles/bash-zzz << EOF
 def ghi
 jkl mno
 EOF
-cat /tmp/bash-zzz
-rm -f /tmp/bash-zzz
+cat /System/TemporaryFiles/bash-zzz
+rm -f /System/TemporaryFiles/bash-zzz
 
 # make sure command printing puts the here-document as the last redirection
 # on the line, and the function export code preserves syntactic correctness
 fff()
 {
-  ed /tmp/foo <<ENDOFINPUT >/dev/null
+  ed /System/TemporaryFiles/foo <<ENDOFINPUT >/System/Devices/null
 /^name/d
 w
 q
diff -urN bash-3.0/tests/histexp.right bash-3.0-STEP/tests/histexp.right
--- bash-3.0/tests/histexp.right	2004-03-20 16:44:55.000000000 +1300
+++ bash-3.0-STEP/tests/histexp.right	2005-08-25 00:47:18.815658944 +1200
@@ -1,14 +1,14 @@
 echo $BASH_VERSION
 ./histexp.tests: line 22: history: !!:z: history expansion failed
     1  for i in one two three; do echo $i; done
-    2  /bin/sh -c 'echo this is $0'
+    2  /System/Tools/sh -c 'echo this is $0'
     3  ls
     4  echo $BASH_VERSION
     1  for i in one two three; do echo $i; done
-    2  /bin/sh -c 'echo this is $0'
+    2  /System/Tools/sh -c 'echo this is $0'
     3  ls
     4  echo $BASH_VERSION
-    5  HISTFILE=/tmp/newhistory
+    5  HISTFILE=/System/TemporaryFiles/newhistory
     6  echo line 2 for history
 echo line 2 for history
 echo line 2 for history
@@ -16,10 +16,10 @@
 echo line 2 for history
 line 2 for history
     1  for i in one two three; do echo $i; done
-    2  /bin/sh -c 'echo this is $0'
+    2  /System/Tools/sh -c 'echo this is $0'
     3  ls
     4  echo $BASH_VERSION
-    5  HISTFILE=/tmp/newhistory
+    5  HISTFILE=/System/TemporaryFiles/newhistory
     6  echo line 2 for history
     7  set -H
     8  echo line 2 for history
@@ -30,8 +30,8 @@
 line 2 for history
 echo line 8 for history
 line 8 for history
-/bin/sh -c 'echo this is $0'
-this is /bin/sh
+/System/Tools/sh -c 'echo this is $0'
+this is /System/Tools/sh
 echo sh
 sh
 echo /bin
@@ -93,7 +93,7 @@
     9  echo a b c d e
    10  echo line 2 for history
    11  echo line 8 for history
-   12  /bin/sh -c 'echo this is $0'
+   12  /System/Tools/sh -c 'echo this is $0'
    13  echo sh
    14  echo /bin
    15  echo e
diff -urN bash-3.0/tests/histexp.tests bash-3.0-STEP/tests/histexp.tests
--- bash-3.0/tests/histexp.tests	1998-02-10 06:10:41.000000000 +1300
+++ bash-3.0-STEP/tests/histexp.tests	2005-08-25 00:47:18.809659856 +1200
@@ -1,6 +1,6 @@
 LC_ALL=C
 LANG=C
-trap 'rm /tmp/newhistory' 0
+trap 'rm /System/TemporaryFiles/newhistory' 0
 
 file=bax
 histchars='!^#'	# make sure history comment char is set correctly
@@ -23,7 +23,7 @@
 
 history
 
-HISTFILE=/tmp/newhistory
+HISTFILE=/System/TemporaryFiles/newhistory
 history -a
 
 history -w
@@ -46,9 +46,9 @@
 
 !2
 
-# we're selecting /bin/sh -c ...; we want `sh'
+# we're selecting /System/Tools/sh -c ...; we want `sh'
 echo !-1:0:t
-# we're selecting /bin/sh -c ...; we want `/bin'
+# we're selecting /System/Tools/sh -c ...; we want `/bin'
 echo !-2:0:h
 # we're selecting `echo a b c d e'; we want `e'
 echo !?d?:5
diff -urN bash-3.0/tests/history.list bash-3.0-STEP/tests/history.list
--- bash-3.0/tests/history.list	1997-02-25 07:31:43.000000000 +1300
+++ bash-3.0-STEP/tests/history.list	2005-08-25 00:33:17.637537456 +1200
@@ -1,4 +1,4 @@
 for i in one two three; do echo $i; done
-/bin/sh -c 'echo this is $0'
+/System/Tools/sh -c 'echo this is $0'
 ls
 echo $BASH_VERSION
diff -urN bash-3.0/tests/history.right bash-3.0-STEP/tests/history.right
--- bash-3.0/tests/history.right	2002-03-26 02:45:36.000000000 +1200
+++ bash-3.0-STEP/tests/history.right	2005-08-25 00:47:18.843654688 +1200
@@ -4,72 +4,72 @@
 ./history.tests: line 9: fc: -v: invalid option
 fc: usage: fc [-e ename] [-nlr] [first] [last] or fc -s [pat=rep] [cmd]
     1  for i in one two three; do echo $i; done
-    2  /bin/sh -c 'echo this is $0'
+    2  /System/Tools/sh -c 'echo this is $0'
     3  ls
     4  echo $BASH_VERSION
 1	 for i in one two three; do echo $i; done
-2	 /bin/sh -c 'echo this is $0'
+2	 /System/Tools/sh -c 'echo this is $0'
 3	 ls
 4	 echo $BASH_VERSION
 	 for i in one two three; do echo $i; done
-	 /bin/sh -c 'echo this is $0'
+	 /System/Tools/sh -c 'echo this is $0'
 	 ls
 	 echo $BASH_VERSION
 4	 echo $BASH_VERSION
 3	 ls
-2	 /bin/sh -c 'echo this is $0'
+2	 /System/Tools/sh -c 'echo this is $0'
 1	 for i in one two three; do echo $i; done
 	 echo $BASH_VERSION
 	 ls
-	 /bin/sh -c 'echo this is $0'
+	 /System/Tools/sh -c 'echo this is $0'
 	 for i in one two three; do echo $i; done
     1  for i in one two three; do echo $i; done
-    2  /bin/sh -c 'echo this is $0'
+    2  /System/Tools/sh -c 'echo this is $0'
     3  ls
     4  echo $BASH_VERSION
     5  echo line for history
 echo line for history
 	 for i in one two three; do echo $i; done
-	 /bin/sh -c 'echo this is $0'
+	 /System/Tools/sh -c 'echo this is $0'
 	 ls
 	 echo $BASH_VERSION
 	 echo line for history
 displaying $HISTFILE after history -a
 echo line for history
-HISTFILE=/tmp/newhistory
+HISTFILE=/System/TemporaryFiles/newhistory
     1  for i in one two three; do echo $i; done
-    2  /bin/sh -c 'echo this is $0'
+    2  /System/Tools/sh -c 'echo this is $0'
     3  ls
     4  echo $BASH_VERSION
     5  echo line for history
-    6  HISTFILE=/tmp/newhistory
+    6  HISTFILE=/System/TemporaryFiles/newhistory
     7  echo displaying \$HISTFILE after history -a
     8  cat $HISTFILE
 for i in one two three; do echo $i; done
-/bin/sh -c 'echo this is $0'
+/System/Tools/sh -c 'echo this is $0'
 ls
 echo $BASH_VERSION
 echo line for history
-HISTFILE=/tmp/newhistory
+HISTFILE=/System/TemporaryFiles/newhistory
 echo displaying \$HISTFILE after history -a
 cat $HISTFILE
     1  for i in one two three; do echo $i; done
-    2  /bin/sh -c 'echo this is $0'
+    2  /System/Tools/sh -c 'echo this is $0'
     3  ls
     4  echo $BASH_VERSION
     5  echo line for history
-    6  HISTFILE=/tmp/newhistory
+    6  HISTFILE=/System/TemporaryFiles/newhistory
     7  echo displaying \$HISTFILE after history -a
     8  cat $HISTFILE
     9  echo line 2 for history
 echo line 2 for history
 echo line 2 for history
     1  for i in one two three; do echo $i; done
-    2  /bin/sh -c 'echo this is $0'
+    2  /System/Tools/sh -c 'echo this is $0'
     3  ls
     4  echo $BASH_VERSION
     5  echo line for history
-    6  HISTFILE=/tmp/newhistory
+    6  HISTFILE=/System/TemporaryFiles/newhistory
     7  echo displaying \$HISTFILE after history -a
     8  cat $HISTFILE
     9  echo line 2 for history
@@ -80,7 +80,7 @@
 line 2 for history
 4	 echo $BASH_VERSION
 5	 echo line for history
-6	 HISTFILE=/tmp/newhistory
+6	 HISTFILE=/System/TemporaryFiles/newhistory
 7	 echo displaying \$HISTFILE after history -a
 8	 cat $HISTFILE
 9	 echo line 2 for history
@@ -94,7 +94,7 @@
 17	 unset HISTFILE
 4	 echo $BASH_VERSION
 5	 echo line for history
-6	 HISTFILE=/tmp/newhistory
+6	 HISTFILE=/System/TemporaryFiles/newhistory
 7	 echo displaying \$HISTFILE after history -a
 8	 cat $HISTFILE
 ./history.tests: line 73: fc: history specification out of range
diff -urN bash-3.0/tests/history.tests bash-3.0-STEP/tests/history.tests
--- bash-3.0/tests/history.tests	2001-11-22 07:15:07.000000000 +1300
+++ bash-3.0-STEP/tests/history.tests	2005-08-25 00:47:18.821658032 +1200
@@ -1,17 +1,17 @@
-trap 'rm /tmp/newhistory' 0
+trap 'rm /System/TemporaryFiles/newhistory' 0
 
 # bad options
 history -x
 # cannot use -r and -w at the same time
-history -r -w /dev/null
+history -r -w /System/Devices/null
 
 # bad option
 fc -v
 
 # all of these should result in an empty history list
 history -c
-history -r /dev/null
-history -n /dev/null
+history -r /System/Devices/null
+history -n /System/Devices/null
 history -c
 
 HISTFILE=history.list
@@ -37,7 +37,7 @@
 
 fc -nl
 
-HISTFILE=/tmp/newhistory
+HISTFILE=/System/TemporaryFiles/newhistory
 history -a
 echo displaying \$HISTFILE after history -a
 cat $HISTFILE
diff -urN bash-3.0/tests/invert.tests bash-3.0-STEP/tests/invert.tests
--- bash-3.0/tests/invert.tests	2000-01-26 05:34:52.000000000 +1300
+++ bash-3.0-STEP/tests/invert.tests	2005-08-25 00:34:12.371216672 +1200
@@ -3,8 +3,8 @@
 
 # user subshells (...) did this wrong in bash versions before 2.04
 
-! ( echo hello | grep h >/dev/null 2>&1 ); echo $?
-! echo hello | grep h >/dev/null 2>&1 ; echo $?
+! ( echo hello | grep h >/System/Devices/null 2>&1 ); echo $?
+! echo hello | grep h >/System/Devices/null 2>&1 ; echo $?
 
 ! true ; echo $?
 ! false; echo $?
diff -urN bash-3.0/tests/jobs.tests bash-3.0-STEP/tests/jobs.tests
--- bash-3.0/tests/jobs.tests	2004-05-07 01:06:20.000000000 +1200
+++ bash-3.0-STEP/tests/jobs.tests	2005-08-25 00:34:12.378215608 +1200
@@ -24,7 +24,7 @@
 fg %1
 # make sure the killed processes don't cause a message
 exec 5>&2
-exec 2>/dev/null
+exec 2>/System/Devices/null
 kill -n 9 $pid
 wait    # make sure we reap the processes while stderr is still redirected
 exec 2>&5
@@ -165,7 +165,7 @@
 
 # make sure the killed processes don't cause a message
 exec 5>&2
-exec 2>/dev/null
+exec 2>/System/Devices/null
 
 echo killing...
 kill -n 9 %2 %3
diff -urN bash-3.0/tests/jobs1.sub bash-3.0-STEP/tests/jobs1.sub
--- bash-3.0/tests/jobs1.sub	1997-11-15 08:12:46.000000000 +1300
+++ bash-3.0-STEP/tests/jobs1.sub	2005-08-25 00:47:18.846654232 +1200
@@ -2,7 +2,7 @@
 set -m
 sleep 60 &
 
-FN=/tmp/jobs-pid.$$
+FN=/System/TemporaryFiles/jobs-pid.$$
 
 pid1=$!
 jobs -p %+ > $FN
@@ -13,5 +13,5 @@
 	echo 'oops - $! and jobs -p %+ disagree!'
 fi
 
-exec 2>/dev/null
+exec 2>/System/Devices/null
 kill -9 $pid1
diff -urN bash-3.0/tests/jobs2.sub bash-3.0-STEP/tests/jobs2.sub
--- bash-3.0/tests/jobs2.sub	1997-11-18 06:31:04.000000000 +1300
+++ bash-3.0-STEP/tests/jobs2.sub	2005-08-25 00:34:12.383214848 +1200
@@ -9,5 +9,5 @@
 fg %1
 echo fg: $?
 
-exec 2>/dev/null
+exec 2>/System/Devices/null
 kill -9 $pid
diff -urN bash-3.0/tests/jobs3.sub bash-3.0-STEP/tests/jobs3.sub
--- bash-3.0/tests/jobs3.sub	1999-04-22 04:59:33.000000000 +1200
+++ bash-3.0-STEP/tests/jobs3.sub	2005-08-25 00:33:17.642536696 +1200
@@ -1,10 +1,10 @@
-#! /bin/bash
+#! /System/Tools/bash
 NJOB=8
 i=0
 
 while [ $i -lt $NJOB ]
 do
-    /bin/sh -c "sleep 4; exit 0" &
+    /System/Tools/sh -c "sleep 4; exit 0" &
     rv=$?
     pid=$!
     eval bg_pid_$i=$pid
diff -urN bash-3.0/tests/misc/dev-tcp.tests bash-3.0-STEP/tests/misc/dev-tcp.tests
--- bash-3.0/tests/misc/dev-tcp.tests	1999-07-09 03:41:58.000000000 +1200
+++ bash-3.0-STEP/tests/misc/dev-tcp.tests	2005-08-25 00:34:12.178246008 +1200
@@ -1,4 +1,4 @@
-exec 9<>/dev/tcp/129.22.8.162/25
+exec 9<>/System/Devices/tcp/129.22.8.162/25
 
 read banner <&9
 echo "$banner"
@@ -11,6 +11,6 @@
 exec 9<&-
 
 # nifty date command that queries the date/time server
-cat < /dev/tcp/129.22.8.102/13
+cat < /System/Devices/tcp/129.22.8.102/13
 
 exit 0
diff -urN bash-3.0/tests/misc/perf-script bash-3.0-STEP/tests/misc/perf-script
--- bash-3.0/tests/misc/perf-script	1994-03-19 08:48:26.000000000 +1300
+++ bash-3.0-STEP/tests/misc/perf-script	2005-08-25 00:33:17.491559648 +1200
@@ -1,4 +1,4 @@
-#!/bin/bash
+#!/System/Tools/bash
 
 typeset -i m2 m1 M n2 n1 N m n
 typeset -i MM=5 NN=5
diff -urN bash-3.0/tests/misc/redir-t2.sh bash-3.0-STEP/tests/misc/redir-t2.sh
--- bash-3.0/tests/misc/redir-t2.sh	1992-03-01 12:55:17.000000000 +1300
+++ bash-3.0-STEP/tests/misc/redir-t2.sh	2005-08-25 00:34:12.181245552 +1200
@@ -4,7 +4,7 @@
 
 exec 4<&0
 
-exec 0</dev/tty
+exec 0</System/Devices/tty
 
 read line2
 
diff -urN bash-3.0/tests/misc/run-r2.sh bash-3.0-STEP/tests/misc/run-r2.sh
--- bash-3.0/tests/misc/run-r2.sh	1997-07-04 04:28:32.000000000 +1200
+++ bash-3.0-STEP/tests/misc/run-r2.sh	2005-08-25 00:46:57.859844712 +1200
@@ -1 +1 @@
-../../bash ./redir-t2.sh < /etc/passwd
+../../bash ./redir-t2.sh < /System/Settings/passwd
diff -urN bash-3.0/tests/misc/wait-bg.tests bash-3.0-STEP/tests/misc/wait-bg.tests
--- bash-3.0/tests/misc/wait-bg.tests	1999-04-22 04:41:18.000000000 +1200
+++ bash-3.0-STEP/tests/misc/wait-bg.tests	2005-08-25 00:33:17.501558128 +1200
@@ -1,9 +1,9 @@
-#! /bin/bash
+#! /System/Tools/bash
 
 i=0
 while [ $i -lt  $1 ]
 do
-    /bin/sh -c "sleep 4; exit 0" &
+    /System/Tools/sh -c "sleep 4; exit 0" &
     rv=$?
     pid=$!
     eval bg_pid_$i=$pid
diff -urN bash-3.0/tests/new-exp.right bash-3.0-STEP/tests/new-exp.right
--- bash-3.0/tests/new-exp.right	2003-06-17 09:30:32.000000000 +1200
+++ bash-3.0-STEP/tests/new-exp.right	2005-08-25 00:47:18.879649216 +1200
@@ -162,8 +162,8 @@
 This-string-has-multiple-lines.
 this is a test of proc subst
 this is test 2
-./new-exp2.sub: line 31: /tmp/bashtmp.x*: No such file or directory
-./new-exp2.sub: line 35: /tmp/redir-notthere: No such file or directory
+./new-exp2.sub: line 31: /System/TemporaryFiles/bashtmp.x*: No such file or directory
+./new-exp2.sub: line 35: /System/TemporaryFiles/redir-notthere: No such file or directory
 1
 argv[1] = <6>
 ./new-exp.tests: line 277: ${#:}: bad substitution
@@ -244,13 +244,13 @@
 argv[1] = <endocrine>
 argv[1] = <endocrine>
 argv[1] = <endocrine>
-argv[1] = </usr/bin>
+argv[1] = </System/Tools>
 argv[2] = </bin>
 argv[3] = </usr/local/bin>
 argv[4] = </usr/gnu/bin>
-argv[5] = </usr/bin/X11>
+argv[5] = </System/Tools/X11>
 argv[6] = </sbin>
-argv[7] = </usr/sbin>
+argv[7] = </System/AdminTools>
 argv[1] = <r>
 argv[2] = <s>
 argv[3] = <t>
@@ -469,12 +469,12 @@
 argv[6] = <sbin>
 argv[7] = <usr/sbin>
 argv[1] = </bin>
-argv[2] = </usr/bin>
+argv[2] = </System/Tools>
 argv[3] = </usr/ucb>
 argv[4] = </usr/local/bin>
 argv[5] = <.>
 argv[6] = </sbin>
-argv[7] = </usr/sbin>
+argv[7] = </System/AdminTools>
 argv[1] = </full/path/to>
 argv[1] = </>
 argv[1] = <full/path/to/x16>
diff -urN bash-3.0/tests/new-exp.tests bash-3.0-STEP/tests/new-exp.tests
--- bash-3.0/tests/new-exp.tests	2003-06-17 09:30:03.000000000 +1200
+++ bash-3.0-STEP/tests/new-exp.tests	2005-08-25 00:47:07.536373656 +1200
@@ -443,7 +443,7 @@
 recho ${xxx//#${zzz}}
 
 # another case that caused a core dump in bash-2.0
-XPATH=/usr/bin:/bin:/usr/local/bin:/usr/gnu/bin::/usr/bin/X11:/sbin:/usr/sbin
+XPATH=/System/Tools:/bin:/usr/local/bin:/usr/gnu/bin::/System/Tools/X11:/sbin:/System/AdminTools
 
 recho ${XPATH//:/ }
 
@@ -524,7 +524,7 @@
 set a
 recho ${@:1:$(($# - 2))}
 
-XPATH=/bin:/usr/bin:/usr/ucb:/usr/local/bin:.:/sbin:/usr/sbin
+XPATH=/bin:/System/Tools:/usr/ucb:/usr/local/bin:.:/sbin:/System/AdminTools
 set $( IFS=: ; echo $XPATH ) 
 
 recho ${@##*/}
diff -urN bash-3.0/tests/new-exp1.sub bash-3.0-STEP/tests/new-exp1.sub
--- bash-3.0/tests/new-exp1.sub	1997-03-27 07:12:33.000000000 +1200
+++ bash-3.0-STEP/tests/new-exp1.sub	2005-08-25 00:47:18.854653016 +1200
@@ -5,7 +5,7 @@
 
 expect this is a test of proc subst
 cat <(echo this is a test of proc subst)
-echo this is test 2 > /tmp/x
+echo this is test 2 > /System/TemporaryFiles/x
 expect this is test 2
-cat <(cat /tmp/x)
-rm -f /tmp/x
+cat <(cat /System/TemporaryFiles/x)
+rm -f /System/TemporaryFiles/x
diff -urN bash-3.0/tests/new-exp2.sub bash-3.0-STEP/tests/new-exp2.sub
--- bash-3.0/tests/new-exp2.sub	1997-11-15 07:40:27.000000000 +1300
+++ bash-3.0-STEP/tests/new-exp2.sub	2005-08-25 00:47:18.869650736 +1200
@@ -4,7 +4,7 @@
 # test out the new $(< filename) code
 # it should be exactly equivalent to $(cat filename)
 
-FILENAME=/tmp/bashtmp.x$$
+FILENAME=/System/TemporaryFiles/bashtmp.x$$
 
 trap 'rm -f $FILENAME' 0
 
@@ -21,16 +21,16 @@
 	echo 'whoops: $(< filename) failed'
 fi
 
-LINES2=$(< /tmp/bashtmp.x*)
+LINES2=$(< /System/TemporaryFiles/bashtmp.x*)
 if [[ $LINES1 != $LINES2 ]]; then
 	echo 'whoops: $(< filename) with glob expansion failed'
 fi
 
 # but the glob expansion in the redirection should fail in posix mode
 set -o posix
-LINES2=$(< /tmp/bashtmp.x*)
+LINES2=$(< /System/TemporaryFiles/bashtmp.x*)
 set +o posix
 
 # now see what happens when we try it with a non-existant file
-LINES3=$(< /tmp/redir-notthere)
+LINES3=$(< /System/TemporaryFiles/redir-notthere)
 echo $?
diff -urN bash-3.0/tests/new-exp4.sub bash-3.0-STEP/tests/new-exp4.sub
--- bash-3.0/tests/new-exp4.sub	2003-06-17 09:29:09.000000000 +1200
+++ bash-3.0-STEP/tests/new-exp4.sub	2005-08-25 00:33:17.645536240 +1200
@@ -1,4 +1,4 @@
-#!/bin/bash
+#!/System/Tools/bash
 
 arrayA=("A" "B" "C")
 
diff -urN bash-3.0/tests/posix2.tests bash-3.0-STEP/tests/posix2.tests
--- bash-3.0/tests/posix2.tests	2001-10-26 02:15:23.000000000 +1300
+++ bash-3.0-STEP/tests/posix2.tests	2005-08-25 00:47:18.882648760 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 # posix-2.sh - Simple identification tests for POSIX.2 features
 # commonly missing or incorrectly implemented.
 # Time-stamp: <96/04/10 16:43:48 gildea>
@@ -28,11 +28,11 @@
 
 # For some tests we must run a sub-shell; $TESTSHELL says what to use.
 # If set, TESTSHELL must be an absolute pathname.
-# For example, on HP-UX 9, /bin/posix/sh is the supposedly-compliant shell.
+# For example, on HP-UX 9, /System/Tools/posix/sh is the supposedly-compliant shell.
 TESTSHELL=${THIS_SH:-$PWD/../bash}
 
 # these tests create temp files with names $TMPDIR/conf*
-: ${TMPDIR:=/tmp}
+: ${TMPDIR:=/System/TemporaryFiles}
 
 exitval=0
 numtests=0
@@ -84,7 +84,7 @@
 $TMPDIR/conftest2 "\$@"
 EOF
 cat > $TMPDIR/conftest2 << "EOF"
-#! /bin/sh
+#! /System/Tools/sh
 echo $#
 EOF
 chmod +x $TMPDIR/conftest1 $TMPDIR/conftest2
@@ -102,22 +102,22 @@
 
 newtest
 # do these tests in a sub-shell because failure will exit
-val=$("$TESTSHELL" -c 'echo ${10}' 0  1 2 3 4 5 6 7 8 9 ten 11 2> /dev/null)
+val=$("$TESTSHELL" -c 'echo ${10}' 0  1 2 3 4 5 6 7 8 9 ten 11 2> /System/Devices/null)
 test "$val" = ten || testfail "accessing more than 9 positional params"
 
 a=abc_def_ghi
 export a
-newtest; val=`"$TESTSHELL" -c 'echo "${a%_*}"' 2> /dev/null`
+newtest; val=`"$TESTSHELL" -c 'echo "${a%_*}"' 2> /System/Devices/null`
 test "$val" = abc_def || testfail "parameter % op"
-newtest; val=`"$TESTSHELL" -c 'echo "${a%%_*}"' 2> /dev/null`
+newtest; val=`"$TESTSHELL" -c 'echo "${a%%_*}"' 2> /System/Devices/null`
 test "$val" = abc || testfail "parameter %% op"
-newtest; val=`"$TESTSHELL" -c 'echo "${a#*_}"' 2> /dev/null`
+newtest; val=`"$TESTSHELL" -c 'echo "${a#*_}"' 2> /System/Devices/null`
 test "$val" = def_ghi || testfail "parameter # op"
-newtest; val=`"$TESTSHELL" -c 'echo "${a##*_}"' 2> /dev/null`
+newtest; val=`"$TESTSHELL" -c 'echo "${a##*_}"' 2> /System/Devices/null`
 test "$val" = ghi || testfail "parameter ## op"
 
 newtest
-"$TESTSHELL" -c 'export a=value' 2> /dev/null || testfail "export with value"
+"$TESTSHELL" -c 'export a=value' 2> /System/Devices/null || testfail "export with value"
 
 newtest
 a=5; test "$(( ($a+1)/2 ))" = 3 || testfail "arithmetic expansion"
diff -urN bash-3.0/tests/read.tests bash-3.0-STEP/tests/read.tests
--- bash-3.0/tests/read.tests	2004-03-15 11:18:02.000000000 +1300
+++ bash-3.0-STEP/tests/read.tests	2005-08-25 00:47:18.922642680 +1200
@@ -25,43 +25,43 @@
 # the input stream
 echo $'ab\\\ncd' | ( read ; recho "$REPLY" )
 
-echo "A B " > /tmp/IN
+echo "A B " > /System/TemporaryFiles/IN
 unset x y z
-read x y z < /tmp/IN
+read x y z < /System/TemporaryFiles/IN
 echo 1: "x[$x] y[$y] z[$z]"
 echo 1a: ${z-z not set}
-read x < /tmp/IN
+read x < /System/TemporaryFiles/IN
 echo 2: "x[$x]"
-rm /tmp/IN
+rm /System/TemporaryFiles/IN
 
 # this is where the bash `read' behavior with respect to $REPLY differs
 # from ksh93
-echo "A B " > /tmp/IN
+echo "A B " > /System/TemporaryFiles/IN
 
-read < /tmp/IN
+read < /System/TemporaryFiles/IN
 echo "[$REPLY]"
 
-rm /tmp/IN
+rm /System/TemporaryFiles/IN
 
-echo " A B " > /tmp/IN
+echo " A B " > /System/TemporaryFiles/IN
 
-read < /tmp/IN
+read < /System/TemporaryFiles/IN
 echo "[$REPLY]"
 
-rm /tmp/IN
+rm /System/TemporaryFiles/IN
 
 # make sure that read with more variables than words sets the extra
 # variables to the empty string
 
 bvar=bvar
 cvar=cvar
-echo aa > /tmp/IN
-read avar bvar cvar < /tmp/IN
+echo aa > /System/TemporaryFiles/IN
+read avar bvar cvar < /System/TemporaryFiles/IN
 echo =="$avar"==
 echo =="$bvar"==
 echo =="$cvar"==
 
-rm /tmp/IN
+rm /System/TemporaryFiles/IN
 
 # test behavior of read with various settings of IFS
 
diff -urN bash-3.0/tests/read2.sub bash-3.0-STEP/tests/read2.sub
--- bash-3.0/tests/read2.sub	2002-09-18 06:04:33.000000000 +1200
+++ bash-3.0-STEP/tests/read2.sub	2005-08-25 00:34:12.410210744 +1200
@@ -1,6 +1,6 @@
 a=4
 
-read -t 2 a < /dev/tty
+read -t 2 a < /System/Devices/tty
 echo $?
 
 echo $a
@@ -10,7 +10,7 @@
 
 echo $a
 
-read -t -3 a < /dev/tty
+read -t -3 a < /System/Devices/tty
 echo $?
 
 echo $a
diff -urN bash-3.0/tests/redir.right bash-3.0-STEP/tests/redir.right
--- bash-3.0/tests/redir.right	2003-06-03 07:45:32.000000000 +1200
+++ bash-3.0-STEP/tests/redir.right	2005-08-25 00:47:19.050623224 +1200
@@ -1,5 +1,5 @@
 abc
-./redir.tests: line 13: /tmp/redir-test: cannot overwrite existing file
+./redir.tests: line 13: /System/TemporaryFiles/redir-test: cannot overwrite existing file
 abc
 def
 def
@@ -26,10 +26,10 @@
 to stdout
 ./redir4.sub: line 32: $fd: ambiguous redirect
 ./redir4.sub: line 33: $fd: ambiguous redirect
-/tmp/err-and-out:
+/System/TemporaryFiles/err-and-out:
 to stdout
 to stderr
-/tmp/err-and-out:
+/System/TemporaryFiles/err-and-out:
 to stdout
 to stderr
 0 -- 3 0
diff -urN bash-3.0/tests/redir.tests bash-3.0-STEP/tests/redir.tests
--- bash-3.0/tests/redir.tests	2003-06-03 07:45:18.000000000 +1200
+++ bash-3.0-STEP/tests/redir.tests	2005-08-25 00:47:19.040624744 +1200
@@ -4,25 +4,25 @@
 # catch-all for remaining untested redirection stuff
 set +o posix
 
-echo abc > /tmp/redir-test
-cat /tmp/redir-test
+echo abc > /System/TemporaryFiles/redir-test
+cat /System/TemporaryFiles/redir-test
 
 set -o noclobber
 
 #this should be an error
-echo def > /tmp/redir-test
-cat /tmp/redir-test
+echo def > /System/TemporaryFiles/redir-test
+cat /System/TemporaryFiles/redir-test
 
 # but this should succeed
-echo def > /tmp/redir-test-2
-cat /tmp/redir-test-2
+echo def > /System/TemporaryFiles/redir-test-2
+cat /System/TemporaryFiles/redir-test-2
 
 # and so should this
-echo def >| /tmp/redir-test
-cat /tmp/redir-test
+echo def >| /System/TemporaryFiles/redir-test
+cat /System/TemporaryFiles/redir-test
 
 set +o noclobber
-rm /tmp/redir-test /tmp/redir-test-2
+rm /System/TemporaryFiles/redir-test /System/TemporaryFiles/redir-test-2
 
 # this should be an error
 z="a b"
@@ -30,32 +30,32 @@
 
 echo "Point 1"
 
-exec 3</etc/passwd
-exec 4>/tmp/bash-a
-exec 5>/tmp/bash-b
+exec 3</System/Settings/passwd
+exec 4>/System/TemporaryFiles/bash-a
+exec 5>/System/TemporaryFiles/bash-b
 echo "Point 2"
 
 echo to a 1>&4
 echo to b 1>&5
-cat /tmp/bash-a
-cat /tmp/bash-b
-exec 11</dev/null
+cat /System/TemporaryFiles/bash-a
+cat /System/TemporaryFiles/bash-b
+exec 11</System/Devices/null
 echo "Point 3"
 
 echo to a 1>&4
 echo to b 1>&5
-cat /tmp/bash-a
-cat /tmp/bash-b
+cat /System/TemporaryFiles/bash-a
+cat /System/TemporaryFiles/bash-b
 
 exec 11<&-
 echo "Point 4"
 
-exec 6<>/tmp/bash-c
+exec 6<>/System/TemporaryFiles/bash-c
 echo to c 1>&6
-cat /tmp/bash-c
+cat /System/TemporaryFiles/bash-c
 echo "Point 5"
 
-rm -f /tmp/bash-a /tmp/bash-b /tmp/bash-c
+rm -f /System/TemporaryFiles/bash-a /System/TemporaryFiles/bash-b /System/TemporaryFiles/bash-c
 
 #
 # Test the effect of input buffering on the shell's input
@@ -78,36 +78,36 @@
 	fi
 }
 
-> /tmp/null-redir-a
-testf /tmp/null-redir-a
+> /System/TemporaryFiles/null-redir-a
+testf /System/TemporaryFiles/null-redir-a
 
-$EXIT > /tmp/null-redir-b
-testf /tmp/null-redir-b
+$EXIT > /System/TemporaryFiles/null-redir-b
+testf /System/TemporaryFiles/null-redir-b
 
-( > /tmp/null-redir-c )
-testf /tmp/null-redir-c
+( > /System/TemporaryFiles/null-redir-c )
+testf /System/TemporaryFiles/null-redir-c
 
-$EXIT > /tmp/null-redir-d &
+$EXIT > /System/TemporaryFiles/null-redir-d &
 wait
-testf /tmp/null-redir-d
+testf /System/TemporaryFiles/null-redir-d
 
-exit 3 | $EXIT > /tmp/null-redir-e
+exit 3 | $EXIT > /System/TemporaryFiles/null-redir-e
 echo $? -- ${PIPESTATUS[@]}
-testf /tmp/null-redir-e
+testf /System/TemporaryFiles/null-redir-e
 
-exit 4 | > /tmp/null-redir-f
+exit 4 | > /System/TemporaryFiles/null-redir-f
 echo $? -- ${PIPESTATUS[@]}
-testf /tmp/null-redir-f
+testf /System/TemporaryFiles/null-redir-f
 
-> /tmp/null-redir-g &
+> /System/TemporaryFiles/null-redir-g &
 wait
-testf /tmp/null-redir-g
+testf /System/TemporaryFiles/null-redir-g
 
-exec >/tmp/null-redir-h &
+exec >/System/TemporaryFiles/null-redir-h &
 wait
-testf /tmp/null-redir-h
+testf /System/TemporaryFiles/null-redir-h
 
-# make sure async commands don't get /dev/null as stdin when an explicit
+# make sure async commands don't get /System/Devices/null as stdin when an explicit
 # input redirection is supplied
 for x in 1 2 3; do
 	{ read line ; echo $line ; } &
@@ -123,9 +123,9 @@
 kl
 EOF
 
-# make sure async commands get /dev/null as stdin in the absence of any
+# make sure async commands get /System/Devices/null as stdin in the absence of any
 # input redirection
-/bin/cat &
+/System/Tools/cat &
 wait
 echo $?
 
@@ -141,9 +141,9 @@
 echo $l2
 
 # These should not echo anything -- bug in versions before 2.04
-( ( echo hello 1>&3 ) 3>&1 ) >/dev/null 2>&1
+( ( echo hello 1>&3 ) 3>&1 ) >/System/Devices/null 2>&1
 
-( ( echo hello 1>&3 ) 3>&1 ) >/dev/null 2>&1 | cat
+( ( echo hello 1>&3 ) 3>&1 ) >/System/Devices/null 2>&1 | cat
 
 # in posix mode, non-interactive shells are not allowed to perform
 # filename expansion on input redirections, even if they expand to
diff -urN bash-3.0/tests/redir4.sub bash-3.0-STEP/tests/redir4.sub
--- bash-3.0/tests/redir4.sub	1997-02-27 08:24:04.000000000 +1300
+++ bash-3.0-STEP/tests/redir4.sub	2005-08-25 00:47:19.077619120 +1200
@@ -34,23 +34,23 @@
 
 exec 3>&1 4>&2
 
-exec >&/tmp/err-and-out
+exec >&/System/TemporaryFiles/err-and-out
 echo to stdout
 echo to stderr >&2
 
 exec 1>&3 2>&4
-echo /tmp/err-and-out:
-cat /tmp/err-and-out
+echo /System/TemporaryFiles/err-and-out:
+cat /System/TemporaryFiles/err-and-out
 
-rm /tmp/err-and-out
+rm /System/TemporaryFiles/err-and-out
 
-fd=/tmp/err-and-out
+fd=/System/TemporaryFiles/err-and-out
 exec >&$fd
 echo to stdout
 echo to stderr >&2
 
 exec 1>&3 2>&4
-echo /tmp/err-and-out:
-cat /tmp/err-and-out
+echo /System/TemporaryFiles/err-and-out:
+cat /System/TemporaryFiles/err-and-out
 
-rm /tmp/err-and-out
+rm /System/TemporaryFiles/err-and-out
diff -urN bash-3.0/tests/rsh.right bash-3.0-STEP/tests/rsh.right
--- bash-3.0/tests/rsh.right	2002-03-26 02:49:49.000000000 +1200
+++ bash-3.0-STEP/tests/rsh.right	2005-08-25 00:47:19.096616232 +1200
@@ -1,10 +1,10 @@
 ./rsh.tests: line 9: cd: restricted
 ./rsh.tests: line 10: PATH: readonly variable
 ./rsh.tests: line 11: SHELL: readonly variable
-./rsh.tests: line 12: /bin/sh: restricted: cannot specify `/' in command names
+./rsh.tests: line 12: /System/Tools/sh: restricted: cannot specify `/' in command names
 ./rsh.tests: line 14: .: ./source.sub3: restricted
-./rsh.tests: line 17: /tmp/restricted: restricted: cannot redirect output
-./rsh.tests: line 21: /tmp/restricted: restricted: cannot redirect output
+./rsh.tests: line 17: /System/TemporaryFiles/restricted: restricted: cannot redirect output
+./rsh.tests: line 21: /System/TemporaryFiles/restricted: restricted: cannot redirect output
 ./rsh.tests: line 26: command: -p: restricted
 ./rsh.tests: line 28: set: +r: invalid option
 set: usage: set [--abefhkmnptuvxBCHP] [-o option] [arg ...]
diff -urN bash-3.0/tests/rsh.tests bash-3.0-STEP/tests/rsh.tests
--- bash-3.0/tests/rsh.tests	1997-11-21 06:05:05.000000000 +1300
+++ bash-3.0-STEP/tests/rsh.tests	2005-08-25 00:47:19.090617144 +1200
@@ -8,18 +8,18 @@
 
 cd /
 PATH=$PATH:/usr/local/bin
-SHELL=/bin/sh
-/bin/sh -c 'echo /bin/sh executed'
+SHELL=/System/Tools/sh
+/System/Tools/sh -c 'echo /System/Tools/sh executed'
 
 . ./source.sub3
 
-rm -f /tmp/restricted
-echo abc > /tmp/restricted
-if [ -f /tmp/restricted ]; then
+rm -f /System/TemporaryFiles/restricted
+echo abc > /System/TemporaryFiles/restricted
+if [ -f /System/TemporaryFiles/restricted ]; then
 	echo oops 1 -- output
 fi
-echo abc >> /tmp/restricted
-if [ -f /tmp/restricted ]; then
+echo abc >> /System/TemporaryFiles/restricted
+if [ -f /System/TemporaryFiles/restricted ]; then
 	echo oops 2 -- append
 fi
 
@@ -28,6 +28,6 @@
 set +r
 set +o restricted
 
-exec /bin/date
+exec /System/Tools/date
 
 echo $0: after exec
diff -urN bash-3.0/tests/run-alias bash-3.0-STEP/tests/run-alias
--- bash-3.0/tests/run-alias	2003-01-15 05:07:31.000000000 +1300
+++ bash-3.0-STEP/tests/run-alias	2005-08-25 00:47:19.104615016 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./alias.tests > /tmp/xx 2>&1
-diff /tmp/xx alias.right && rm -f /tmp/xx
+${THIS_SH} ./alias.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx alias.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-all bash-3.0-STEP/tests/run-all
--- bash-3.0/tests/run-all	1999-10-09 04:07:46.000000000 +1300
+++ bash-3.0-STEP/tests/run-all	2005-08-25 00:47:18.591692992 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 
 PATH=.:$PATH	# just to get recho/zecho/printenv if not run via `make tests'
 export PATH
@@ -13,7 +13,7 @@
 
 ${THIS_SH} ./version
 
-rm -f /tmp/xx
+rm -f /System/TemporaryFiles/xx
 
 echo Any output from any test, unless otherwise noted, indicates a possible anomaly
 
diff -urN bash-3.0/tests/run-arith bash-3.0-STEP/tests/run-arith
--- bash-3.0/tests/run-arith	1996-02-03 10:09:39.000000000 +1300
+++ bash-3.0-STEP/tests/run-arith	2005-08-25 00:47:19.115613344 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./arith.tests > /tmp/xx 2>&1
-diff /tmp/xx arith.right && rm -f /tmp/xx
+${THIS_SH} ./arith.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx arith.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-arith-for bash-3.0-STEP/tests/run-arith-for
--- bash-3.0/tests/run-arith-for	1999-04-22 04:13:10.000000000 +1200
+++ bash-3.0-STEP/tests/run-arith-for	2005-08-25 00:47:19.110614104 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./arith-for.tests > /tmp/xx 2>&1
-diff /tmp/xx arith-for.right && rm -f /tmp/xx
+${THIS_SH} ./arith-for.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx arith-for.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-array bash-3.0-STEP/tests/run-array
--- bash-3.0/tests/run-array	1997-09-24 06:38:45.000000000 +1200
+++ bash-3.0-STEP/tests/run-array	2005-08-25 00:47:19.120612584 +1200
@@ -1,4 +1,4 @@
 echo "warning: all of these tests will fail if arrays have not" >&2
 echo "warning: been compiled into the shell" >&2
-${THIS_SH} ./array.tests > /tmp/xx 2>&1
-diff /tmp/xx array.right && rm -f /tmp/xx
+${THIS_SH} ./array.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx array.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-array2 bash-3.0-STEP/tests/run-array2
--- bash-3.0/tests/run-array2	1997-09-24 06:38:49.000000000 +1200
+++ bash-3.0-STEP/tests/run-array2	2005-08-25 00:47:19.126611672 +1200
@@ -1,4 +1,4 @@
 echo "warning: all of these tests will fail if arrays have not" >&2
 echo "warning: been compiled into the shell" >&2
-${THIS_SH} ./array-at-star > /tmp/xx 2>&1
-diff /tmp/xx array2.right && rm -f /tmp/xx
+${THIS_SH} ./array-at-star > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx array2.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-braces bash-3.0-STEP/tests/run-braces
--- bash-3.0/tests/run-braces	2003-04-09 01:46:27.000000000 +1200
+++ bash-3.0-STEP/tests/run-braces	2005-08-25 00:47:19.131610912 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./braces.tests > /tmp/xx
-diff /tmp/xx braces.right && rm -f /tmp/xx
+${THIS_SH} ./braces.tests > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx braces.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-builtins bash-3.0-STEP/tests/run-builtins
--- bash-3.0/tests/run-builtins	1997-02-25 09:01:30.000000000 +1300
+++ bash-3.0-STEP/tests/run-builtins	2005-08-25 00:47:19.136610152 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./builtins.tests > /tmp/xx 2>&1
-diff /tmp/xx builtins.right && rm -f /tmp/xx
+${THIS_SH} ./builtins.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx builtins.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-cond bash-3.0-STEP/tests/run-cond
--- bash-3.0/tests/run-cond	1997-09-17 03:48:26.000000000 +1200
+++ bash-3.0-STEP/tests/run-cond	2005-08-25 00:47:19.142609240 +1200
@@ -3,5 +3,5 @@
 echo "warning: some of these tests will fail if extended pattern matching has not" >&2
 echo "warning: been compiled into the shell" >&2
 
-${THIS_SH} ./cond.tests > /tmp/xx 2>&1
-diff /tmp/xx cond.right && rm -f /tmp/xx
+${THIS_SH} ./cond.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx cond.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-cprint bash-3.0-STEP/tests/run-cprint
--- bash-3.0/tests/run-cprint	1999-02-04 03:33:27.000000000 +1300
+++ bash-3.0-STEP/tests/run-cprint	2005-08-25 00:47:19.152607720 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./cprint.tests > /tmp/xx 2>&1
-diff /tmp/xx cprint.right && rm -f /tmp/xx
+${THIS_SH} ./cprint.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx cprint.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-dbg-support bash-3.0-STEP/tests/run-dbg-support
--- bash-3.0/tests/run-dbg-support	2003-09-25 00:56:13.000000000 +1200
+++ bash-3.0-STEP/tests/run-dbg-support	2005-08-25 00:47:19.155607264 +1200
@@ -2,8 +2,8 @@
 #$Id: run-dbg-support,v 1.5 2002/11/14 06:08:16 rockyb Exp $
 
 TEST_NAME='dbg-support'
-TEST_FILE="/tmp/${TEST_NAME}.check"
-${THIS_SH} ./${TEST_NAME}.tests > $TEST_FILE 2>&1 < /dev/null
+TEST_FILE="/System/TemporaryFiles/${TEST_NAME}.check"
+${THIS_SH} ./${TEST_NAME}.tests > $TEST_FILE 2>&1 < /System/Devices/null
 set -f
 diff $TEST_FILE ${TEST_NAME}.right && rm -f $TEST_FILE
 
diff -urN bash-3.0/tests/run-dbg-support2 bash-3.0-STEP/tests/run-dbg-support2
--- bash-3.0/tests/run-dbg-support2	2003-09-25 00:56:20.000000000 +1200
+++ bash-3.0-STEP/tests/run-dbg-support2	2005-08-25 00:47:19.158606808 +1200
@@ -2,8 +2,8 @@
 #$Id: run-dbg-support2,v 1.3 2002/11/14 06:08:16 rockyb Exp $
 
 TEST_NAME='dbg-support2'
-TEST_FILE="/tmp/${TEST_NAME}.check"
-${THIS_SH} ./${TEST_NAME}.tests > $TEST_FILE 2>&1 < /dev/null
+TEST_FILE="/System/TemporaryFiles/${TEST_NAME}.check"
+${THIS_SH} ./${TEST_NAME}.tests > $TEST_FILE 2>&1 < /System/Devices/null
 set -f
 diff $TEST_FILE ${TEST_NAME}.right && rm -f $TEST_FILE
 
diff -urN bash-3.0/tests/run-dirstack bash-3.0-STEP/tests/run-dirstack
--- bash-3.0/tests/run-dirstack	1997-09-26 06:26:47.000000000 +1200
+++ bash-3.0-STEP/tests/run-dirstack	2005-08-25 00:47:19.172604680 +1200
@@ -1,5 +1,5 @@
-${THIS_SH} ./dstack.tests > /tmp/xx 2>&1
-diff /tmp/xx dstack.right && rm -f /tmp/xx
+${THIS_SH} ./dstack.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx dstack.right && rm -f /System/TemporaryFiles/xx
 
-${THIS_SH} ./dstack2.tests > /tmp/xx 2>&1
-diff /tmp/xx dstack2.right && rm -f /tmp/xx
+${THIS_SH} ./dstack2.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx dstack2.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-dollars bash-3.0-STEP/tests/run-dollars
--- bash-3.0/tests/run-dollars	1997-08-26 09:23:07.000000000 +1200
+++ bash-3.0-STEP/tests/run-dollars	2005-08-25 00:47:19.177603920 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./dollar-at-star > /tmp/xx 2>&1
-diff /tmp/xx dollar.right && rm -f /tmp/xx
+${THIS_SH} ./dollar-at-star > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx dollar.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-errors bash-3.0-STEP/tests/run-errors
--- bash-3.0/tests/run-errors	1997-02-27 11:39:45.000000000 +1300
+++ bash-3.0-STEP/tests/run-errors	2005-08-25 00:47:19.183603008 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./errors.tests > /tmp/xx 2>&1
-diff /tmp/xx errors.right && rm -f /tmp/xx
+${THIS_SH} ./errors.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx errors.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-execscript bash-3.0-STEP/tests/run-execscript
--- bash-3.0/tests/run-execscript	2004-01-27 07:30:15.000000000 +1300
+++ bash-3.0-STEP/tests/run-execscript	2005-08-25 00:47:19.191601792 +1200
@@ -1,9 +1,9 @@
 echo "warning: the text of a system error message may vary between systems and" >&2
 echo "warning: produce diff output." >&2
 echo "warning: if the text of the error messages concerning \`notthere' or" >&2
-echo "warning: \`/tmp/bash-notthere' not being found or \`/' being a directory" >&2
+echo "warning: \`/System/TemporaryFiles/bash-notthere' not being found or \`/' being a directory" >&2
 echo "warning: produce diff output, please do not consider this a test failure" >&2
 echo "warning: if diff output differing only in the location of the bash" >&2
 echo "warning: binary appears, please do not consider this a test failure" >&2
-${THIS_SH} ./execscript > /tmp/xx 2>&1
-diff /tmp/xx exec.right && rm -f /tmp/xx
+${THIS_SH} ./execscript > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx exec.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-exp-tests bash-3.0-STEP/tests/run-exp-tests
--- bash-3.0/tests/run-exp-tests	1996-02-03 10:10:24.000000000 +1300
+++ bash-3.0-STEP/tests/run-exp-tests	2005-08-25 00:47:19.196601032 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./exp-tests | grep -v '^expect' > /tmp/xx
-diff /tmp/xx exp.right && rm -f /tmp/xx
+${THIS_SH} ./exp-tests | grep -v '^expect' > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx exp.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-extglob bash-3.0-STEP/tests/run-extglob
--- bash-3.0/tests/run-extglob	1997-08-08 06:11:31.000000000 +1200
+++ bash-3.0-STEP/tests/run-extglob	2005-08-25 00:47:19.201600272 +1200
@@ -1,4 +1,4 @@
 PATH=$PATH:`pwd`
 export PATH
-${THIS_SH} ./extglob.tests | grep -v '^expect' > /tmp/xx
-diff /tmp/xx extglob.right && rm -f /tmp/xx
+${THIS_SH} ./extglob.tests | grep -v '^expect' > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx extglob.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-extglob2 bash-3.0-STEP/tests/run-extglob2
--- bash-3.0/tests/run-extglob2	1999-03-09 09:05:32.000000000 +1300
+++ bash-3.0-STEP/tests/run-extglob2	2005-08-25 00:47:19.207599360 +1200
@@ -1,4 +1,4 @@
 PATH=$PATH:`pwd`
 export PATH
-${THIS_SH} ./extglob2.tests | grep -v '^expect' > /tmp/xx
-diff /tmp/xx extglob2.right && rm -f /tmp/xx
+${THIS_SH} ./extglob2.tests | grep -v '^expect' > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx extglob2.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-func bash-3.0-STEP/tests/run-func
--- bash-3.0/tests/run-func	1997-05-28 02:50:51.000000000 +1200
+++ bash-3.0-STEP/tests/run-func	2005-08-25 00:47:19.212598600 +1200
@@ -1,5 +1,5 @@
 echo "warning: if you have exported functions defined in your environment," >&2
 echo "warning: they may show up as diff output." >&2
 echo "warning: if so, please do not consider this a test failure" >&2
-${THIS_SH} ./func.tests > /tmp/xx 2>&1
-diff /tmp/xx func.right && rm -f /tmp/xx
+${THIS_SH} ./func.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx func.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-getopts bash-3.0-STEP/tests/run-getopts
--- bash-3.0/tests/run-getopts	1997-02-25 09:16:38.000000000 +1300
+++ bash-3.0-STEP/tests/run-getopts	2005-08-25 00:47:19.217597840 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./getopts.tests > /tmp/xx 2>&1
-diff /tmp/xx getopts.right && rm -f /tmp/xx
+${THIS_SH} ./getopts.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx getopts.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-glob-test bash-3.0-STEP/tests/run-glob-test
--- bash-3.0/tests/run-glob-test	2003-09-11 01:44:39.000000000 +1200
+++ bash-3.0-STEP/tests/run-glob-test	2005-08-25 00:47:19.222597080 +1200
@@ -1,4 +1,4 @@
 PATH=$PATH:`pwd`
 export PATH
-${THIS_SH} ./glob-test 2>&1 | grep -v '^expect' > /tmp/xx
-diff /tmp/xx glob.right && rm -f /tmp/xx
+${THIS_SH} ./glob-test 2>&1 | grep -v '^expect' > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx glob.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-heredoc bash-3.0-STEP/tests/run-heredoc
--- bash-3.0/tests/run-heredoc	1996-09-12 07:12:50.000000000 +1200
+++ bash-3.0-STEP/tests/run-heredoc	2005-08-25 00:47:19.227596320 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./heredoc.tests > /tmp/xx 2>&1
-diff /tmp/xx heredoc.right && rm -f /tmp/xx
+${THIS_SH} ./heredoc.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx heredoc.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-herestr bash-3.0-STEP/tests/run-herestr
--- bash-3.0/tests/run-herestr	2002-02-27 02:51:05.000000000 +1300
+++ bash-3.0-STEP/tests/run-herestr	2005-08-25 00:47:19.233595408 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./herestr.tests > /tmp/xx 2>&1
-diff /tmp/xx herestr.right && rm -f /tmp/xx
+${THIS_SH} ./herestr.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx herestr.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-histexpand bash-3.0-STEP/tests/run-histexpand
--- bash-3.0/tests/run-histexpand	1997-07-04 03:51:55.000000000 +1200
+++ bash-3.0-STEP/tests/run-histexpand	2005-08-25 00:47:19.238594648 +1200
@@ -1,4 +1,4 @@
 echo "warning: all of these tests will fail if history has not been compiled" >&2
 echo "warning: into the shell" >&2
-${THIS_SH} ./histexp.tests > /tmp/xx 2>&1
-diff /tmp/xx histexp.right && rm -f /tmp/xx
+${THIS_SH} ./histexp.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx histexp.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-history bash-3.0-STEP/tests/run-history
--- bash-3.0/tests/run-history	1997-03-07 10:08:53.000000000 +1300
+++ bash-3.0-STEP/tests/run-history	2005-08-25 00:47:19.244593736 +1200
@@ -1,4 +1,4 @@
 echo "warning: all of these tests will fail if history has not been compiled" >&2
 echo "warning: into the shell" >&2
-${THIS_SH} ./history.tests > /tmp/xx 2>&1
-diff /tmp/xx history.right && rm -f /tmp/xx
+${THIS_SH} ./history.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx history.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-ifs bash-3.0-STEP/tests/run-ifs
--- bash-3.0/tests/run-ifs	2002-02-21 08:32:33.000000000 +1300
+++ bash-3.0-STEP/tests/run-ifs	2005-08-25 00:47:19.147608480 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./ifs.tests > /tmp/xx 2>&1
-diff /tmp/xx ifs.right && rm -f /tmp/xx
+${THIS_SH} ./ifs.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx ifs.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-input-test bash-3.0-STEP/tests/run-input-test
--- bash-3.0/tests/run-input-test	1996-02-03 10:11:04.000000000 +1300
+++ bash-3.0-STEP/tests/run-input-test	2005-08-25 00:47:19.249592976 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} < ./input-line.sh > /tmp/xx
-diff /tmp/xx input.right && rm -f /tmp/xx
+${THIS_SH} < ./input-line.sh > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx input.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-invert bash-3.0-STEP/tests/run-invert
--- bash-3.0/tests/run-invert	2000-01-26 05:36:10.000000000 +1300
+++ bash-3.0-STEP/tests/run-invert	2005-08-25 00:47:19.254592216 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./invert.tests | grep -v '^expect' > /tmp/xx
-diff /tmp/xx invert.right && rm -f /tmp/xx
+${THIS_SH} ./invert.tests | grep -v '^expect' > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx invert.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-jobs bash-3.0-STEP/tests/run-jobs
--- bash-3.0/tests/run-jobs	2004-07-22 08:37:50.000000000 +1200
+++ bash-3.0-STEP/tests/run-jobs	2005-08-25 00:47:19.259591456 +1200
@@ -3,5 +3,5 @@
 echo "warning: there may be a message regarding a cat process dying due to a" >&2
 echo "warning: SIGHUP.  Please disregard." >&2
 
-${THIS_SH} ./jobs.tests > /tmp/xx 2>&1
-diff /tmp/xx jobs.right && rm -f /tmp/xx
+${THIS_SH} ./jobs.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx jobs.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-minimal bash-3.0-STEP/tests/run-minimal
--- bash-3.0/tests/run-minimal	2000-01-26 05:36:59.000000000 +1300
+++ bash-3.0-STEP/tests/run-minimal	2005-08-25 00:47:19.099615776 +1200
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /System/Tools/sh
 #
 # run-minimal - a version of run-all for shells configured with
 #		--enable-minimal-config
@@ -16,7 +16,7 @@
 
 ${THIS_SH} ./version.mini
 
-rm -f /tmp/xx
+rm -f /System/TemporaryFiles/xx
 
 echo Testing ${THIS_SH}
 echo Any output from any test, unless otherwise noted, indicates a possible anomaly
diff -urN bash-3.0/tests/run-more-exp bash-3.0-STEP/tests/run-more-exp
--- bash-3.0/tests/run-more-exp	1996-02-03 10:11:18.000000000 +1300
+++ bash-3.0-STEP/tests/run-more-exp	2005-08-25 00:47:19.269589936 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./more-exp.tests 2>&1 | grep -v '^expect' > /tmp/xx
-diff /tmp/xx more-exp.right && rm -f /tmp/xx
+${THIS_SH} ./more-exp.tests 2>&1 | grep -v '^expect' > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx more-exp.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-new-exp bash-3.0-STEP/tests/run-new-exp
--- bash-3.0/tests/run-new-exp	1999-04-28 03:31:21.000000000 +1200
+++ bash-3.0-STEP/tests/run-new-exp	2005-08-25 00:47:19.274589176 +1200
@@ -1,10 +1,10 @@
 echo "warning: two of these tests will fail if your OS does not support" >&2
-echo "warning: named pipes or the /dev/fd filesystem.  If the tests of the" >&2
+echo "warning: named pipes or the /System/Devices/fd filesystem.  If the tests of the" >&2
 echo "warning: process substitution mechanism fail, please do not consider" >&2
 echo "warning: this a test failure" >&2
 echo "warning: if you have exported variables beginning with the string _Q," >&2
 echo "warning: diff output may be generated.  If so, please do not consider" >&2
 echo "warning: this a test failure" >&2
 
-${THIS_SH} ./new-exp.tests 2>&1 | grep -v '^expect' > /tmp/xx
-diff /tmp/xx new-exp.right && rm -f /tmp/xx
+${THIS_SH} ./new-exp.tests 2>&1 | grep -v '^expect' > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx new-exp.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-nquote bash-3.0-STEP/tests/run-nquote
--- bash-3.0/tests/run-nquote	1996-03-30 09:06:37.000000000 +1200
+++ bash-3.0-STEP/tests/run-nquote	2005-08-25 00:47:19.279588416 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./nquote.tests 2>&1 | grep -v '^expect' > /tmp/xx
-diff /tmp/xx nquote.right && rm -f /tmp/xx
+${THIS_SH} ./nquote.tests 2>&1 | grep -v '^expect' > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx nquote.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-nquote1 bash-3.0-STEP/tests/run-nquote1
--- bash-3.0/tests/run-nquote1	2002-03-27 03:14:35.000000000 +1200
+++ bash-3.0-STEP/tests/run-nquote1	2005-08-25 00:47:19.284587656 +1200
@@ -1,4 +1,4 @@
 echo "warning: several of these tests will fail if arrays have not" >&2
 echo "warning: been compiled into the shell." >&2
-${THIS_SH} ./nquote1.tests 2>&1 | grep -v '^expect' > /tmp/xx
-diff /tmp/xx nquote1.right && rm -f /tmp/xx
+${THIS_SH} ./nquote1.tests 2>&1 | grep -v '^expect' > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx nquote1.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-nquote2 bash-3.0-STEP/tests/run-nquote2
--- bash-3.0/tests/run-nquote2	2002-03-28 02:58:07.000000000 +1200
+++ bash-3.0-STEP/tests/run-nquote2	2005-08-25 00:47:19.290586744 +1200
@@ -1,4 +1,4 @@
 echo "warning: several of these tests will fail if arrays have not" >&2
 echo "warning: been compiled into the shell." >&2
-${THIS_SH} ./nquote2.tests 2>&1 | grep -v '^expect' > /tmp/xx
-diff /tmp/xx nquote2.right && rm -f /tmp/xx
+${THIS_SH} ./nquote2.tests 2>&1 | grep -v '^expect' > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx nquote2.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-nquote3 bash-3.0-STEP/tests/run-nquote3
--- bash-3.0/tests/run-nquote3	2002-03-29 08:48:33.000000000 +1200
+++ bash-3.0-STEP/tests/run-nquote3	2005-08-25 00:47:19.295585984 +1200
@@ -1,4 +1,4 @@
 echo "warning: several of these tests will fail if arrays have not" >&2
 echo "warning: been compiled into the shell." >&2
-${THIS_SH} ./nquote3.tests 2>&1 | grep -v '^expect' > /tmp/xx
-diff /tmp/xx nquote3.right && rm -f /tmp/xx
+${THIS_SH} ./nquote3.tests 2>&1 | grep -v '^expect' > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx nquote3.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-nquote4 bash-3.0-STEP/tests/run-nquote4
--- bash-3.0/tests/run-nquote4	2002-10-03 06:57:19.000000000 +1200
+++ bash-3.0-STEP/tests/run-nquote4	2005-08-25 00:47:19.301585072 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./nquote.tests 2>&1 | grep -v '^expect' > /tmp/xx
-diff /tmp/xx nquote.right && rm -f /tmp/xx
+${THIS_SH} ./nquote.tests 2>&1 | grep -v '^expect' > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx nquote.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-posix2 bash-3.0-STEP/tests/run-posix2
--- bash-3.0/tests/run-posix2	1996-06-20 04:14:40.000000000 +1200
+++ bash-3.0-STEP/tests/run-posix2	2005-08-25 00:47:19.306584312 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./posix2.tests 2>&1 | grep -v '^expect' > /tmp/xx
-diff /tmp/xx posix2.right && rm -f /tmp/xx
+${THIS_SH} ./posix2.tests 2>&1 | grep -v '^expect' > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx posix2.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-posixpat bash-3.0-STEP/tests/run-posixpat
--- bash-3.0/tests/run-posixpat	1997-07-04 05:10:11.000000000 +1200
+++ bash-3.0-STEP/tests/run-posixpat	2005-08-25 00:47:19.311583552 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./posixpat.tests > /tmp/xx
-diff /tmp/xx posixpat.right && rm -f /tmp/xx
+${THIS_SH} ./posixpat.tests > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx posixpat.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-precedence bash-3.0-STEP/tests/run-precedence
--- bash-3.0/tests/run-precedence	1996-02-03 10:11:38.000000000 +1300
+++ bash-3.0-STEP/tests/run-precedence	2005-08-25 00:47:19.316582792 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./precedence > /tmp/xx
-diff /tmp/xx prec.right && rm -f /tmp/xx
+${THIS_SH} ./precedence > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx prec.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-printf bash-3.0-STEP/tests/run-printf
--- bash-3.0/tests/run-printf	1998-04-30 07:41:28.000000000 +1200
+++ bash-3.0-STEP/tests/run-printf	2005-08-25 00:47:19.322581880 +1200
@@ -1,5 +1,5 @@
 # See whether or not we can use `diff -a'
-( diff -a ./printf.tests ./printf.tests >/dev/null 2>&1 ) && AFLAG=-a
+( diff -a ./printf.tests ./printf.tests >/System/Devices/null 2>&1 ) && AFLAG=-a
 
-${THIS_SH} ./printf.tests > /tmp/xx 2>&1
-diff $AFLAG /tmp/xx printf.right && rm -f /tmp/xx
+${THIS_SH} ./printf.tests > /System/TemporaryFiles/xx 2>&1
+diff $AFLAG /System/TemporaryFiles/xx printf.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-quote bash-3.0-STEP/tests/run-quote
--- bash-3.0/tests/run-quote	1996-08-28 09:29:45.000000000 +1200
+++ bash-3.0-STEP/tests/run-quote	2005-08-25 00:47:19.327581120 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./quote.tests >/tmp/xx 2>&1
-diff /tmp/xx quote.right && rm -f /tmp/xx
+${THIS_SH} ./quote.tests >/System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx quote.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-read bash-3.0-STEP/tests/run-read
--- bash-3.0/tests/run-read	2004-07-22 08:58:33.000000000 +1200
+++ bash-3.0-STEP/tests/run-read	2005-08-25 00:47:19.332580360 +1200
@@ -1,4 +1,4 @@
 echo "warning: different versions of wc put differing amounts of whitespace" >&2
 echo "warning: before their output.  Please do not consider this an error." >&2
-${THIS_SH} ./read.tests > /tmp/xx 2>&1
-diff /tmp/xx read.right && rm -f /tmp/xx
+${THIS_SH} ./read.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx read.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-redir bash-3.0-STEP/tests/run-redir
--- bash-3.0/tests/run-redir	2002-04-03 02:50:30.000000000 +1200
+++ bash-3.0-STEP/tests/run-redir	2005-08-25 00:47:19.338579448 +1200
@@ -3,5 +3,5 @@
 echo "warning: if the text of an error message concerning \`redir1.*' not being" >&2
 echo "warning: found or messages concerning bad file descriptors produce diff" >&2
 echo "warning: output, please do not consider it a test failure" >&2
-${THIS_SH} ./redir.tests > /tmp/xx 2>&1
-diff /tmp/xx redir.right && rm -f /tmp/xx
+${THIS_SH} ./redir.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx redir.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-rhs-exp bash-3.0-STEP/tests/run-rhs-exp
--- bash-3.0/tests/run-rhs-exp	1996-02-03 10:11:49.000000000 +1300
+++ bash-3.0-STEP/tests/run-rhs-exp	2005-08-25 00:47:19.343578688 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./rhs-exp.tests 2>&1 > /tmp/xx
-diff /tmp/xx rhs-exp.right && rm -f /tmp/xx
+${THIS_SH} ./rhs-exp.tests 2>&1 > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx rhs-exp.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-rsh bash-3.0-STEP/tests/run-rsh
--- bash-3.0/tests/run-rsh	1997-02-22 07:26:12.000000000 +1300
+++ bash-3.0-STEP/tests/run-rsh	2005-08-25 00:47:19.348577928 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./rsh.tests > /tmp/xx 2>&1
-diff /tmp/xx rsh.right && rm -f /tmp/xx
+${THIS_SH} ./rsh.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx rsh.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-set-e bash-3.0-STEP/tests/run-set-e
--- bash-3.0/tests/run-set-e	1996-02-03 10:11:58.000000000 +1300
+++ bash-3.0-STEP/tests/run-set-e	2005-08-25 00:47:19.353577168 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./set-e-test > /tmp/xx
-diff /tmp/xx set-e.right && rm -f /tmp/xx
+${THIS_SH} ./set-e-test > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx set-e.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-set-x bash-3.0-STEP/tests/run-set-x
--- bash-3.0/tests/run-set-x	2003-09-25 09:56:45.000000000 +1200
+++ bash-3.0-STEP/tests/run-set-x	2005-08-25 00:47:19.356576712 +1200
@@ -2,8 +2,8 @@
 #$Id: run-set-x,v 1.1 2002/12/09 13:12:37 rockyb Exp $
 
 TEST_NAME='set-x'
-TEST_FILE="/tmp/${TEST_NAME}.check"
-${THIS_SH} ./${TEST_NAME}.tests > $TEST_FILE 2>&1 < /dev/null
+TEST_FILE="/System/TemporaryFiles/${TEST_NAME}.check"
+${THIS_SH} ./${TEST_NAME}.tests > $TEST_FILE 2>&1 < /System/Devices/null
 set -f
 diff $TEST_FILE ${TEST_NAME}.right && rm -f $TEST_FILE
 
diff -urN bash-3.0/tests/run-shopt bash-3.0-STEP/tests/run-shopt
--- bash-3.0/tests/run-shopt	1997-11-15 08:37:47.000000000 +1300
+++ bash-3.0-STEP/tests/run-shopt	2005-08-25 00:47:19.362575800 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./shopt.tests > /tmp/xx 2>&1
-diff /tmp/xx shopt.right && rm -f /tmp/xx
+${THIS_SH} ./shopt.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx shopt.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-strip bash-3.0-STEP/tests/run-strip
--- bash-3.0/tests/run-strip	1996-02-03 10:12:03.000000000 +1300
+++ bash-3.0-STEP/tests/run-strip	2005-08-25 00:47:19.371574432 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./strip.tests > /tmp/xx
-diff /tmp/xx strip.right && rm -f /tmp/xx
+${THIS_SH} ./strip.tests > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx strip.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-test bash-3.0-STEP/tests/run-test
--- bash-3.0/tests/run-test	2003-04-10 01:05:12.000000000 +1200
+++ bash-3.0-STEP/tests/run-test	2005-08-25 00:47:19.376573672 +1200
@@ -1,4 +1,4 @@
-unset GROUPS UID 2>/dev/null
+unset GROUPS UID 2>/System/Devices/null
 
-${THIS_SH} ./test.tests >/tmp/xx 2>&1
-diff /tmp/xx test.right && rm -f /tmp/xx
+${THIS_SH} ./test.tests >/System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx test.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-tilde bash-3.0-STEP/tests/run-tilde
--- bash-3.0/tests/run-tilde	1996-02-03 10:12:15.000000000 +1300
+++ bash-3.0-STEP/tests/run-tilde	2005-08-25 00:47:19.381572912 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./tilde-tests > /tmp/xx
-diff /tmp/xx tilde.right && rm -f /tmp/xx
+${THIS_SH} ./tilde-tests > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx tilde.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-trap bash-3.0-STEP/tests/run-trap
--- bash-3.0/tests/run-trap	1997-12-17 04:31:51.000000000 +1300
+++ bash-3.0-STEP/tests/run-trap	2005-08-25 00:47:19.387572000 +1200
@@ -2,5 +2,5 @@
 echo "warning: only in line numbers is produced, please do not consider this" >&2
 echo "warning: a test failure." >&2
 
-${THIS_SH} ./trap.tests > /tmp/xx 2>&1
-diff /tmp/xx trap.right && rm -f /tmp/xx
+${THIS_SH} ./trap.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx trap.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-type bash-3.0-STEP/tests/run-type
--- bash-3.0/tests/run-type	1997-02-25 08:26:51.000000000 +1300
+++ bash-3.0-STEP/tests/run-type	2005-08-25 00:47:19.392571240 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./type.tests > /tmp/xx 2>&1
-diff /tmp/xx type.right && rm -f /tmp/xx
+${THIS_SH} ./type.tests > /System/TemporaryFiles/xx 2>&1
+diff /System/TemporaryFiles/xx type.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/run-varenv bash-3.0-STEP/tests/run-varenv
--- bash-3.0/tests/run-varenv	1996-02-03 10:12:23.000000000 +1300
+++ bash-3.0-STEP/tests/run-varenv	2005-08-25 00:47:19.398570328 +1200
@@ -1,2 +1,2 @@
-${THIS_SH} ./varenv.sh | grep -v '^expect' > /tmp/xx
-diff /tmp/xx varenv.right && rm -f /tmp/xx
+${THIS_SH} ./varenv.sh | grep -v '^expect' > /System/TemporaryFiles/xx
+diff /System/TemporaryFiles/xx varenv.right && rm -f /System/TemporaryFiles/xx
diff -urN bash-3.0/tests/source5.sub bash-3.0-STEP/tests/source5.sub
--- bash-3.0/tests/source5.sub	1997-11-19 08:13:40.000000000 +1300
+++ bash-3.0-STEP/tests/source5.sub	2005-08-25 00:47:18.597692080 +1200
@@ -7,13 +7,13 @@
 set +o posix
 
 # attempting to source a non-existant file is not an error...
-. /tmp/source-notthere
+. /System/TemporaryFiles/source-notthere
 
 echo after bad source 1
 
 set -o posix
 
 # ...unless you're in posix mode
-. /tmp/source-notthere
+. /System/TemporaryFiles/source-notthere
 
 echo after bad source 2
diff -urN bash-3.0/tests/test.right bash-3.0-STEP/tests/test.right
--- bash-3.0/tests/test.right	2002-03-15 07:22:59.000000000 +1300
+++ bash-3.0-STEP/tests/test.right	2005-08-25 00:47:19.825505424 +1200
@@ -4,11 +4,11 @@
 0
 t -b run-all
 1
-t -b /dev/jb1a
+t -b /System/Devices/jb1a
 1
 t -c run-all
 1
-t -c /dev/tty
+t -c /System/Devices/tty
 0
 t -d run-all
 1
@@ -24,13 +24,13 @@
 0
 t -f noexist
 1
-t -f /dev/tty
+t -f /System/Devices/tty
 1
 t -f run-all
 0
 t -g run-all
 1
-t -g /tmp/test.setgid
+t -g /System/TemporaryFiles/test.setgid
 0
 t -k run-all
 1
@@ -42,13 +42,13 @@
 1
 t -r noexist
 1
-t -r /tmp/test.noread
+t -r /System/TemporaryFiles/test.noread
 1
 t -r run-all
 0
 t -s noexist
 1
-t -s /dev/null
+t -s /System/Devices/null
 1
 t -s run-all
 0
@@ -60,19 +60,19 @@
 1
 t -u run-all
 1
-t -u /tmp/test.setuid
+t -u /System/TemporaryFiles/test.setuid
 0
 t -w noexist
 1
-t -w /tmp/test.nowrite
+t -w /System/TemporaryFiles/test.nowrite
 1
-t -w /dev/null
+t -w /System/Devices/null
 0
 t -x noexist
 1
-t -x /tmp/test.exec
+t -x /System/TemporaryFiles/test.exec
 0
-t -x /tmp/test.noexec
+t -x /System/TemporaryFiles/test.noexec
 1
 t -z ""
 0
@@ -82,11 +82,11 @@
 0
 t ""
 1
-t -O /tmp/test.owner
+t -O /System/TemporaryFiles/test.owner
 0
-t -S /tmp/test.socket
+t -S /System/TemporaryFiles/test.socket
 1
-t -N /tmp/test.newer
+t -N /System/TemporaryFiles/test.newer
 0
 t "hello" = "hello"
 0
@@ -136,29 +136,29 @@
 0
 t ! \( 700 -le 1000 -a -n "1" -a "20" = "20" \)
 1
-t /tmp/abc -nt /tmp/def
+t /System/TemporaryFiles/abc -nt /System/TemporaryFiles/def
 1
-t /tmp/abc -ot /tmp/def
+t /System/TemporaryFiles/abc -ot /System/TemporaryFiles/def
 0
-t /tmp/def -nt /tmp/abc
+t /System/TemporaryFiles/def -nt /System/TemporaryFiles/abc
 0
-t /tmp/def -ot /tmp/abc
+t /System/TemporaryFiles/def -ot /System/TemporaryFiles/abc
 1
-t /tmp/abc -ef /tmp/def
+t /System/TemporaryFiles/abc -ef /System/TemporaryFiles/def
 1
-t /tmp/abc -ef /tmp/ghi
+t /System/TemporaryFiles/abc -ef /System/TemporaryFiles/ghi
 0
-t -r /dev/fd/0
+t -r /System/Devices/fd/0
 0
-t -w /dev/fd/1
+t -w /System/Devices/fd/1
 0
-t -w /dev/fd/2
+t -w /System/Devices/fd/2
 0
-t -r /dev/stdin
+t -r /System/Devices/stdin
 0
-t -w /dev/stdout
+t -w /System/Devices/stdout
 0
-t -w /dev/stderr
+t -w /System/Devices/stderr
 0
 t
 1
@@ -222,9 +222,9 @@
 1
 b ! "$zero"
 0
-t -G /tmp/test.group
+t -G /System/TemporaryFiles/test.group
 0
-t -h /tmp/test.symlink
+t -h /System/TemporaryFiles/test.symlink
 0
 t 4+3 -eq 7
 ./test.tests: line 13: test: 4+3: integer expression expected
@@ -276,9 +276,9 @@
 1
 t -t 42
 1
-t -t /dev/tty
+t -t /System/Devices/tty
 1
-t -t /dev/tty4
+t -t /System/Devices/tty4
 1
-t -t /dev/tty4444444...
+t -t /System/Devices/tty4444444...
 1
diff -urN bash-3.0/tests/test.tests bash-3.0-STEP/tests/test.tests
--- bash-3.0/tests/test.tests	2004-05-11 02:11:42.000000000 +1200
+++ bash-3.0-STEP/tests/test.tests	2005-08-25 00:47:19.756515912 +1200
@@ -21,13 +21,13 @@
 
 echo 't -b run-all'
 t -b run-all
-echo 't -b /dev/jb1a'
-t -b /dev/jb1a
+echo 't -b /System/Devices/jb1a'
+t -b /System/Devices/jb1a
 
 echo 't -c run-all'
 t -c run-all
-echo 't -c /dev/tty'
-t -c /dev/tty
+echo 't -c /System/Devices/tty'
+t -c /System/Devices/tty
 
 echo 't -d run-all'
 t -d run-all
@@ -45,21 +45,21 @@
 
 echo 't -f noexist'
 t -f noexist
-echo 't -f /dev/tty'
-t -f /dev/tty
+echo 't -f /System/Devices/tty'
+t -f /System/Devices/tty
 echo 't -f run-all'
 t -f run-all
 
 echo 't -g run-all'
 t -g run-all
 
-touch /tmp/test.setgid
-chgrp ${GROUPS[0]} /tmp/test.setgid
-chmod ug+x /tmp/test.setgid
-chmod g+s /tmp/test.setgid
-echo 't -g /tmp/test.setgid'
-t -g /tmp/test.setgid
-rm -f /tmp/test.setgid
+touch /System/TemporaryFiles/test.setgid
+chgrp ${GROUPS[0]} /System/TemporaryFiles/test.setgid
+chmod ug+x /System/TemporaryFiles/test.setgid
+chmod g+s /System/TemporaryFiles/test.setgid
+echo 't -g /System/TemporaryFiles/test.setgid'
+t -g /System/TemporaryFiles/test.setgid
+rm -f /System/TemporaryFiles/test.setgid
 
 echo 't -k run-all'
 t -k run-all
@@ -76,13 +76,13 @@
 t -r noexist
 
 if (( $UID != 0 )); then
-	touch /tmp/test.noread
-	chmod a-r /tmp/test.noread
-	echo 't -r /tmp/test.noread'
-	t -r /tmp/test.noread
-	rm -f /tmp/test.noread
+	touch /System/TemporaryFiles/test.noread
+	chmod a-r /System/TemporaryFiles/test.noread
+	echo 't -r /System/TemporaryFiles/test.noread'
+	t -r /System/TemporaryFiles/test.noread
+	rm -f /System/TemporaryFiles/test.noread
 else
-	echo 't -r /tmp/test.noread'
+	echo 't -r /System/TemporaryFiles/test.noread'
 	echo 1
 fi
 
@@ -91,15 +91,15 @@
 
 echo 't -s noexist'
 t -s noexist
-echo 't -s /dev/null'
-t -s /dev/null
+echo 't -s /System/Devices/null'
+t -s /System/Devices/null
 echo 't -s run-all'
 t -s run-all
 
 echo 't -t 20'
 t -t 20
 echo 't -t 0'
-t -t 0 < /dev/tty
+t -t 0 < /System/Devices/tty
 
 echo 't -u noexist'
 t -u noexist
@@ -107,44 +107,44 @@
 echo 't -u run-all'
 t -u run-all
 
-touch /tmp/test.setuid
-chmod u+x /tmp/test.setuid	# some systems require this to turn on setuid bit
-chmod u+s /tmp/test.setuid
-echo 't -u /tmp/test.setuid'
-t -u /tmp/test.setuid
-rm -f /tmp/test.setuid
+touch /System/TemporaryFiles/test.setuid
+chmod u+x /System/TemporaryFiles/test.setuid	# some systems require this to turn on setuid bit
+chmod u+s /System/TemporaryFiles/test.setuid
+echo 't -u /System/TemporaryFiles/test.setuid'
+t -u /System/TemporaryFiles/test.setuid
+rm -f /System/TemporaryFiles/test.setuid
 
 echo 't -w noexist'
 t -w noexist
 
 if (( $UID != 0 )); then
-	touch /tmp/test.nowrite
-	chmod a-w /tmp/test.nowrite
-	echo 't -w /tmp/test.nowrite'
-	t -w /tmp/test.nowrite
-	rm -f /tmp/test.nowrite
+	touch /System/TemporaryFiles/test.nowrite
+	chmod a-w /System/TemporaryFiles/test.nowrite
+	echo 't -w /System/TemporaryFiles/test.nowrite'
+	t -w /System/TemporaryFiles/test.nowrite
+	rm -f /System/TemporaryFiles/test.nowrite
 else
-	echo 't -w /tmp/test.nowrite'
+	echo 't -w /System/TemporaryFiles/test.nowrite'
 	echo 1
 fi
 
-echo 't -w /dev/null'
-t -w /dev/null
+echo 't -w /System/Devices/null'
+t -w /System/Devices/null
 
 echo 't -x noexist'
 t -x noexist
 
-touch /tmp/test.exec
-chmod u+x /tmp/test.exec
-echo 't -x /tmp/test.exec'
-t -x /tmp/test.exec
-rm -f /tmp/test.exec
-
-touch /tmp/test.noexec
-chmod u-x /tmp/test.noexec
-echo 't -x /tmp/test.noexec'
-t -x /tmp/test.noexec
-rm -f /tmp/test.noexec
+touch /System/TemporaryFiles/test.exec
+chmod u+x /System/TemporaryFiles/test.exec
+echo 't -x /System/TemporaryFiles/test.exec'
+t -x /System/TemporaryFiles/test.exec
+rm -f /System/TemporaryFiles/test.exec
+
+touch /System/TemporaryFiles/test.noexec
+chmod u-x /System/TemporaryFiles/test.noexec
+echo 't -x /System/TemporaryFiles/test.noexec'
+t -x /System/TemporaryFiles/test.noexec
+rm -f /System/TemporaryFiles/test.noexec
 
 echo 't -z ""'
 t -z ""
@@ -156,20 +156,20 @@
 echo 't ""'
 t ""
 
-touch /tmp/test.owner
-echo 't -O /tmp/test.owner'
-t -O /tmp/test.owner
-rm -f /tmp/test.owner
-
-touch /tmp/test.socket
-echo 't -S /tmp/test.socket'
-t -S /tmp/test.socket	# false
-rm -f /tmp/test.socket
-
-touch /tmp/test.newer
-echo 't -N /tmp/test.newer'
-t -N /tmp/test.newer
-rm -f /tmp/test.newer
+touch /System/TemporaryFiles/test.owner
+echo 't -O /System/TemporaryFiles/test.owner'
+t -O /System/TemporaryFiles/test.owner
+rm -f /System/TemporaryFiles/test.owner
+
+touch /System/TemporaryFiles/test.socket
+echo 't -S /System/TemporaryFiles/test.socket'
+t -S /System/TemporaryFiles/test.socket	# false
+rm -f /System/TemporaryFiles/test.socket
+
+touch /System/TemporaryFiles/test.newer
+echo 't -N /System/TemporaryFiles/test.newer'
+t -N /System/TemporaryFiles/test.newer
+rm -f /System/TemporaryFiles/test.newer
 
 echo 't "hello" = "hello"'
 t "hello" = "hello"
@@ -231,40 +231,40 @@
 echo 't ! \( 700 -le 1000 -a -n "1" -a "20" = "20" \)'
 t ! \( 700 -le 1000 -a -n "1" -a "20" = "20" \)
 
-touch /tmp/abc
+touch /System/TemporaryFiles/abc
 sleep 2
-touch /tmp/def
+touch /System/TemporaryFiles/def
 
-echo 't /tmp/abc -nt /tmp/def'
-t /tmp/abc -nt /tmp/def
-echo 't /tmp/abc -ot /tmp/def'
-t /tmp/abc -ot /tmp/def
-echo 't /tmp/def -nt /tmp/abc'
-t /tmp/def -nt /tmp/abc
-echo 't /tmp/def -ot /tmp/abc'
-t /tmp/def -ot /tmp/abc
-
-echo 't /tmp/abc -ef /tmp/def'
-t /tmp/abc -ef /tmp/def
-ln /tmp/abc /tmp/ghi
-echo 't /tmp/abc -ef /tmp/ghi'
-t /tmp/abc -ef /tmp/ghi
-
-rm /tmp/abc /tmp/def /tmp/ghi
-
-echo 't -r /dev/fd/0'
-t -r /dev/fd/0
-echo 't -w /dev/fd/1'
-t -w /dev/fd/1
-echo 't -w /dev/fd/2'
-t -w /dev/fd/2
-
-echo 't -r /dev/stdin'
-t -r /dev/stdin
-echo 't -w /dev/stdout'
-t -w /dev/stdout
-echo 't -w /dev/stderr'
-t -w /dev/stderr
+echo 't /System/TemporaryFiles/abc -nt /System/TemporaryFiles/def'
+t /System/TemporaryFiles/abc -nt /System/TemporaryFiles/def
+echo 't /System/TemporaryFiles/abc -ot /System/TemporaryFiles/def'
+t /System/TemporaryFiles/abc -ot /System/TemporaryFiles/def
+echo 't /System/TemporaryFiles/def -nt /System/TemporaryFiles/abc'
+t /System/TemporaryFiles/def -nt /System/TemporaryFiles/abc
+echo 't /System/TemporaryFiles/def -ot /System/TemporaryFiles/abc'
+t /System/TemporaryFiles/def -ot /System/TemporaryFiles/abc
+
+echo 't /System/TemporaryFiles/abc -ef /System/TemporaryFiles/def'
+t /System/TemporaryFiles/abc -ef /System/TemporaryFiles/def
+ln /System/TemporaryFiles/abc /System/TemporaryFiles/ghi
+echo 't /System/TemporaryFiles/abc -ef /System/TemporaryFiles/ghi'
+t /System/TemporaryFiles/abc -ef /System/TemporaryFiles/ghi
+
+rm /System/TemporaryFiles/abc /System/TemporaryFiles/def /System/TemporaryFiles/ghi
+
+echo 't -r /System/Devices/fd/0'
+t -r /System/Devices/fd/0
+echo 't -w /System/Devices/fd/1'
+t -w /System/Devices/fd/1
+echo 't -w /System/Devices/fd/2'
+t -w /System/Devices/fd/2
+
+echo 't -r /System/Devices/stdin'
+t -r /System/Devices/stdin
+echo 't -w /System/Devices/stdout'
+t -w /System/Devices/stdout
+echo 't -w /System/Devices/stderr'
+t -w /System/Devices/stderr
 
 echo 't'
 t
@@ -343,25 +343,25 @@
 echo 'b ! "$zero"'
 b ! "$zero"
 
-touch /tmp/test.group
-chgrp ${GROUPS[0]} /tmp/test.group
-echo 't -G /tmp/test.group'
-t -G /tmp/test.group
-rm /tmp/test.group
+touch /System/TemporaryFiles/test.group
+chgrp ${GROUPS[0]} /System/TemporaryFiles/test.group
+echo 't -G /System/TemporaryFiles/test.group'
+t -G /System/TemporaryFiles/test.group
+rm /System/TemporaryFiles/test.group
 
 case "${THIS_SH}" in
 /*)	SHNAME=${THIS_SH} ;;
 *)	SHNAME=${PWD}/${THIS_SH} ;;
 esac
 
-if ln -s ${SHNAME} /tmp/test.symlink 2>/dev/null; then
-	chgrp ${GROUPS[0]} /tmp/test.symlink 2>/dev/null
-	echo 't -h /tmp/test.symlink'
-	t -h /tmp/test.symlink
+if ln -s ${SHNAME} /System/TemporaryFiles/test.symlink 2>/System/Devices/null; then
+	chgrp ${GROUPS[0]} /System/TemporaryFiles/test.symlink 2>/System/Devices/null
+	echo 't -h /System/TemporaryFiles/test.symlink'
+	t -h /System/TemporaryFiles/test.symlink
 	# some systems don't let you remove this
-	rm -f /tmp/test.symlink 2>/dev/null
+	rm -f /System/TemporaryFiles/test.symlink 2>/System/Devices/null
 else
-	echo 't -h /tmp/test.symlink'
+	echo 't -h /System/TemporaryFiles/test.symlink'
 	echo 0
 fi
 
@@ -415,9 +415,9 @@
 t -t addsds
 echo 't -t 42'
 t -t 42
-echo 't -t /dev/tty'
-t -t /dev/tty
-echo 't -t /dev/tty4'
-t -t /dev/tty4
-echo 't -t /dev/tty4444444...'
-t -t /dev/tty4444444...
+echo 't -t /System/Devices/tty'
+t -t /System/Devices/tty
+echo 't -t /System/Devices/tty4'
+t -t /System/Devices/tty4
+echo 't -t /System/Devices/tty4444444...'
+t -t /System/Devices/tty4444444...
diff -urN bash-3.0/tests/tilde-tests bash-3.0-STEP/tests/tilde-tests
--- bash-3.0/tests/tilde-tests	1997-02-25 07:10:36.000000000 +1300
+++ bash-3.0-STEP/tests/tilde-tests	2005-08-25 00:47:19.831504512 +1200
@@ -18,15 +18,15 @@
 echo "SHELL=~/bash"
 echo $SHELL
 echo abcd:~chet
-path=/usr/ucb:/bin:~/bin:~/tmp/bin:/usr/bin
+path=/usr/ucb:/bin:~/bin:~/System/TemporaryFiles/bin:/System/Tools
 echo $path
 
 cd /usr
-cd /tmp
+cd /System/TemporaryFiles
 echo ~-
 echo ~+
 
-XPATH=/bin:/usr/bin:.
+XPATH=/bin:/System/Tools:.
 
 # yes tilde expansion
 PPATH=$XPATH:~/bin
diff -urN bash-3.0/tests/tilde.right bash-3.0-STEP/tests/tilde.right
--- bash-3.0/tests/tilde.right	1997-02-25 07:10:51.000000000 +1300
+++ bash-3.0-STEP/tests/tilde.right	2005-08-25 00:47:19.837503600 +1200
@@ -10,15 +10,15 @@
 SHELL=~/bash
 /usr/xyz/bash
 abcd:~chet
-/usr/ucb:/bin:/usr/xyz/bin:/usr/xyz/tmp/bin:/usr/bin
+/usr/ucb:/bin:/usr/xyz/bin:/usr/xyz/System/TemporaryFiles/bin:/System/Tools
 /usr
-/tmp
-/bin:/usr/bin:.:/usr/xyz/bin
-/bin:/usr/bin:.:~/bin
-/bin:/usr/bin:.:/usr/xyz/bin
-/bin:/usr/bin:.:/usr/xyz/bin
-/bin:/usr/bin:.:~/bin
-/bin:/usr/bin:.:~/bin
+/System/TemporaryFiles
+/bin:/System/Tools:.:/usr/xyz/bin
+/bin:/System/Tools:.:~/bin
+/bin:/System/Tools:.:/usr/xyz/bin
+/bin:/System/Tools:.:/usr/xyz/bin
+/bin:/System/Tools:.:~/bin
+/bin:/System/Tools:.:~/bin
 ok 1
 ok 2
 ok 3
diff -urN bash-3.0/tests/type.right bash-3.0-STEP/tests/type.right
--- bash-3.0/tests/type.right	2002-11-20 08:25:22.000000000 +1300
+++ bash-3.0-STEP/tests/type.right	2005-08-25 00:47:19.848501928 +1200
@@ -16,7 +16,7 @@
 while is a shell keyword
 while is a shell keyword
 builtin is a shell builtin
-/bin/sh is /bin/sh
+/System/Tools/sh is /System/Tools/sh
 func
 func is a function
 func () 
@@ -37,14 +37,14 @@
 m is aliased to `more'
 builtin
 builtin is a shell builtin
-/bin/sh
-/bin/sh is /bin/sh
+/System/Tools/sh
+/System/Tools/sh is /System/Tools/sh
 ./type.tests: line 64: type: func: not found
 ./type.tests: line 66: type: m: not found
-/bin/sh
-/tmp/bash
-bash is hashed (/tmp/bash)
+/System/Tools/sh
+/System/TemporaryFiles/bash
+bash is hashed (/System/TemporaryFiles/bash)
 file
 hits	command
-   3	/tmp/bash
-   1	/bin/sh
+   3	/System/TemporaryFiles/bash
+   1	/System/Tools/sh
diff -urN bash-3.0/tests/type.tests bash-3.0-STEP/tests/type.tests
--- bash-3.0/tests/type.tests	2002-11-20 08:23:20.000000000 +1300
+++ bash-3.0-STEP/tests/type.tests	2005-08-25 00:47:19.839503296 +1200
@@ -14,13 +14,13 @@
 
 alias m=more
 
-unset -f func 2>/dev/null
+unset -f func 2>/System/Devices/null
 func() { echo this is func; }
 
 type -t func
 type -t while
 type -t builtin
-type -t /bin/sh
+type -t /System/Tools/sh
 type -t ${THIS_SH}
 type -t mv
 
@@ -29,7 +29,7 @@
 type while
 type -a while
 type builtin
-type /bin/sh
+type /System/Tools/sh
 
 command -v func
 command -V func
@@ -57,8 +57,8 @@
 
 command -v builtin
 command -V builtin
-command -v /bin/sh
-command -V /bin/sh
+command -v /System/Tools/sh
+command -V /System/Tools/sh
 
 unset -f func
 type func
@@ -67,11 +67,11 @@
 
 hash -r
 
-hash -p /bin/sh sh
+hash -p /System/Tools/sh sh
 type -p sh
 
 SHBASE=${THIS_SH##*/}
-hash -p /tmp/$SHBASE $SHBASE
+hash -p /System/TemporaryFiles/$SHBASE $SHBASE
 type -p $SHBASE
 type $SHBASE
 
diff -urN bash-3.0/tests/varenv.right bash-3.0-STEP/tests/varenv.right
--- bash-3.0/tests/varenv.right	2003-02-17 15:35:50.000000000 +1300
+++ bash-3.0-STEP/tests/varenv.right	2005-08-25 00:33:20.969030992 +1200
@@ -21,8 +21,8 @@
 AVAR
 AVAR
 42
-/bin:/usr/bin:/usr/local/bin:.
-avar=([0]="/bin:/usr/bin:/usr/local/bin:.")
+/bin:/System/Tools:/usr/local/bin:.
+avar=([0]="/bin:/System/Tools:/usr/local/bin:.")
 z=yy
 42
 declare -i ivar="10"
diff -urN bash-3.0/tests/varenv.sh bash-3.0-STEP/tests/varenv.sh
--- bash-3.0/tests/varenv.sh	2002-01-16 10:23:19.000000000 +1300
+++ bash-3.0-STEP/tests/varenv.sh	2005-08-25 00:34:12.654173656 +1200
@@ -45,7 +45,7 @@
 echo $HOME
 
 expect $HOME
-HOME=/a/b/c /bin/echo $HOME
+HOME=/a/b/c /System/Tools/echo $HOME
 
 expect $HOME
 echo $HOME
@@ -59,7 +59,7 @@
 # This should echo $HOME 9, NOT /a/b/c 9
 
 expect "$HOME"
-HOME=/a/b/c /bin/echo $HOME c=9
+HOME=/a/b/c /System/Tools/echo $HOME c=9
 expect "$HOME 7"
 echo $HOME $c
 
@@ -102,7 +102,7 @@
 export a
 a=bcde
 export a
-/bin/true 2>/dev/null
+/System/Tools/true 2>/System/Devices/null
 
 func()
 {
@@ -125,7 +125,7 @@
 # Make sure expansion doesn't use assignment statements preceding a builtin
 A=ZVAR echo $A
 
-XPATH=/bin:/usr/bin:/usr/local/bin:.
+XPATH=/bin:/System/Tools:/usr/local/bin:.
 func2()
 {
 	local z=yy
diff -urN bash-3.0/tests/varenv1.sub bash-3.0-STEP/tests/varenv1.sub
--- bash-3.0/tests/varenv1.sub	2001-02-22 08:13:59.000000000 +1300
+++ bash-3.0-STEP/tests/varenv1.sub	2005-08-25 00:47:19.851501472 +1200
@@ -10,7 +10,7 @@
 echo expect 20
 var=20 eval printenv var
 
-: ${TMPDIR:=/tmp}
+: ${TMPDIR:=/System/TemporaryFiles}
 TMPFILE=$TMPDIR/evalsub.$$
 
 rm -f $TMPFILE
